var Te=Object.defineProperty,Be=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Fe=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var le=(s,t,a)=>t in s?Te(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,O=(s,t)=>{for(var a in t||(t={}))Fe.call(t,a)&&le(s,a,t[a]);if(se)for(var a of se(t))Le.call(t,a)&&le(s,a,t[a]);return s},re=(s,t)=>Be(s,Ie(t));import{u as Oe}from"./useScreenCommunityScroll.hook-UzS3nILY.js";import{br as Ve,d as _e,_ as xe,c as v,o as f,q as d,aL as Ae,bx as ze,r as p,ac as je,K as Pe,aw as ie,A as ce,G as Re,c9 as Ue,D as Ke,ca as qe,R as de,bQ as Ye,E as Ge,ay as w,aC as ue,az as me,aO as K,ak as fe,aP as q,aM as Qe,bt as Xe,bc as pe,aB as ge,U as _,s as n,t as V,V as ve,w as i,X as k,F as Y,n as he,z as Je,Y as G}from"./index-DzJUk-4s.js";import{i as ye}from"./icon-Bt2TghsQ.js";import{c as A,S as We,C as Ze}from"./showDetail-VigmGOIs.js";import{u as $e}from"./systemStore-CDAOEx2u.js";import{s as et,a as tt}from"./public-BhRo10AI.js";import"./masterplates.api-CmXDBnKg.js";import"./GoUserAvatar-BBITl89l.js";import"./drawRemote-BVHvBcY1.js";import"./index.d-J2-cmQid.js";import"./index-B2h3DCGB.js";import"./plugin-BZaVEG5Y.js";import"./file-BoGdIhh5.js";import"./index-DumZb7Zp.js";import"./index-YIaHLc6Z.js";import"./fileTypeEnum-22QBGXO_.js";import"./chart_default-Cv54ZmSo.js";import"./hot-tip-bg-5DNCBqVA.js";import"./points-Bi1H5gtF.js";const ot=Ve({id:"projectStore",state:()=>({homeSort:{sortKey:"star",sortValue:"desc",searchValue:""}}),getters:{getHomeSort(){return this.homeSort}},actions:{setItem(s,t){this.$patch(a=>{Object.prototype.toString.call(t)==="[object Object]"?a[s]=O(O({},a[s]),t):a[s]=t})}}});var Ce=(s=>(s.HOME_SORT="homeSort",s))(Ce||{});const at=_e({__name:"communityCardLoad",props:{isDark:{type:Boolean,require:!1,default:!0}},setup(s,{expose:t}){t();const a={};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),nt=["primarycolor","secondarycolor"],st={id:"ncbk8l-animated-diff"},lt=["stop-color"],rt=["stop-color"],it=["stop-color"];function ct(s,t,a,e,z,N){return f(),v("svg",{"aria-labelledby":"ncbk8l-aria",role:"img",width:"322.75",height:"260",viewBox:"0 0 322.75 272",primarycolor:a.isDark?"#44454C":"#EDEEF0",secondarycolor:a.isDark?"#44454C":"#EDEEF0",style:{width:"-webkit-fill-available",height:"auto"}},[t[4]||(t[4]=d("title",{id:"ncbk8l-aria"},"Loading...",-1)),t[5]||(t[5]=d("rect",{role:"presentation",x:"0",y:"0",width:"100%",height:"100%","clip-path":"url(#ncbk8l-diff)",style:{fill:"url('#ncbk8l-animated-diff')"}},null,-1)),d("defs",null,[t[3]||(t[3]=Ae('<clipPath id="ncbk8l-diff"><circle cx="26" cy="242" r="16"></circle><rect x="54" y="225" rx="2" ry="2" width="120" height="18"></rect><rect x="54" y="252" rx="2" ry="2" width="176" height="14"></rect><rect x="0" y="0" rx="12" ry="12" width="322.75" height="213"></rect></clipPath>',1)),d("linearGradient",st,[d("stop",{offset:"0%","stop-color":a.isDark?"#44454C":"#EDEEF0","stop-opacity":"1"},t[0]||(t[0]=[d("animate",{attributeName:"offset",values:"-2; -2; 1",keyTimes:"0; 0.25; 1",dur:"2s",repeatCount:"indefinite"},null,-1)]),8,lt),d("stop",{offset:"50%","stop-color":a.isDark?"#44454C":"#EDEEF0","stop-opacity":"1"},t[1]||(t[1]=[d("animate",{attributeName:"offset",values:"-1; -1; 2",keyTimes:"0; 0.25; 1",dur:"2s",repeatCount:"indefinite"},null,-1)]),8,rt),d("stop",{offset:"100%","stop-color":a.isDark?"#44454C":"#EDEEF0","stop-opacity":"1"},t[2]||(t[2]=[d("animate",{attributeName:"offset",values:"0; 0; 3",keyTimes:"0; 0.25; 1",dur:"2s",repeatCount:"indefinite"},null,-1)]),8,it)])])],8,nt)}const dt=xe(at,[["render",ct],["__file","communityCardLoad.vue"]]);var be=(s=>(s.SELF="self",s))(be||{});const ut=_e({__name:"component",setup(s,{expose:t}){t();const{SortAscendingIcon:a,SortDescendingIcon:e}=ye.carbon,{ChevronDownIcon:z,PersonIcon:N}=ye.ionicons5,{bottom:x,list:m,inBottom:h,page:y,pageSize:g,scrollTop:H}=Oe(),C=ze(),r=ot(),b=Ke(),M=p(!1),S=p("self"),Q=p([]),T=p(""),Se=A.map(o=>o.label),E=p(1),X=$e(),J=je(),j=p(!1),P=p(""),B=p(r.getHomeSort.sortKey||"star"),D=p(r.getHomeSort.sortValue||"desc"),W=Pe.throttle(o=>{const l=document.querySelectorAll(".community-component-box .content-box .screen-list");let u=0;const R=l.length<6?l.length:6;let ae=0;if(m.value.length>g.value){for(let c=0;c<R;c++)if(c===0)ae=l[c].offsetTop,u+=1;else if(l[c].offsetTop===ae)u+=1;else break;const Me=Math.floor(Math.max(o-322,0)/249),U=Math.max(Me*u-20,0),ne=U+g.value+20;for(let c=U;c<Math.min(ne||m.value.length);c++)m.value[c]&&(m.value[c].show=!0);ie(()=>{for(let c=0;c<m.value.length;c++)(c<U||c>ne)&&(m.value[c].show=!1)})}},400);ce(()=>H.value,o=>{W(o)});const Ee=o=>{B.value=o,I()},we=()=>{D.value=D.value==="asc"?"desc":"asc",I()},I=(o=!0)=>{r.setItem(Ce.HOME_SORT,{sortKey:B.value,sortValue:D.value}),o&&F(!0)},F=async(o=!1)=>{o&&(m.value=[],y.value=1,x.value=!1,h.value=!1);const l=await qe({sortKey:r.getHomeSort.sortKey||B.value,sortValue:r.getHomeSort.sortValue||D.value,tags:A[E.value].value,page:y.value,pageSize:g.value,needUser:!0});l.code===de.SUCCESS&&(x.value=!1,o&&(m.value=[]),l.data.data.length===0||l.data.data.length<g.value?ie(()=>{h.value=!0}):h.value=!1,m.value.push(...l.data.data.map(u=>re(O({},u),{projectName:u.title,type:"component",show:!0}))))},L=()=>{M.value=!1},Z=()=>{const o=[{value:"self",label:()=>w(ge,{align:"center",size:4,style:{padding:"6px 0"}},{default:()=>["我的空间",w(pe,{style:{opacity:".5"}},{default:()=>w(N)})]})},{type:"group",label:"空间列表",key:"空间列表",children:[]}];X.getTeamList.forEach(l=>{o[1].children.push({label:l.team_name,value:l.id})}),Q.value=o,setTimeout(()=>{M.value=!0,S.value="self"})},De=async()=>{if(!T.value){window.$message.error("添加失败，请刷新后重试"),L();return}let o=null;o=C.create("正在添加到组件库中，请稍后",{type:"loading"});const l=await Ye({id:T.value,team_id:S.value==="self"?void 0:S.value});try{if(l.code===de.SUCCESS){b.emit(Ge.CHECK_VALIDITY_MEMBER,{needRequest:!0});const u=()=>w("div",{style:{borderRadius:"4px",padding:"8px 25px",boxShadow:"var(--n-box-shadow)",display:"flex",gap:"10px",backgroundColor:J.darkTheme?"#48484e":"#fff"}},[w(ue,{},{default:()=>"创建成功,"}),w(me,{text:!0,type:"primary",size:"small",onClick:$},{default:()=>"点击查看"})]);o.destroy(),C.success("添加成功",{type:"success",render:u})}else window.$message.error("创建失败, 请稍后重试");L()}catch(u){L(),window.$message.error("创建失败, 请稍后重试")}},$=()=>{if(S.value==="self"){const o=K(fe.SCREEN_ITEMS_NAME).path;q(o,void 0,!1,!1,{tabKey:"component"})}else{const o=K(fe.TEAM_MANAGEMENT_MY_NAME).path,l={tabKey:"component"};q(o,[S.value],!1,!1,l)}},ke=async o=>{T.value=o,Z()},ee=(o,l=!1)=>{E.value=o;const u=A[o].value,R=K(Qe.COMMUNITY_COMPONENT_NAME).path;q(R,void 0,l,!1,{tag:u}),F(!0)},Ne=o=>{P.value=o,j.value=!0},He=o=>{P.value=o.id},te=()=>{I(!1);const o=Xe();if("tag"in o){const l=A.findIndex(u=>u.value===o.tag);l!==-1&&(E.value=l)}else E.value=1;y.value=1,ee(E.value,!0)};te(),Re(()=>{ce(()=>x.value,o=>{if(o){if(y.value+=1,h.value)return;F()}})}),Ue(()=>{j.value=!1});const oe={SelfEnum:be,SortAscendingIcon:a,SortDescendingIcon:e,ChevronDownIcon:z,PersonIcon:N,bottom:x,list:m,inBottom:h,page:y,pageSize:g,scrollTop:H,message:C,remoteComponentStore:r,eventBus:b,createComponentHandleDialogShow:M,createComponentHandleDialogValue:S,dialogOptions:Q,selectId:T,tagsList:Se,activeIndex:E,systemStore:X,designStore:J,detailModelShow:j,detailModelId:P,selectValue:B,sort:D,handleListShow:W,handleSelect:Ee,sortHandle:we,updateHomeSortData:I,getListData:F,closeDialogHandle:L,createComponentHandleDialog:Z,createComponentHandle:De,toComponentPage:$,createHandle:ke,selectHandle:ee,toDetailHandle:Ne,updateDetailHandle:He,initList:te,get NText(){return ue},get NButton(){return me},get NFlex(){return ge},get NIcon(){return pe},ContentCard:Ze,get suffixObj(){return tt},get suffixOptions(){return et},CommunityCardLoad:dt,ShowDetail:We};return Object.defineProperty(oe,"__isScriptSetup",{enumerable:!1,value:!0}),oe}}),mt={class:"community-component-box"},ft=["onClick"],pt={class:"go-flex-center"},gt={class:"content-box"},vt={key:1},ht={key:1,class:"go-flex-center go-mt-3"},yt={style:{"max-height":"80vh",overflow:"auto","padding-top":"10px"}};function _t(s,t,a,e,z,N){const x=_("n-h3"),m=_("n-dropdown"),h=_("n-tooltip"),y=_("n-spin"),g=_("n-divider"),H=_("n-select"),C=_("n-modal");return f(),v(Y,null,[d("div",mt,[n(e.NFlex,{justify:"space-between",align:"center",style:{"margin-bottom":"10px"}},{default:i(()=>[n(x,{style:{"margin-bottom":"0px"}},{default:i(()=>t[4]||(t[4]=[k("全部组件")])),_:1})]),_:1}),n(e.NFlex,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:i(()=>[n(e.NFlex,{class:"tags-list",size:4},{default:i(()=>[(f(!0),v(Y,null,he(e.tagsList,(r,b)=>(f(),v("div",{class:Je(["item",{active:e.activeIndex===b}]),key:r,onClick:M=>e.selectHandle(b)},[n(e.NText,null,{default:i(()=>[k(G(r),1)]),_:2},1024)],10,ft))),128))]),_:1}),d("div",pt,[n(m,{options:e.suffixOptions,onSelect:e.handleSelect},{default:i(()=>[n(e.NButton,{"icon-placement":"right",quaternary:"",size:"small",focusable:!1},{icon:i(()=>[n(e.NIcon,{depth:"3",size:"16"},{default:i(()=>[n(e.ChevronDownIcon)]),_:1})]),default:i(()=>[k(G(e.suffixObj[e.selectValue])+" ",1)]),_:1})]),_:1},8,["options"]),n(h,{placement:"bottom",trigger:"hover","show-arrow":!1},{trigger:i(()=>[n(e.NButton,{class:"go-ml-1",quaternary:"",focusable:!1,size:"small",onClick:e.sortHandle},{icon:i(()=>[n(e.NIcon,{size:"16"},{default:i(()=>[e.sort==="asc"?(f(),V(e.SortAscendingIcon,{key:0})):(f(),V(e.SortDescendingIcon,{key:1}))]),_:1})]),_:1})]),default:i(()=>[d("span",null,G(e.sort==="desc"?"倒序":"正序"),1)]),_:1})])]),_:1}),d("div",gt,[(f(!0),v(Y,null,he(e.list,r=>(f(),v("div",{class:"screen-list",key:r.id},[r.show?(f(),V(e.ContentCard,{key:0,toDetail:!1,"is-hot":!1,cardData:r,onCreate:e.createHandle,onDetail:b=>e.toDetailHandle(r.id)},null,8,["cardData","onDetail"])):(f(),v("div",vt,[n(e.CommunityCardLoad,{isDark:e.designStore.getDarkTheme},null,8,["isDark"])]))]))),128))]),e.inBottom?ve("",!0):(f(),V(e.NFlex,{key:0,justify:"center"},{default:i(()=>[n(y,{class:"go-mt-3",show:e.bottom},null,8,["show"])]),_:1})),e.list.length>12&&e.inBottom?(f(),v("div",ht,[n(e.NText,{depth:3},{default:i(()=>t[5]||(t[5]=[k("已经到底部啦~")])),_:1})])):ve("",!0)]),n(C,{class:"go-background-filter",title:"选择创建位置",preset:"card",size:"small",style:{width:"600px"},show:e.createComponentHandleDialogShow,"onUpdate:show":t[1]||(t[1]=r=>e.createComponentHandleDialogShow=r),"transform-origin":"center",bordered:!0,"content-style":"padding: 0 0 10px;",onAfterLeave:e.closeDialogHandle},{default:i(()=>[n(g,{style:{"margin-top":"4px","margin-bottom":"0"}}),n(e.NFlex,{class:"select-create-target-box"},{default:i(()=>[n(H,{value:e.createComponentHandleDialogValue,"onUpdate:value":t[0]||(t[0]=r=>e.createComponentHandleDialogValue=r),options:e.dialogOptions,style:{flex:"1"}},null,8,["value","options"]),n(e.NButton,{type:"primary",onClick:e.createComponentHandle},{default:i(()=>[n(e.NText,{style:{"font-size":"14px"}},{default:i(()=>t[6]||(t[6]=[k("添加组件")])),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),n(C,{class:"go-background-filter",title:"资源详情",preset:"card",size:"small",style:{width:"80vw","max-width":"1400px"},show:e.detailModelShow,"onUpdate:show":t[2]||(t[2]=r=>e.detailModelShow=r),"transform-origin":"center",bordered:!0,"content-style":"padding: 0 0 10px;",onAfterLeave:t[3]||(t[3]=()=>{})},{default:i(()=>[n(g,{style:{"margin-top":"4px","margin-bottom":"0"}}),d("div",yt,[n(e.ShowDetail,{category:"component",id:e.detailModelId,onUpdateDetail:e.updateDetailHandle},null,8,["id"])])]),_:1},8,["show"])],64)}const jt=xe(ut,[["render",_t],["__scopeId","data-v-b89fd4fa"],["__file","component.vue"]]);export{jt as default};
