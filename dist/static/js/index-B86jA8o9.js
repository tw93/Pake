var Ce=Object.defineProperty,Oe=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var ge=(n,t,s)=>t in n?Ce(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s,te=(n,t)=>{for(var s in t||(t={}))Ee.call(t,s)&&ge(n,s,t[s]);if(fe)for(var s of fe(t))xe.call(t,s)&&ge(n,s,t[s]);return n},ae=(n,t)=>Oe(n,Be(t));import{d as $,e as de,r as I,H as ie,A as ue,f9 as He,a9 as le,R as q,fa as Fe,_ as ee,U as m,t as L,o as u,w as o,s as a,q as b,V as P,X as C,Y as R,c as h,a5 as Me,ac as Le,F as ne,n as be,T as re,b as ke,fb as Te,bO as Pe,ae as Ue,ay as pe,aD as Ae,fc as We,K as qe,fd as Re,fe as Ge,aw as Se,ff as Je,fg as Ve}from"./index-DzJUk-4s.js";import{g as se}from"./plugin-BZaVEG5Y.js";import{u as ce}from"./systemStore-CDAOEx2u.js";import{i as oe}from"./icon-Bt2TghsQ.js";import{A as Ze}from"./index-BBNnqqCS.js";import{A as ze,f as Qe,m as Ke,t as Xe,c as je,a as Ye,h as $e,i as et,j as _e,e as tt}from"./logo-Bd1KfhDG.js";import{n as at}from"./noData-C0vzgK10.js";import{u as ot}from"./indexDBStore-BkJ2w0ZQ.js";import{u as nt}from"./projectStore-BUNtFK-_.js";import{u as st}from"./index-CNsebZrf.js";import"./index-YIaHLc6Z.js";/* empty css                                                              *//* empty css                                                                          */import"./GoUserAvatar-BBITl89l.js";import"./index-DumZb7Zp.js";import"./index-jtCf6VIy.js";import"./file-BoGdIhh5.js";import"./index-B2h3DCGB.js";import"./fileTypeEnum-22QBGXO_.js";import"./config-4CXe4sys.js";import"./config-Df8FU9mm.js";import"./svip-tip-BogTL7q_.js";import"./import-C6j5z5Sk.js";import"./team.api-Dw2fcOfS.js";import"./index-CYCNU51b.js";import"./doc-Br7GyA9J.js";import"./points-Bi1H5gtF.js";import"./project-list-bg-C8sD85Ky.js";import"./masterplates.api-CmXDBnKg.js";import"./chart_default-Cv54ZmSo.js";import"./noCard-C4rQreFQ.js";var he=(n=>(n.MYSQL="MySQL",n.POSTGRESQL="PostgreSQL",n.MICROSOFT_SQL_SERVER="Microsoft SQL Server",n.SQ_LITE="SQLite",n.ORACLE="Oracle",n.MONGO_DB="MongoDB",n.MARIA_DB="MariaDB",n.DM="国产达梦数据库",n))(he||{}),we=(n=>(n.MYSQL="mysql",n.POSTGRESQL="postgres",n.MICROSOFT_SQL_SERVER="mssql",n.SQ_LITE="better-sqlite3",n.ORACLE="oracle",n.MONGO_DB="mongodb",n.MARIA_DB="mariadb",n.DM="dm",n))(we||{}),De=(n=>(n[n.PENDING=0]="PENDING",n[n.LOADING=1]="LOADING",n[n.SUCCESS=2]="SUCCESS",n[n.ERROR=3]="ERROR",n))(De||{});const lt=$({__name:"index",props:{modalShow:{required:!0,type:Boolean},editInfo:{require:!1,type:Object}},emits:["update:modalShow","updateDataList"],setup(n,{expose:t,emit:s}){t();const e=[{label:"MySQL",value:"mysql"},{label:"PostgreSQL",value:"postgres"},{label:"Microsoft SQL Server",value:"mssql"},{label:"SQLite",value:"better-sqlite3"},{label:"Oracle",value:"oracle"},{label:"MongoDB",value:"mongodb"},{label:"MariaDB",value:"mariadb"},{label:"国产达梦数据库",value:"dm"}],S={database:"",dbName:"",host:"",port:"3306",username:"",password:"",dbType:"mysql"},w={mysql:"3306",oracle:"1521",dm:"3306"},c=s,r=n,d=ce(),v=de(()=>d.getTeamInfo),l=I(!1),i=I(null),H=I(!0),O=I(!1),p=I(0),A=ie(S),y={database:{required:!0,message:"请输入数据库名称",trigger:"input"},dbName:{required:!1,message:"请输入备注名",trigger:"input"},dbType:{required:!0,message:"请选择类型",trigger:"input"},host:{required:!0,message:"请输入地址",trigger:"input"},port:{required:!0,message:"请输入端口号",trigger:"input"},username:{required:!0,message:"请输入用户名",trigger:"input"},password:{required:!1,message:"请输入密码",trigger:"input"}};ue(()=>r.modalShow,E=>{if(r.editInfo){l.value=!0;const{database:M,dbName:J,host:V,port:U,username:T,password:Z,dbType:W}=r.editInfo;A.database=M,A.dbName=J,A.host=V,A.port=U,A.username=T,A.password=Z,A.dbType=W}H.value=E},{immediate:!0});const x=E=>{A.port=w[E]||"3306"},X=async()=>{var E;(E=i.value)==null||E.validate(async M=>{if(!M&&A){p.value=1;const{database:J,dbName:V,host:U,port:T,username:Z,dbType:W,password:j}=A;try{(await He({database:J,dbName:V,host:U,port:T,password:le(j),username:Z,dbType:W,isTest:!0})).code===q.SUCCESS?setTimeout(()=>{p.value=2},500):p.value=3}catch(Y){setTimeout(()=>{p.value=3},500)}}})},D=()=>{H.value=!1,l.value=!1,c("update:modalShow",!1)},F={DataBaseTypeLabelEnum:he,DataBaseTypeEnum:we,ConnectStatusEnum:De,databaseTypeOptions:e,defaultData:S,defaultPort:w,emit:c,props:r,systemStore:d,teamInfo:v,isEdit:l,formRef:i,showRef:H,saveLoading:O,connectStatus:p,formValue:A,rules:y,handleUpdateSelectDBValue:x,testHandle:X,closeHandle:D,createHandle:async()=>{var E;(E=i.value)==null||E.validate(async M=>{if(!M&&A){O.value=!0;const{database:J,dbName:V,host:U,port:T,username:Z,dbType:W,password:j}=A,Y=K=>{K.code===q.SUCCESS&&(O.value=!1,window.$message.success("创建成功！"),D(),c("updateDataList"))};try{const K=v.value.id;let z={};l.value&&r.editInfo?se({message:"修改数据库配置，需要重新输入密码，是否保存？",promise:!0,onPositiveCallback:async()=>{var f;return z=await Fe({id:(f=r==null?void 0:r.editInfo)==null?void 0:f.id,database:J,dbName:V,host:U,port:T,password:le(j),username:Z,dbType:W,team_id:K}),Y(z),z},onNegativeCallback:()=>{O.value=!1}}):(z=await He({database:J,dbName:V,host:U,port:T,password:le(j),username:Z,dbType:W,team_id:K}),Y(z))}catch(K){O.value=!1,window.$message.error("创建失败, 请稍后重试！")}}})}};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),rt={class:"content"},dt={class:"connection-btn"},it={class:"create-btn"};function ut(n,t,s,e,S,w){const c=m("n-divider"),r=m("n-input"),d=m("n-form-item"),v=m("n-select"),l=m("n-button"),i=m("n-text"),H=m("n-form"),O=m("n-modal");return u(),L(O,{class:"go-create-data-base go-background-filter",title:"创建数据库",preset:"card",size:"small",style:{width:"520px"},show:e.showRef,"onUpdate:show":t[7]||(t[7]=p=>e.showRef=p),"transform-origin":"center",bordered:!0,onAfterLeave:e.closeHandle},{default:o(()=>[a(c,{style:{"margin-top":"4px"}}),b("div",rt,[e.formValue?(u(),L(H,{key:0,ref:"formRef",size:"medium","label-placement":"left",model:e.formValue,"label-width":70,rules:e.rules},{default:o(()=>[a(d,{label:"连接名",path:"dbName"},{default:o(()=>[a(r,{value:e.formValue.dbName,"onUpdate:value":t[0]||(t[0]=p=>e.formValue.dbName=p),type:"text",maxlength:"100","show-count":"",placeholder:"请输入连接名"},null,8,["value"])]),_:1}),a(d,{label:"类型",path:"type"},{default:o(()=>[a(v,{value:e.formValue.dbType,"onUpdate:value":[t[1]||(t[1]=p=>e.formValue.dbType=p),e.handleUpdateSelectDBValue],options:e.databaseTypeOptions,placeholder:"请选择类型"},null,8,["value"])]),_:1}),a(d,{label:"地址",path:"host"},{default:o(()=>[a(r,{value:e.formValue.host,"onUpdate:value":t[2]||(t[2]=p=>e.formValue.host=p),placeholder:"请输入地址"},null,8,["value"])]),_:1}),a(d,{label:"端口号",path:"port"},{default:o(()=>[a(r,{value:e.formValue.port,"onUpdate:value":t[3]||(t[3]=p=>e.formValue.port=p),placeholder:"请输入端口号"},null,8,["value"])]),_:1}),a(d,{label:"数据库名称",path:"database"},{default:o(()=>[a(r,{value:e.formValue.database,"onUpdate:value":t[4]||(t[4]=p=>e.formValue.database=p),type:"text",maxlength:"100","show-count":"",placeholder:"请输入数据库名称"},null,8,["value"])]),_:1}),a(d,{label:"用户名",path:"username"},{default:o(()=>[a(r,{value:e.formValue.username,"onUpdate:value":t[5]||(t[5]=p=>e.formValue.username=p),placeholder:"请输入用户名"},null,8,["value"])]),_:1}),a(d,{label:"密码",path:"password"},{default:o(()=>[a(r,{value:e.formValue.password,"onUpdate:value":t[6]||(t[6]=p=>e.formValue.password=p),type:"password",placeholder:"请输入密码",hidden:"",autocomplete:"new-password"},null,8,["value"])]),_:1}),a(d,null,{default:o(()=>[b("div",dt,[a(l,{type:"info",secondary:"",onClick:e.testHandle},{default:o(()=>t[8]||(t[8]=[C("连接测试")])),_:1}),e.connectStatus===e.ConnectStatusEnum.LOADING?(u(),L(i,{key:0,class:"go-pl-2",depth:3},{default:o(()=>t[9]||(t[9]=[C(" 进行连接中..... ")])),_:1})):e.connectStatus===e.ConnectStatusEnum.SUCCESS?(u(),L(l,{key:1,class:"go-pl-2",type:"success",text:""},{default:o(()=>t[10]||(t[10]=[C(" 连接成功！ ")])),_:1})):e.connectStatus===e.ConnectStatusEnum.ERROR?(u(),L(l,{key:2,class:"go-pl-2",type:"error",text:""},{default:o(()=>t[11]||(t[11]=[C(" 连接失败！请检查配置 ")])),_:1})):P("",!0)])]),_:1}),a(d,null,{default:o(()=>[b("div",it,[a(l,{type:"primary",loading:e.saveLoading,onClick:e.createHandle},{default:o(()=>[C(R(e.isEdit?"保存":"完成创建"),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])):P("",!0)])]),_:1},8,["show"])}const ye=ee(lt,[["render",ut],["__scopeId","data-v-57e23daf"],["__file","index.vue"]]),ct="data:image/png;base64,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",mt="data:image/png;base64,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",vt="/static/png/microsoftsqlserver.png",ft="/static/png/sqlite.png",gt="/static/png/oracle.png",Ht="/static/png/mongodb.png",pt="/static/png/mariadb.png",At="/static/png/cockroachdb.png",St="/static/png/dm.png",_t=$({__name:"DataBaseItemCard",props:{cardData:Object,index:Number},emits:["delete","edit","desc"],setup(n,{expose:t,emit:s}){t();const e=I(window.__PRIVATE_MODULE__.CloseOpenAI),S=n,w=s,{TrashOutlineIcon:c}=oe.ionicons5,{EditIcon:r,DataBaseIcon:d,DatastoreIcon:v}=oe.carbon,l=I(!1),A={CloseOpenAI:e,props:S,emit:w,TrashOutlineIcon:c,EditIcon:r,DataBaseIcon:d,DatastoreIcon:v,restoreLoading:l,deleteHandle:()=>{w("delete",S.cardData,S.index)},editHandle:()=>{w("edit",S.cardData,S.index)},descHandle:()=>{w("desc",S.cardData,S.index)},restoreHandle:()=>{l.value=!0,setTimeout(()=>{l.value=!1,window.$message.success("操作成功")},1e3)},get mysqlImg(){return ct},get postgresql(){return mt},get microsoftsqlserver(){return vt},get sqlite(){return ft},get oracle(){return gt},get mongodb(){return Ht},get mariadb(){return pt},get cockroachdb(){return At},get dm(){return St}};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}}),bt={key:0,class:"go-items-list-card"},ht={class:"list-content"},wt={class:"top-info"},Dt=["src"],yt=["src"],Nt=["src"],It=["src"],Ct=["src"],Ot=["src"],Bt=["src"],Et=["src"],xt=["src"],Ft={class:"go-flex-items-center list-footer",justify:"space-between"},Mt={class:"go-flex-center"},Lt={class:"go-flex-items-center list-footer-ri"};function kt(n,t,s,e,S,w){const c=m("n-text"),r=m("n-icon"),d=m("n-button"),v=m("n-tooltip"),l=m("n-card");return s.cardData?(u(),h("div",bt,[a(l,{hoverable:"",size:"small"},{action:o(()=>[b("div",Ft,[b("div",Mt,[a(r,{size:20,color:"#e6923d"},{default:o(()=>[a(e.DataBaseIcon)]),_:1}),a(c,{class:"go-ellipsis-1 go-ml-1",title:s.cardData.dbName||"未命名"},{default:o(()=>[C(R(s.cardData.dbName||"未命名"),1)]),_:1},8,["title"])]),b("div",Lt,[e.CloseOpenAI?P("",!0):(u(),L(v,{key:0,trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:o(()=>[a(d,{text:"",loading:e.restoreLoading,focusable:!1,onClick:e.descHandle},{icon:o(()=>[a(r,null,{default:o(()=>[a(e.DatastoreIcon)]),_:1})]),_:1},8,["loading"])]),default:o(()=>[t[0]||(t[0]=C(" 配置表和字段内容 "))]),_:1})),a(v,{trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:o(()=>[a(d,{text:"",loading:e.restoreLoading,focusable:!1,onClick:e.editHandle},{icon:o(()=>[a(r,null,{default:o(()=>[a(e.EditIcon)]),_:1})]),_:1},8,["loading"])]),default:o(()=>[t[1]||(t[1]=C(" 编辑 "))]),_:1}),a(v,{trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:o(()=>[a(d,{text:"",focusable:!1,onClick:e.deleteHandle},{icon:o(()=>[a(r,null,{default:o(()=>[a(e.TrashOutlineIcon)]),_:1})]),_:1})]),default:o(()=>[t[2]||(t[2]=C(" 删除 "))]),_:1})])])]),default:o(()=>[b("div",ht,[b("div",wt,[b("div",null,[a(c,{depth:3},{default:o(()=>[C("连接名："+R(s.cardData.dbName),1)]),_:1}),a(c,{depth:3},{default:o(()=>[C("数据库："+R(s.cardData.database),1)]),_:1}),a(c,{depth:3},{default:o(()=>[C("端口："+R(s.cardData.port),1)]),_:1})]),s.cardData.dbType==="mysql"?(u(),h("img",{key:0,src:e.mysqlImg,alt:"mysqlImg"},null,8,Dt)):s.cardData.dbType==="postgresql"?(u(),h("img",{key:1,src:e.postgresql,alt:"postgresql"},null,8,yt)):s.cardData.dbType==="microsoftsqlserver"?(u(),h("img",{key:2,src:e.microsoftsqlserver,alt:"microsoftsqlserver"},null,8,Nt)):s.cardData.dbType==="sqlite"?(u(),h("img",{key:3,src:e.sqlite,alt:"sqlite"},null,8,It)):s.cardData.dbType==="oracle"?(u(),h("img",{key:4,src:e.oracle,alt:"oracle"},null,8,Ct)):s.cardData.dbType==="mongodb"?(u(),h("img",{key:5,src:e.mongodb,alt:"mongodb"},null,8,Ot)):s.cardData.dbType==="mariadb"?(u(),h("img",{key:6,src:e.mariadb,alt:"mariadb"},null,8,Bt)):s.cardData.dbType==="cockroachdb"?(u(),h("img",{key:7,src:e.cockroachdb,alt:"cockroachdb"},null,8,Et)):s.cardData.dbType==="dm"?(u(),h("img",{key:8,src:e.dm,alt:"dm"},null,8,xt)):(u(),L(c,{key:9,depth:3,style:{"font-size":"18px"}},{default:o(()=>[C(R(s.cardData.dbType),1)]),_:1}))])])]),_:1})])):P("",!0)}const Tt=ee(_t,[["render",kt],["__scopeId","data-v-1fbd1473"],["__file","DataBaseItemCard.vue"]]),Pt="/static/png/create-file.png";var Ne=(n=>(n.CREATE="create",n))(Ne||{});const Ut=$({__name:"CreateDataBase",emits:["updateDataList"],setup(n,{expose:t,emit:s}){t(),Me(H=>({"5eb436fb":d.value}));const{AddIcon:e}=oe.ionicons5,S=[{label:"创建数据库",desc:"多库查询，自由组合",img:Pt,key:"create"}],w=s,c=Le(),r=I(!1),d=de(()=>c.getAppTheme),i={AddIcon:e,ListItemEnum:Ne,listItem:S,emit:w,designStore:c,modalShow:r,themeColor:d,clickHandle:async H=>{H==="create"&&(r.value=!0)},updateDataList:()=>{w("updateDataList")},get CreateDataBase(){return ye}};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}}),Wt={class:"go-project-create-box"},qt=["onClick"],Rt={class:"go-flex-center"},Gt=["src"],Jt={class:"right-desc"},Vt={class:"label"};function Zt(n,t,s,e,S,w){const c=m("n-text"),r=m("n-icon"),d=m("n-grid-item"),v=m("n-grid");return u(),h("div",Wt,[a(v,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:3 xl:4 xxl:4",responsive:"screen"},{default:o(()=>[(u(),h(ne,null,be(e.listItem,l=>a(d,{key:l.key},{default:o(()=>[b("div",{class:"item go-flex-center go-transition-quick",onClick:i=>e.clickHandle(l.key)},[b("div",Rt,[b("img",{class:"go-transition",src:l.img,alt:"创建"},null,8,Gt),b("div",Jt,[b("div",Vt,R(l.label),1),a(c,{class:"desc",depth:3},{default:o(()=>[C(R(l.desc),1)]),_:2},1024)])]),a(r,{size:"16",component:e.AddIcon},null,8,["component"])],8,qt)]),_:2},1024)),64))]),_:1}),a(e.CreateDataBase,{modalShow:e.modalShow,"onUpdate:modalShow":t[0]||(t[0]=l=>e.modalShow=l),onUpdateDataList:e.updateDataList},null,8,["modalShow"])])}const zt=ee(Ut,[["render",Zt],["__scopeId","data-v-58131ff7"],["__file","CreateDataBase.vue"]]),Qt=$({__name:"CommonAIChat",props:{width:{},contentHeight:{},isVertical:{type:Boolean},hiddenBtn:{type:Boolean},messageList:{}},emits:["send","useResponse"],setup(n,{expose:t,emit:s}){const e=n,S=s,w=I();re("width",e.width),re("hiddenBtn",e.hiddenBtn),re("isVertical",e.isVertical);const c=i=>i.map(H=>ae(te({},H),{type:Ke[H.type]})),r=i=>{var H;(H=w.value)==null||H.setValue(i)},d=i=>{S("useResponse",i)},v=()=>{var i;(i=w.value)==null||i.unLoading()};t({unLoading:v,setValue:r});const l={props:e,emit:S,AIChatInputRef:w,handleTypeValue:c,editHandle:r,sqlHandle:d,unLoading:v,AIChatContent:Qe,AILogo:ze};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),Kt={class:"go-data-base-ai-chat"},Xt={key:0,class:"no-date-content"},jt={class:"chat-bottom"};function Yt(n,t,s,e,S,w){const c=m("n-flex"),r=m("n-h2"),d=m("n-text"),v=m("n-card");return u(),L(v,{size:"small","content-style":{padding:0},style:{flex:"1"}},{default:o(()=>{var l;return[b("div",Kt,[a(e.AIChatContent,{contentHeight:s.contentHeight,messageList:e.handleTypeValue(s.messageList),onEdit:e.editHandle,onUseResponse:e.sqlHandle,style:{flex:"1"}},null,8,["contentHeight","messageList"]),!s.messageList||!((l=s.messageList)!=null&&l.length)?(u(),h("div",Xt,[a(r,null,{default:o(()=>[a(c,{align:"center"},{default:o(()=>[t[0]||(t[0]=C(" 欢迎使用 GoView AI ")),a(e.AILogo,{class:"ai-logo"})]),_:1})]),_:1}),a(d,{depth:3},{default:o(()=>t[1]||(t[1]=[C("该功能由AI提供支持，因此可能会存在错误，请在使用前仔细检查输出内容。")])),_:1})])):P("",!0),b("div",jt,[ke(n.$slots,"bottom",{},void 0,!0)])])]}),_:3})}const $t=ee(Qt,[["render",Yt],["__scopeId","data-v-0739ad1f"],["__file","CommonAIChat.vue"]]),ea=$({__name:"EditDataBaseDesc",props:Te({editInfo:{require:!1,type:Object}},{modalShow:{},modalShowModifiers:{}}),emits:["update:modalShow"],setup(n,{expose:t}){t();const s=n,e=1,{RefreshIcon:S}=oe.ionicons5,{TableSplitIcon:w}=oe.carbon,c=ot(),r=ce(),d=Pe(n,"modalShow"),v=I(!0),l=I(!1),i=I(!1);let H=null;const O=I(!1),p=I(null),A=I(null),y=I(null),x=I([]),X=[{title:"字段名",key:"name",width:110},{title:"类型",key:"type",width:90},{title:"描述",key:"desc",render(f,g){return pe(Ae,{value:f.desc,size:"small",clearable:!0,placeholder:"请输入该字段的描述",onUpdateValue(_){x.value[g].desc=_,O.value=!0}})}}],D=ie([]),G=()=>pe("img",{src:Xe,style:{width:"22px"}}),F=I([]),E=async()=>{var g;v.value=!0;const f=await We({id:(g=s.editInfo)==null?void 0:g.id});f.code===q.SUCCESS&&(f!=null&&f.data.length?F.value=f.data.map(_=>ae(te({},_),{label:_.dbName,key:_.id,icon:G})):F.value=[]),v.value=!1},M=async(f=!1)=>{const g=async()=>{var B,k;l.value=!0;const _=await Ge({id:(B=s.editInfo)==null?void 0:B.id});l.value=!1,_.code===q.SUCCESS&&((k=_==null?void 0:_.data)!=null&&k.length?(window.$message.success(f?"同步成功":"初始化成功"),await E()):window.$message.warning("当前数据库无任何内容"))};f?se({message:"是否同步远程数据库？该操作将合并新数据。",onPositiveCallback:async()=>{await g()}}):await g()},J=(f,g)=>{var _;O.value=!1,y.value=g.describe||"",A.value=g,Array.isArray(g.columns)&&(x.value=((_=g.columns)==null?void 0:_.map(B=>ae(te({},B),{desc:(B==null?void 0:B.desc)||""})))||[])},V=async()=>{var f,g;(f=A.value)!=null&&f.dbName&&(i.value=!0,D.push(je(`请帮我分析表 ${(g=A.value)==null?void 0:g.dbName} 的结构`)),setTimeout(async()=>{var k,Q;D.push(Ye("正在解析中，预计还需10～30秒，请稍等..."));const _={json:{table:(k=A.value)==null?void 0:k.dbName,columns:(Q=x.value)==null?void 0:Q.map(N=>({name:N.name,type:N.type}))}};(await $e(_)).code===q.SUCCESS&&U()},500),setTimeout(()=>{i.value=!1},3e3))},U=()=>{H=setInterval(async()=>{T(f=>{f!=null&&f.length&&clearInterval(H)})},3e3)},T=async f=>{const g=await et({});g.code===q.SUCCESS&&g.data&&(await c.pushDataBaseDescAIResponseDB(g.data),g.data.forEach(_=>{D.push(_e(_.AIContent,_.parsedData))}),f&&f(g.data))},Z=()=>{window.$message.success("当前场景无法编辑发送内容")},W=f=>{const g=/(```[\s\S]*?```|`.*?`)|\\\[([\s\S]*?[^\\])\\\]|\\\((.*?)\\\)/g;return f.replace(g,(_,B,k,Q)=>B||(k?`$$${k}$$`:Q?`$${Q}$`:_))},j=f=>{var B,k,Q;const _=W(f).replace(/```json/g,"").replace(/```/g,"");try{const N=JSON.parse(_);if(N.table&&qe.isString(N.table)&&(N.table={name:N.table,desc:N.desc}),((B=N==null?void 0:N.table)==null?void 0:B.name)!==((k=A.value)==null?void 0:k.dbName)){window.$message.error(`当前数据表不一致，请切换到表 ${(Q=N==null?void 0:N.table)==null?void 0:Q.name} 再进行应用`);return}N!=null&&N.table&&(y.value=N.table.desc),Array.isArray(N==null?void 0:N.columns)&&(N.columns.forEach(me=>{const ve=x.value.findIndex(Ie=>Ie.name===me.name);ve!==-1&&(x.value[ve].desc=me.desc)}),O.value=!0,window.$message.success("应用数据成功"))}catch(N){window.$message.error("应用数据失败，请手动复制内容")}};ue(()=>d.value,async f=>{if(f){i.value=!0;const g=await c.getDataBaseDescAIResponseDB();g!=null&&g.length&&(D.length=0,g.forEach(_=>{D.push(_e(_.AIContent,_.parsedData))})),Promise.all([E(),T()]).then(()=>{D.push(tt("历史消息（仅包含AI内容）")),i.value=!1})}});const Y=()=>{se({message:"是否保存修改？",onPositiveCallback:async()=>{if((await Re(ae(te({},A.value),{describe:y.value,columns:x.value}))).code===q.SUCCESS){window.$message.success("保存成功");const g=F.value.findIndex(_=>{var B;return _.id===((B=A.value)==null?void 0:B.id)});g!==-1&&(F.value[g].describe=y.value,F.value[g].columns=x.value),O.value=!1}else window.$message.error("保存失败")}})},K=()=>{p.value=null,y.value=null,A.value=null,x.value=[],F.value=[],D.length=0,d.value=!1,clearInterval(H)};Ue(()=>{clearInterval(H)});const z={props:s,buildType:e,RefreshIcon:S,TableSplitIcon:w,indexDBStore:c,systemStore:r,modalShow:d,loading:v,initLoading:l,AILoading:i,get intervalTime(){return H},set intervalTime(f){H=f},tableDataChange:O,activeKey:p,activeItem:A,tableDesc:y,tableData:x,columns:X,messageList:D,renderIcon:G,menuOptions:F,getDataBaseTable:E,initHandle:M,selectTableHandle:J,AIHandle:V,getAIHandle:U,getAIDataToIndexDB:T,AIEditHandle:Z,escapeBrackets:W,useResponseHandle:j,saveHandle:Y,closeHandle:K,get NInput(){return Ae},AIBtn:Ze,CommonAIChat:$t,get noData(){return at}};return Object.defineProperty(z,"__isScriptSetup",{enumerable:!1,value:!0}),z}}),ta={key:0,class:"content-layout"},aa={class:"content-box go-flex-center"},oa={class:"bottom"},na={key:0,class:"content-layout"},sa={class:"content-box"},la={class:"left-aside"},ra={key:0,class:"right-box"},da={key:0,class:"ai-box"},ia={key:0,class:"ai-box-btn"},ua={key:1,class:"ai-box-btn"},ca={key:1,class:"ai-box"},ma={key:0,class:"ai-box-btn"},va=["src"],fa={class:"bottom"},ga={key:1,class:"content-layout"},Ha={class:"content-box go-flex-center"},pa=["src"];function Aa(n,t,s,e,S,w){const c=m("n-divider"),r=m("n-spin"),d=m("n-button"),v=m("n-flex"),l=m("n-menu"),i=m("n-data-table"),H=m("n-text"),O=m("n-badge"),p=m("n-result"),A=m("n-modal");return u(),L(A,{class:"go-create-data-base go-background-filter",title:"编辑数据库信息",preset:"card",size:"small",style:{width:"1300px"},show:e.modalShow,"onUpdate:show":t[4]||(t[4]=y=>e.modalShow=y),"transform-origin":"center",bordered:!0,"close-on-esc":!1,"mask-closable":!1,onAfterLeave:e.closeHandle},{default:o(()=>[a(c,{style:{"margin-top":"4px","margin-bottom":"0"}}),e.loading?(u(),h("div",ta,[b("div",aa,[a(r,null,{description:o(()=>t[5]||(t[5]=[C(" 加载数据中... ")])),_:1})]),a(c,{style:{margin:"0"}}),b("div",oa,[a(v,{size:0},{default:o(()=>[a(d,{class:"move-btn",focusable:!1,onClick:e.closeHandle},{default:o(()=>t[6]||(t[6]=[b("span",null,"关闭",-1)])),_:1})]),_:1})])])):(u(),h(ne,{key:1},[e.menuOptions.length?(u(),h("div",na,[b("div",sa,[b("div",la,[a(l,{value:e.activeKey,"onUpdate:value":[t[0]||(t[0]=y=>e.activeKey=y),e.selectTableHandle],options:e.menuOptions,responsive:""},null,8,["value","options"])]),a(c,{vertical:"",style:{height:"100%",margin:"0"}}),e.activeKey?(u(),h("div",ra,[a(v,{size:12,vertical:""},{default:o(()=>[a(e.NInput,{value:e.tableDesc,"onUpdate:value":t[1]||(t[1]=y=>e.tableDesc=y),autofocus:!0,clearable:!0,autosize:{minRows:2,maxRows:2},size:"small",type:"textarea",placeholder:"请描述当前数据表的作用",onInput:t[2]||(t[2]=y=>e.tableDataChange=!0)},null,8,["value"]),a(i,{columns:e.columns,data:e.tableData,size:"small","row-key":y=>y.name,"flex-height":"",bordered:!0,style:{height:"366px"}},null,8,["data","row-key"]),a(v,null,{default:o(()=>[a(O,{value:1,show:e.tableDataChange,dot:"",processing:""},{default:o(()=>[a(d,{class:"move-btn",type:"primary",focusable:!1,disabled:!e.tableDataChange,onClick:e.saveHandle},{default:o(()=>[a(H,null,{default:o(()=>{var y;return[C("保存「 "+R((y=e.activeItem)==null?void 0:y.label)+" 」",1)]}),_:1})]),_:1},8,["disabled"])]),_:1},8,["show"])]),_:1})]),_:1}),e.buildType===1?(u(),h("div",da,[a(e.CommonAIChat,{messageList:e.messageList,isVertical:!0,width:560,contentHeight:395,style:{height:"430px",overflow:"auto"},onEdit:e.AIEditHandle,onUseResponse:e.useResponseHandle},null,8,["messageList"]),e.systemStore.getMembershipInfo.model?(u(),h("div",ia,[a(e.AIBtn,{loading:e.AILoading,title:"AI一键分析",tooltip:"AI智能解析数据表含义",onClick:e.AIHandle},null,8,["loading"])])):(u(),h("div",ua,[a(e.AIBtn,{title:"AI一键分析",tooltip:"请配置 OpenAI",disabled:!0})]))])):e.systemStore.getMembershipInfo.model?(u(),h("div",ca,[a(e.CommonAIChat,{messageList:e.messageList,isVertical:!0,width:560,contentHeight:395,style:{height:"430px",overflow:"auto"},onEdit:e.AIEditHandle,onUseResponse:e.useResponseHandle},null,8,["messageList"]),e.systemStore.getMembershipInfo.model?(u(),h("div",ma,[a(e.AIBtn,{loading:e.AILoading,title:"AI一键分析",tooltip:"AI智能解析数据表含义",onClick:e.AIHandle},null,8,["loading"])])):P("",!0)])):P("",!0)])):(u(),L(p,{key:1,class:"no-data-box",description:"请在左侧列表中选择对应数据表"},{icon:o(()=>[b("img",{src:e.noData,alt:"暂无数据",width:"200"},null,8,va)]),_:1}))]),a(c,{style:{margin:"0"}}),b("div",fa,[a(v,{size:20},{default:o(()=>[a(d,{type:"warning",secondary:"",onClick:t[3]||(t[3]=y=>e.initHandle(!0)),loading:e.initLoading},{icon:o(()=>[a(e.RefreshIcon)]),default:o(()=>[a(H,null,{default:o(()=>t[7]||(t[7]=[C(" 更新数据表 ")])),_:1})]),_:1},8,["loading"]),a(d,{class:"move-btn",focusable:!1,onClick:e.closeHandle},{default:o(()=>t[8]||(t[8]=[b("span",null,"关闭",-1)])),_:1})]),_:1})])])):(u(),h("div",ga,[b("div",Ha,[a(p,{description:"暂无数据，请检查数据库是否初始化或有数据内容"},{icon:o(()=>[b("img",{src:e.noData,alt:"暂无数据",width:"200"},null,8,pa)]),default:o(()=>[a(d,{type:"primary",onClick:e.initHandle,loading:e.initLoading},{default:o(()=>[a(H,null,{default:o(()=>t[9]||(t[9]=[C(" 点击进行初始化 ")])),_:1})]),_:1},8,["loading"])]),_:1})])]))],64))]),_:1},8,["show"])}const Sa=ee(ea,[["render",Aa],["__scopeId","data-v-d3bd4ac3"],["__file","EditDataBaseDesc.vue"]]),_a=$({__name:"index",setup(n,{expose:t}){t();const s=I(!1),e=I(!1),S=I(!0),w=I({}),c=nt(),{page:r,pageSize:d,inBottom:v,list:l}=st(),i=ie({sortKey:"updateAt",sortValue:"desc"}),H=ce(),O=de(()=>H.getTeamInfo),p=D=>{D.port=D.port+"",w.value=D,Se(()=>{s.value=!0})},A=D=>{w.value=D,Se(()=>{e.value=!0})},y=(D,G)=>{se({message:"是否删除数据库",onPositiveCallback:async()=>{try{(await Je({id:D.id})).code===q.SUCCESS&&(window.$message.success("删除成功!"),l.value.splice(G,1))}catch(F){window.$message.error("删除失败, 请稍后重试!")}}})},x=async(D=!1)=>{try{S.value=!0;const G=O.value.id,{sortKey:F,sortValue:E}=i;D&&(r.value=1);const M=await Ve({sortKey:F,sortValue:E,pageSize:d.value,page:r.value,teamId:G});S.value=!1,M.code===q.SUCCESS&&(D&&(l.value=[]),M.data.data.length===0||M.data.data.length<d.value?v.value=!0:v.value=!1,l.value.push(...M.data.data))}catch(G){window.$message.error("获取数据失败, 请稍后重试!")}};ue(()=>c.getHomeSort,D=>{i.sortKey=D.sortKey,i.sortValue=D.sortValue,r.value=1,l.value=[],x(!0)},{immediate:!0});const X={modalShow:s,dataBaseDescModal:e,fetchDataLoading:S,editInfo:w,projectStore:c,page:r,pageSize:d,inBottom:v,list:l,homeSort:i,systemStore:H,teamInfo:O,editHandle:p,descHandle:A,deleteHandle:y,findAllList:x,get CreateDataBaseModal(){return ye},DataBaseItemCard:Tt,CreateDataBase:zt,EditDataBaseDesc:Sa};return Object.defineProperty(X,"__isScriptSetup",{enumerable:!1,value:!0}),X}}),ba={class:"go-data-base-list"},ha={key:0,class:"loading-box"},wa={key:1,class:"go-flex-center go-mt-3"};function Da(n,t,s,e,S,w){const c=m("n-grid-item"),r=m("n-grid"),d=m("n-spin"),v=m("n-text"),l=m("n-flex");return u(),h(ne,null,[a(e.CreateDataBase,{onUpdateDataList:t[0]||(t[0]=i=>e.findAllList(!0))}),b("div",ba,[a(r,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:3 xl:4 xxl:4",responsive:"screen"},{default:o(()=>[(u(!0),h(ne,null,be(e.list,(i,H)=>(u(),L(c,{key:i.id},{default:o(()=>[a(e.DataBaseItemCard,{cardData:i,index:H,onDelete:e.deleteHandle,onEdit:e.editHandle,onDesc:e.descHandle},null,8,["cardData","index"])]),_:2},1024))),128))]),_:1}),e.fetchDataLoading?(u(),h("div",ha,[a(d,{size:"large"})])):P("",!0),!e.fetchDataLoading&&e.list.length>12&&e.inBottom?(u(),h("div",wa,[a(v,{depth:3},{default:o(()=>t[4]||(t[4]=[C("已经到底部啦~")])),_:1})])):P("",!0),!e.fetchDataLoading&&e.list.length===0?(u(),L(l,{key:2,class:"go-flex-center",vertical:"",style:{"margin-top":"100px","user-select":"none"}},{default:o(()=>[a(v,{depth:3,style:{"font-size":"16px"}},{default:o(()=>t[5]||(t[5]=[C("暂无数据，请点击创建数据库")])),_:1})]),_:1})):P("",!0)]),a(e.CreateDataBaseModal,{modalShow:e.modalShow,"onUpdate:modalShow":t[1]||(t[1]=i=>e.modalShow=i),editInfo:e.editInfo,onUpdateDataList:t[2]||(t[2]=i=>e.findAllList(!0))},null,8,["modalShow","editInfo"]),a(e.EditDataBaseDesc,{modalShow:e.dataBaseDescModal,"onUpdate:modalShow":t[3]||(t[3]=i=>e.dataBaseDescModal=i),editInfo:e.editInfo},null,8,["modalShow","editInfo"])],64)}const oo=ee(_a,[["render",Da],["__scopeId","data-v-bc8c52ab"],["__file","index.vue"]]);export{oo as default};
