import{d as V,r as R,H as ye,A as ne,_ as Q,U as o,c as A,o as g,s as n,w as a,q as v,F as U,n as G,Y as H,aS as Ye,X as c,t as T,aI as J,f0 as P,V as z,a5 as We,e as Je,ac as Ke,W as ae,$ as ue,fp as $,e$ as C,fo as K,fq as Xe,G as Ze,fg as be,bt as Ee,R as W,fr as $e,fb as fe,bO as et,ay as ee,K as tt,aw as te,fc as nt}from"./index-DzJUk-4s.js";import{Y as oe,Z as re,u as Fe}from"./index-B2h3DCGB.js";import{c as se}from"./index-DkV0_qOD.js";import{s as le,a as at}from"./index-DnNrz6w_.js";import{i as j}from"./icon-Bt2TghsQ.js";import{M as ie}from"./index-DumZb7Zp.js";import{D as ut}from"./DataBaseAIChat-Dq68Jh7Q.js";import{g as ve}from"./plugin-BZaVEG5Y.js";import{t as ot,c as rt,n as st,o as lt,a as it,p as dt,j as _e,e as mt}from"./logo-Bd1KfhDG.js";import{u as gt}from"./indexDBStore-BkJ2w0ZQ.js";const ct=V({__name:"index",props:{target:{type:Object,required:!0,default:()=>{}},editDisabled:{type:Boolean,required:!1,default:!1}},emits:["update"],setup(D,{expose:t,emit:l}){t();const e=l,B=D,{MaximizeIcon:k}=j.carbon,_=R(!1),p=R(!1);let r=-1;const E=R(""),q={key:"",value:"",error:!1},s=ye({content:[]}),f=(b,y)=>{p.value=!0,E.value=b.value,r=y},m=()=>{let b=0;if(s.content.forEach(y=>{y.key!==""&&y.value==""||y.key===""&&y.value!==""?y.error=!0:(b++,y.error=!1)}),b==s.content.length){const y={};s.content.forEach(I=>{I.key&&(y[I.key]=I.value)}),e("update",y)}},F=b=>{s.content.splice(b+1,0,{key:"",value:"",error:!1})},d=b=>{s.content.length!==1&&s.content.splice(b,1),m()},x=()=>{r>-1&&(r<s.content.length&&(s.content[r].value=E.value),r=-1,E.value="")};ne(()=>B.target,b=>{s.content=[];for(const y in b)s.content.push({key:y,value:b[y],error:!1});s.content.length||(s.content=[JSON.parse(JSON.stringify(q))])},{immediate:!0,deep:!0});const u={emits:e,props:B,MaximizeIcon:k,error:_,showModal:p,get editTargetIndex(){return r},set editTargetIndex(b){r=b},monacoEditor:E,defaultItem:q,tableArray:s,maxEdit:f,blur:m,add:F,remove:d,onPositiveClick:x,MonacoEditor:ie};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}}),pt={style:{width:"80px"}};function ft(D,t,l,e,B,k){const _=o("n-input"),p=o("n-icon"),r=o("n-button"),E=o("n-table"),q=o("n-divider"),s=o("n-modal");return g(),A(U,null,[n(E,{class:"go-request-header-table-box","single-line":!1,size:"small"},{default:a(()=>[t[6]||(t[6]=v("thead",null,[v("tr",null,[v("th"),v("th",null,"Key"),v("th",null,"Value"),v("th",null,"操作"),v("th",null,"结果")])],-1)),v("tbody",null,[(g(!0),A(U,null,G(e.tableArray.content,(f,m)=>(g(),A("tr",{key:m},[v("td",null,H(m+1),1),v("td",null,[n(_,{value:f.key,"onUpdate:value":F=>f.key=F,disabled:l.editDisabled,type:"text",size:"small",onBlur:e.blur},null,8,["value","onUpdate:value","disabled"])]),v("td",null,[n(_,{value:f.value,"onUpdate:value":F=>f.value=F,disabled:l.editDisabled,type:"text",size:"small",onBlur:e.blur},{suffix:a(()=>[n(r,{text:"",size:"tiny",onClick:Ye(F=>e.maxEdit(f,m),["stop"])},{default:a(()=>[n(p,{size:"16",depth:3},{default:a(()=>[n(e.MaximizeIcon)]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["value","onUpdate:value","disabled"])]),v("td",null,[v("div",pt,[n(r,{class:"go-ml-2",type:"primary",size:"small",ghost:"",disabled:l.editDisabled,onClick:F=>e.add(m)},{default:a(()=>t[2]||(t[2]=[c(" + ")])),_:2},1032,["disabled","onClick"]),n(r,{class:"go-ml-2",type:"warning",size:"small",ghost:"",disabled:m===0&&l.editDisabled,onClick:F=>e.remove(m)},{default:a(()=>t[3]||(t[3]=[c(" - ")])),_:2},1032,["disabled","onClick"])])]),v("td",null,[f.error?(g(),T(r,{key:0,class:"go-ml-2",text:"",type:"error"},{default:a(()=>t[4]||(t[4]=[c(" 格式错误 ")])),_:1})):(g(),T(r,{key:1,class:"go-ml-2",text:"",type:"primary"},{default:a(()=>t[5]||(t[5]=[c(" 格式通过 ")])),_:1}))])]))),128))])]),_:1}),n(s,{show:e.showModal,"onUpdate:show":t[1]||(t[1]=f=>e.showModal=f),"mask-closable":!1,showIcon:!1,preset:"dialog",title:"编辑","positive-text":"确认","negative-text":"取消",style:{width:"800px"},onPositiveClick:e.onPositiveClick},{default:a(()=>[n(q,{style:{margin:"0 0 10px"}}),n(e.MonacoEditor,{modelValue:e.monacoEditor,"onUpdate:modelValue":t[0]||(t[0]=f=>e.monacoEditor=f),height:"300px",language:"html"},null,8,["modelValue"])]),_:1},8,["show"])],64)}const qe=Q(ct,[["render",ft],["__file","index.vue"]]),vt=V({__name:"index",props:{editDisabled:{type:Boolean,default:!0}},setup(D,{expose:t}){t();const{chartEditStore:l}=se(),{requestParams:e}=J(l.getRequestGlobalConfig),B=R(P.HEADER),k=[P.HEADER],p={chartEditStore:l,requestParams:e,tabValue:B,tabs:k,updateRequestParams:r=>{B.value===P.HEADER&&(e.value[B.value]=r)},get RequestHeaderTable(){return qe},get RequestParamsTypeEnum(){return P}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),_t={class:"go-mt-3"};function yt(D,t,l,e,B,k){const _=o("n-tab"),p=o("n-tabs");return g(),A("div",null,[n(p,{type:"line",animated:"",value:e.tabValue,"onUpdate:value":t[0]||(t[0]=r=>e.tabValue=r)},{default:a(()=>[(g(),A(U,null,G(e.tabs,r=>n(_,{key:r,name:r,tab:r},{default:a(()=>[c(H(r),1)]),_:2},1032,["name","tab"])),64))]),_:1},8,["value"]),v("div",_t,[e.tabValue===e.RequestParamsTypeEnum.HEADER?(g(),T(e.RequestHeaderTable,{key:0,editDisabled:l.editDisabled,target:e.requestParams[e.tabValue],onUpdate:e.updateRequestParams},null,8,["editDisabled","target"])):z("",!0)])])}const bt=Q(vt,[["render",yt],["__file","index.vue"]]),Et=V({__name:"index",setup(D,{expose:t}){t(),We(f=>({f2bf4ed4:E.value}));const{PencilIcon:l,ChevronDownOutlineIcon:e,ChevronUpOutlineIcon:B}=j.ionicons5,{chartEditStore:k}=se(),_=R(!0),p=Ke(),r=R(!1),E=Je(()=>p.getAppTheme),s={PencilIcon:l,ChevronDownOutlineIcon:e,ChevronUpOutlineIcon:B,chartEditStore:k,editDisabled:_,designStore:p,showTable:r,themeColor:E,editRequestConfig:()=>{_.value=!1},SettingItemBox:re,SettingItem:oe,get selectTimeOptions(){return le},get RequestGlobalHeaderTable(){return bt}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}});function Ft(D,t,l,e,B,k){const _=o("n-tag"),p=o("n-input"),r=o("n-input-number"),E=o("n-select"),q=o("n-input-group"),s=o("n-icon"),f=o("n-button"),m=o("n-text"),F=o("n-collapse-transition"),d=o("n-tooltip"),x=o("n-card");return g(),T(x,{class:"n-card-shallow"},{default:a(()=>[n(_,{type:"info",bordered:!1,style:{"border-radius":"5px"}},{default:a(()=>t[5]||(t[5]=[c(" 环境配置 ")])),_:1}),n(e.SettingItemBox,{name:"服务",itemRightStyle:{gridTemplateColumns:"5fr 2fr 1fr"}},{default:a(()=>[n(e.SettingItem,{name:"前置 URL（不使用数据库请求方式）"},{default:a(()=>[n(p,{value:e.chartEditStore.getRequestGlobalConfig.requestOriginUrl,"onUpdate:value":t[0]||(t[0]=u=>e.chartEditStore.getRequestGlobalConfig.requestOriginUrl=u),valueModifiers:{trim:!0},disabled:e.editDisabled,placeholder:"例：http://127.0.0.1/"},null,8,["value","disabled"])]),_:1}),n(e.SettingItem,{name:"更新间隔，为 0 只会初始化"},{default:a(()=>[n(q,null,{default:a(()=>[n(r,{class:"select-time-number",value:e.chartEditStore.getRequestGlobalConfig.requestInterval,"onUpdate:value":t[1]||(t[1]=u=>e.chartEditStore.getRequestGlobalConfig.requestInterval=u),valueModifiers:{trim:!0},min:"0","show-button":!1,disabled:e.editDisabled,precision:0,placeholder:"请输入数字"},null,8,["value","disabled"]),n(E,{class:"select-time-options",value:e.chartEditStore.getRequestGlobalConfig.requestIntervalUnit,"onUpdate:value":t[2]||(t[2]=u=>e.chartEditStore.getRequestGlobalConfig.requestIntervalUnit=u),options:e.selectTimeOptions,disabled:e.editDisabled},null,8,["value","options","disabled"])]),_:1})]),_:1}),ae(n(f,{type:"primary",ghost:"",onClick:e.editRequestConfig},{icon:a(()=>[n(s,null,{default:a(()=>[n(e.PencilIcon)]),_:1})]),default:a(()=>[t[6]||(t[6]=c(" 编辑配置 "))]),_:1},512),[[ue,e.editDisabled]])]),_:1}),n(F,{show:e.showTable},{default:a(()=>[n(e.RequestGlobalHeaderTable,{editDisabled:e.editDisabled},null,8,["editDisabled"]),n(m,{depth:3,style:{"font-size":"13px"}},{default:a(()=>t[7]||(t[7]=[c("「key」和「value」可用 { } 包裹来使用全局变量")])),_:1})]),_:1},8,["show"]),e.showTable?(g(),A("div",{key:0,class:"go-flex-center go-mt-3 down",onClick:t[3]||(t[3]=u=>e.showTable=!1)},[n(s,{size:"32"},{default:a(()=>[n(e.ChevronUpOutlineIcon)]),_:1})])):(g(),A("div",{key:1,class:"go-flex-center go-mt-3 down",onClick:t[4]||(t[4]=u=>e.showTable=!0)},[n(d,{trigger:"hover",placement:"top","keep-alive-on-hover":!1},{trigger:a(()=>[n(s,{size:"32"},{default:a(()=>[n(e.ChevronDownOutlineIcon)]),_:1})]),default:a(()=>[t[8]||(t[8]=c(" 展开 "))]),_:1})]))]),_:1})}const pn=Q(Et,[["render",Ft],["__scopeId","data-v-753c9d7d"],["__file","index.vue"]]),qt="{{ }}",Ct="{{key}}";var Ce=(D=>(D.PARAMS="Params",D.HEADER="Header",D.BODY="Body",D))(Ce||{});const Dt=V({__name:"index",props:{targetDataRequest:Object},setup(D,{expose:t}){t();const l=D,{HelpOutlineIcon:e}=j.ionicons5;l.targetDataRequest&&l.targetDataRequest.requestDisableInit===void 0&&(l.targetDataRequest.requestDisableInit=!1);const{requestHttpType:B,requestContentType:k,requestSQLContent:_,requestParams:p,requestParamsBodyType:r,requestProxy:E,requestDisableInit:q}=J(l.targetDataRequest),s=R(P.PARAMS),f=R([]),m=y=>{s.value!==P.BODY&&(p.value[s.value]=y)},F=y=>{s.value===P.BODY&&(r.value===$.FORM_DATA||r.value===$.X_WWW_FORM_URLENCODED)&&(p.value[P.BODY][r.value]=y)},d=y=>B.value===C.DATA_BASE&&y!==K.SQL?(window.$message.warning("数据库类型只能关联 SQL 请求"),!1):!0,x=Fe(),b={mutuallyKey:qt,mutuallyKey2:Ct,RequestParamsTypePageShowEnum:Ce,props:l,HelpOutlineIcon:e,requestHttpType:B,requestContentType:k,requestSQLContent:_,requestParams:p,requestParamsBodyType:r,requestProxy:E,requestDisableInit:q,tabValue:s,mutuallyKeyList:f,updateRequestParams:m,updateRequestBodyTable:F,handleTabsBeforeLeave:d,chartEditStore:x,editorBlurHandle:()=>{x.handleSQLBlur(_.value),f.value=[];for(const y in _.value.sqlParseSlotObj)f.value.push(y)},MonacoEditor:ie,get RequestHeaderTable(){return qe},SettingItemBox:re,get RequestParamsTypeEnum(){return P},get RequestContentTypeEnum(){return K},get RequestBodyEnumList(){return Xe},get RequestBodyEnum(){return $},get RequestHttpEnum(){return C}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),Bt={style:{width:"600px"}},ht={class:"text-box"},xt={class:"go-mt-3"},St={key:0},Tt={key:1};function kt(D,t,l,e,B,k){const _=o("n-tab"),p=o("n-tabs"),r=o("n-text"),E=o("n-checkbox"),q=o("n-icon"),s=o("n-tooltip"),f=o("n-radio"),m=o("n-space"),F=o("n-radio-group"),d=o("n-card"),x=o("n-tag");return g(),T(m,{vertical:""},{default:a(()=>[v("div",Bt,[n(p,{value:e.requestContentType,"onUpdate:value":t[0]||(t[0]=u=>e.requestContentType=u),type:"segment",size:"small",onBeforeLeave:e.handleTabsBeforeLeave},{default:a(()=>[n(_,{name:e.RequestContentTypeEnum.DEFAULT,tab:"普通请求"},null,8,["name"]),n(_,{name:e.RequestContentTypeEnum.SQL,tab:"SQL 请求"},null,8,["name"])]),_:1},8,["value"])]),ae(v("div",null,[n(p,{type:"line",animated:"",value:e.tabValue,"onUpdate:value":t[3]||(t[3]=u=>e.tabValue=u)},{suffix:a(()=>[v("div",ht,[n(E,{size:"small",checked:e.requestDisableInit,"onUpdate:checked":t[1]||(t[1]=u=>e.requestDisableInit=u)},{default:a(()=>[n(r,{style:{position:"relative",top:"-2px","font-size":"13px"}},{default:a(()=>t[8]||(t[8]=[c(" 初始化不请求 ")])),_:1})]),_:1},8,["checked"]),n(E,{size:"small",checked:e.requestProxy,"onUpdate:checked":t[2]||(t[2]=u=>e.requestProxy=u)},{default:a(()=>[n(r,{style:{position:"relative",top:"-2px","font-size":"13px"}},{default:a(()=>t[9]||(t[9]=[c(" 服务器代理请求 ")])),_:1})]),_:1},8,["checked"]),n(s,{trigger:"hover"},{trigger:a(()=>[n(q,{size:"19",depth:3,style:{position:"relative",top:"3px"}},{default:a(()=>[n(e.HelpOutlineIcon)]),_:1})]),default:a(()=>[t[10]||(t[10]=c(" 因跨域无法访问时可勾选，但接口更新间隔会变慢 "))]),_:1})])]),default:a(()=>[(g(),A(U,null,G(e.RequestParamsTypePageShowEnum,u=>n(_,{key:u,name:u,tab:u},{default:a(()=>[c(H(u),1)]),_:2},1032,["name","tab"])),64))]),_:1},8,["value"]),v("div",xt,[e.tabValue!==e.RequestParamsTypeEnum.BODY?(g(),A("div",St,[n(e.RequestHeaderTable,{target:e.requestParams[e.tabValue],onUpdate:e.updateRequestParams},null,8,["target"])])):(g(),A("div",Tt,[n(F,{value:e.requestParamsBodyType,"onUpdate:value":t[4]||(t[4]=u=>e.requestParamsBodyType=u),name:"radiogroup"},{default:a(()=>[n(m,null,{default:a(()=>[(g(!0),A(U,null,G(e.RequestBodyEnumList,u=>(g(),T(f,{key:u,value:u},{default:a(()=>[c(H(u),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["value"]),e.requestParamsBodyType===e.RequestBodyEnum.NONE?(g(),T(d,{key:0,class:"go-mt-3 go-pb-3"},{default:a(()=>[n(r,{depth:"3"},{default:a(()=>t[11]||(t[11]=[c("该接口没有 Body 体")])),_:1})]),_:1})):e.requestParamsBodyType===e.RequestBodyEnum.FORM_DATA||e.requestParamsBodyType===e.RequestBodyEnum.X_WWW_FORM_URLENCODED?(g(),T(e.RequestHeaderTable,{key:1,class:"go-mt-3",target:e.requestParams[e.RequestParamsTypeEnum.BODY][e.requestParamsBodyType],onUpdate:e.updateRequestBodyTable},null,8,["target"])):e.requestParamsBodyType===e.RequestBodyEnum.JSON?(g(),T(e.MonacoEditor,{key:2,modelValue:e.requestParams[e.RequestParamsTypeEnum.BODY][e.requestParamsBodyType],"onUpdate:modelValue":t[5]||(t[5]=u=>e.requestParams[e.RequestParamsTypeEnum.BODY][e.requestParamsBodyType]=u),width:"600px",height:"200px",language:"json"},null,8,["modelValue"])):e.requestParamsBodyType===e.RequestBodyEnum.XML?(g(),T(e.MonacoEditor,{key:3,modelValue:e.requestParams[e.RequestParamsTypeEnum.BODY][e.requestParamsBodyType],"onUpdate:modelValue":t[6]||(t[6]=u=>e.requestParams[e.RequestParamsTypeEnum.BODY][e.requestParamsBodyType]=u),width:"600px",height:"200px",language:"html"},null,8,["modelValue"])):z("",!0)]))]),n(r,{depth:3,style:{"font-size":"13px"}},{default:a(()=>t[12]||(t[12]=[c("「key」和「value」可用 { } 包裹来使用全局变量")])),_:1})],512),[[ue,e.requestContentType===e.RequestContentTypeEnum.DEFAULT]]),ae(v("div",null,[e.requestHttpType===e.RequestHttpEnum.GET?(g(),T(r,{key:0},{default:a(()=>t[13]||(t[13]=[c("SQL 类型不支持 Get 请求，请使用其它方式")])),_:1})):(g(),A(U,{key:1},[n(e.SettingItemBox,{name:"提示"},{default:a(()=>[n(x,{type:"warning"},{default:a(()=>t[14]||(t[14]=[c("如果未选择「数据库」 类型，需要后台提供专门处理 SQL 的接口，参数的 key 为「sql」")])),_:1})]),_:1}),n(e.SettingItemBox,{name:"交互关联"},{default:a(()=>[n(x,{type:"info"},{default:a(()=>[c(" 使用 “"+H(e.mutuallyKey)+"” （双大括号）包裹的单词，可解析为交互关键词进行联动，如：select * from "+H(e.mutuallyKey2))]),_:1})]),_:1}),n(e.SettingItemBox,null,{name:a(()=>t[15]||(t[15]=[c(" 关键词 ")])),default:a(()=>[n(m,null,{default:a(()=>[(g(!0),A(U,null,G(e.mutuallyKeyList,u=>(g(),T(x,{type:"success",bordered:!1,key:u},{default:a(()=>[c(H(u),1)]),_:2},1024))),128))]),_:1})]),_:1}),n(e.SettingItemBox,{name:"键值"},{default:a(()=>[n(e.MonacoEditor,{modelValue:e.requestSQLContent.sql,"onUpdate:modelValue":t[7]||(t[7]=u=>e.requestSQLContent.sql=u),width:"600px",height:"200px",language:"sql",onChange:e.editorBlurHandle},null,8,["modelValue"])]),_:1}),n(r,{depth:3,style:{"font-size":"13px"}},{default:a(()=>t[16]||(t[16]=[c("可用 { } 包裹来使用全局变量")])),_:1})],64))],512),[[ue,e.requestContentType===e.RequestContentTypeEnum.SQL]])]),_:1})}const Rt=Q(Dt,[["render",kt],["__scopeId","data-v-c44860bd"],["__file","index.vue"]]),At=["12a","1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12p","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p"],wt=["Saturday","Friday","Thursday","Wednesday","Tuesday","Monday","Sunday"],It=[[0,0,"@integer(0, 10)"],[1,0,"@integer(0, 10)"],[2,0,"-"],[3,0,"-"],[4,0,"-"],[5,0,"-"],[6,0,"-"],[7,0,"-"],[8,0,"-"],[9,0,"-"],[10,0,"-"],[11,0,"@integer(0, 10)"],[12,0,"@integer(0, 10)"],[13,0,"@integer(0, 10)"],[14,0,"@integer(0, 10)"],[15,0,"@integer(0, 10)"],[16,0,"@integer(0, 10)"],[17,0,"@integer(0, 10)"],[18,0,"@integer(0, 10)"],[19,0,"@integer(0, 10)"],[20,0,"@integer(0, 10)"],[21,0,"@integer(0, 10)"],[22,0,"@integer(0, 10)"],[23,0,"@integer(0, 10)"],[0,1,7],[1,1,"-"],[2,1,"-"],[3,1,"-"],[4,1,"-"],[5,1,"-"],[6,1,"-"],[7,1,"-"],[8,1,"-"],[9,1,"-"],[10,1,"@integer(0, 10)"],[11,1,"@integer(0, 10)"],[12,1,"@integer(0, 10)"],[13,1,"@integer(0, 10)"],[14,1,"@integer(0, 10)"],[15,1,"@integer(0, 10)"],[16,1,"@integer(0, 10)"],[17,1,"@integer(0, 10)"],[18,1,"@integer(0, 10)"],[19,1,"@integer(0, 10)"],[20,1,"@integer(0, 10)"],[21,1,"@integer(0, 10)"],[22,1,"@integer(0, 10)"],[23,1,"@integer(0, 10)"],[0,2,1],[1,2,1],[2,2,"-"],[3,2,"-"],[4,2,"-"],[5,2,"-"],[6,2,"-"],[7,2,"-"],[8,2,"-"],[9,2,"-"],[10,2,"@integer(0, 10)"],[11,2,"@integer(0, 10)"],[12,2,"@integer(0, 10)"],[13,2,"@integer(0, 10)"],[14,2,"@integer(0, 10)"],[15,2,"@integer(0, 10)"],[16,2,"@integer(0, 10)"],[17,2,"@integer(0, 10)"],[18,2,"@integer(0, 10)"],[19,2,"@integer(0, 10)"],[20,2,"@integer(0, 10)"],[21,2,"@integer(0, 10)"],[22,2,"@integer(0, 10)"],[23,2,"@integer(0, 10)"],[0,3,7],[1,3,3],[2,3,"-"],[3,3,"-"],[4,3,"-"],[5,3,"-"],[6,3,"-"],[7,3,"-"],[8,3,1],[9,3,"-"],[10,3,"@integer(0, 10)"],[11,3,"@integer(0, 10)"],[12,3,"@integer(0, 10)"],[13,3,"@integer(0, 10)"],[14,3,"@integer(0, 10)"],[15,3,"@integer(0, 10)"],[16,3,"@integer(0, 10)"],[17,3,"@integer(0, 10)"],[18,3,"@integer(0, 10)"],[19,3,"@integer(0, 10)"],[20,3,"@integer(0, 10)"],[21,3,"@integer(0, 10)"],[22,3,"@integer(0, 10)"],[23,3,"@integer(0, 10)"],[0,4,"@integer(0, 10)"],[1,4,"@integer(0, 10)"],[2,4,"-"],[3,4,"-"],[4,4,"-"],[5,4,"@integer(0, 10)"],[6,4,"-"],[7,4,"-"],[8,4,"-"],[9,4,"@integer(0, 10)"],[10,4,"@integer(0, 10)"],[11,4,"@integer(0, 10)"],[12,4,"@integer(0, 10)"],[13,4,"@integer(0, 10)"],[14,4,"@integer(0, 10)"],[15,4,"@integer(0, 10)"],[16,4,"@integer(0, 10)"],[17,4,"@integer(0, 10)"],[18,4,"@integer(0, 10)"],[19,4,"@integer(0, 10)"],[20,4,"@integer(0, 10)"],[21,4,"@integer(0, 10)"],[22,4,"@integer(0, 10)"],[23,4,"-"],[0,5,"@integer(0, 10)"],[1,5,"@integer(0, 10)"],[2,5,"-"],[3,5,"@integer(0, 10)"],[4,5,"-"],[5,5,"-"],[6,5,"-"],[7,5,"-"],[8,5,"@integer(0, 10)"],[9,5,"-"],[10,5,"@integer(0, 10)"],[11,5,"@integer(0, 10)"],[12,5,"@integer(0, 10)"],[13,5,"@integer(0, 10)"],[14,5,"@integer(0, 10)"],[15,5,"@integer(0, 10)"],[16,5,"@integer(0, 10)"],[17,5,"@integer(0, 10)"],[18,5,"-"],[19,5,"@integer(0, 10)"],[20,5,"@integer(0, 10)"],[21,5,"@integer(0, 10)"],[22,5,"@integer(0, 10)"],[23,5,"-"],[0,6,"@integer(0, 10)"],[1,6,"-"],[2,6,"-"],[3,6,"-"],[4,6,"-"],[5,6,"-"],[6,6,"-"],[7,6,"-"],[8,6,"-"],[9,6,"-"],[10,6,"@integer(0, 10)"],[11,6,"-"],[12,6,"@integer(0, 10)"],[13,6,"@integer(0, 10)"],[14,6,"@integer(0, 10)"],[15,6,"@integer(0, 10)"],[16,6,"-"],[17,6,"-"],[18,6,"-"],[19,6,"-"],[20,6,"@integer(0, 10)"],[21,6,"@integer(0, 10)"],[22,6,"@integer(0, 10)"],[23,6,"@integer(0, 10)"]],Lt={xAxis:At,yAxis:wt,seriesData:It},Ut=[{dimensions:["data1"],source:[[10,"@integer(0, 100)"],[8.07,"@integer(0, 100)"],[13,"@integer(0, 100)"],[9.05,"@integer(0, 100)"],[11,"@integer(0, 100)"],[14,"@integer(0, 100)"],[13.4,"@integer(0, 100)"],[10,"@integer(0, 100)"],[14,"@integer(0, 100)"],[12.5,"@integer(0, 100)"],[9.15,"@integer(0, 100)"],[11.5,"@integer(0, 100)"],[3.03,"@integer(0, 100)"],[12.2,"@integer(0, 100)"],[2.02,"@integer(0, 100)"],[1.05,"@integer(0, 100)"],[4.05,"@integer(0, 100)"],[6.03,"@integer(0, 100)"],[12,"@integer(0, 100)"],[12,"@integer(0, 100)"],[7.08,"@integer(0, 100)"],[5.02,"@integer(0, 100)"]]},{dimensions:["data2"],source:[[10,"@integer(0, 70)"],[8.07,"@integer(0, 70)"],[13,"@integer(0, 70)"],[9.05,"@integer(0, 70)"],[11,"@integer(0, 70)"],[14,"@integer(0, 70)"],[13.4,"@integer(0, 70)"],[10,"@integer(0, 70)"],[14,"@integer(0, 70)"],[12.5,"@integer(0, 70)"],[9.15,"@integer(0, 70)"],[11.5,"@integer(0, 70)"],[3.03,"@integer(0, 70)"],[12.2,"@integer(0, 70)"],[2.02,"@integer(0, 70)"],[1.05,"@integer(0, 70)"],[4.05,"@integer(0, 70)"],[6.03,"@integer(0, 70)"],[12,"@integer(0, 70)"],[12,"@integer(0, 70)"],[7.08,"@integer(0, 70)"],[5.02,"@integer(0, 70)"]]}],Ot={"markers|50":[{name:"某某地市",value:"@integer(2, 20)",position:["@float(115, 117, 1, 6)","@float(38, 40, 1, 6)"]}]},Ht=[{name:"@name",value:"@integer(0, 1000)",children:[{name:"@name",value:"@integer(0, 500)"},{name:"@name",value:"@integer(0, 500)"}]},{name:"@name",value:"@integer(0, 1000)",children:[{name:"@name",value:"@integer(0, 00)"},{name:"@name",value:"@integer(0, 500)"}]},{name:"@name",value:"@integer(0, 1000)",children:[{name:"@name",value:"@integer(0, 1000)"}]},{name:"@name",value:"@integer(0, 1000)",children:[{name:"@name",value:"@integer(0, 1000)"}]}],Pt=[{name:"a"},{name:"b"},{name:"a1"},{name:"a2"},{name:"b1"},{name:"b2"}],Mt=[{source:"a",target:"a1",value:"@integer(0, 10)"},{source:"a",target:"a2",value:"@integer(0, 10)"},{source:"b",target:"b1",value:"@integer(0, 10)"},{source:"a",target:"b1",value:"@integer(0, 10)"},{source:"b1",target:"a1",value:"@integer(0, 10)"},{source:"b1",target:"b2",value:"@integer(0, 10)"}],Gt=[{depth:0,itemStyle:{color:"#decbe4"},lineStyle:{color:"source",opacity:.9}},{depth:1,itemStyle:{color:"#b3cde3"},lineStyle:{color:"source",opacity:.6}},{depth:2,itemStyle:{color:"#ccebc5"},lineStyle:{color:"source",opacity:.6}}],zt={label:Pt,links:Mt,levels:Gt},Vt=[{id:"0",name:"Myriel",symbolSize:"@integer(0, 50)",x:-266.82776,y:299.6904,value:"@integer(0, 50)",category:3},{id:"1",name:"Napoleon",symbolSize:"@integer(0, 50)",x:-418.08344,y:446.8853,value:"@integer(0, 50)",category:5},{id:"2",name:"MlleBaptistine",symbolSize:"@integer(0, 50)",x:-212.76357,y:245.29176,value:"@integer(0, 50)",category:1},{id:"3",name:"MmeMagloire",symbolSize:"@integer(0, 50)",x:-242.82404,y:235.26283,value:"@integer(0, 50)",category:1},{id:"4",name:"CountessDeLo",symbolSize:"@integer(0, 50)",x:-379.30386,y:429.06424,value:"@integer(0, 50)",category:0}],Qt=[{source:"1",target:"@integer(2, 4)"},{source:"2",target:"@integer(3, 4)"},{source:"3",target:"@integer(0, 2)"},{source:"3",target:"@integer(0, 1)"},{source:"4",target:"@integer(0, 3)"}],Nt=[{name:"A"},{name:"B"},{name:"C"},{name:"D"},{name:"E"},{name:"F"},{name:"G"},{name:"H"},{name:"I"}],jt={nodes:Vt,links:Qt,categories:Nt},S={fetchRemoteChartData:{code:0,status:200,msg:"请求成功",data:{legend:["数据"],barName:"数据","xAxis|7":["@name"],"dataList|7":["@integer(60, 100)"]}},fetchMockSingleData:{code:0,status:200,msg:"请求成功",data:{dimensions:["product","dataOne"],"source|20":[{product:"@name","dataOne|0-900":3}]}},fetchCapsule:{code:0,status:200,msg:"请求成功",data:{dimensions:["name","value"],"source|2-5":[{"name|+1":["厦门","福州","北京","上海","新疆","郑州","湖南","内蒙古"],"value|0-40":20}]}},fetchMockData:{code:0,status:200,msg:"请求成功",data:{dimensions:["product","dataOne","dataTwo","dataThree"],"source|20":[{product:"@name","dataOne|100-900":3,"dataTwo|100-900":3,"dataThree|100-900":3}]}},fetchRankList:{code:0,status:200,msg:"请求成功","data|50":[{name:"@name","value|100-900":5}]},fetchScrollBoard:{code:0,status:200,msg:"请求成功",data:[["行1列1","行1列2","1"],["行2列1","行2列2","2"],["行3列1","行3列2","3"],["行4列1","行4列2","4"],["行5列1","行5列2","5"],["行6列1","行6列2","6"],["行7列1","行7列2","行7列3"],["行8列1","行8列2","行8列3"],["行9列1","行9列2","行9列3"],["行10列1","行10列2","行10列3"]]},fetchNumberFloat:{code:0,status:200,msg:"请求成功",data:"@float(0, 0.99, 1, 4)"},fetchNumberInt:{code:0,status:200,msg:"请求成功",data:"@integer(0, 100)"},fetchText:{code:0,status:200,msg:"请求成功",data:"@paragraph(1, 10)"},fetchImage:D=>({code:0,status:200,msg:"请求成功",data:`https://robohash.org/${D}`}),fetchRadar:{code:0,status:200,msg:"请求成功",data:{radarIndicator:[{name:"@name",max:1e4},{name:"@name",max:1e4},{name:"@name",max:1e4},{name:"@name",max:1e4},{name:"@name",max:1e4},{name:"@name",max:1e4}],seriesData:[{value:["@integer(0, 10000)","@integer(0, 10000)","@integer(0, 10000)","@integer(0, 10000)","@integer(0, 10000)","@integer(0, 10000)"],name:"data1"},{value:["@integer(0, 10000)","@integer(0, 10000)","@integer(0, 10000)","@integer(0, 10000)","@integer(0, 10000)","@integer(0, 10000)"],name:"data2"}]}},fetchHeatmap:{code:0,status:200,msg:"请求成功",data:Lt},fetchScatterBasic:{code:0,status:200,msg:"请求成功",data:Ut},fetchMap:{code:0,status:200,msg:"请求成功",data:Ot},fetchWordCloud:{code:0,status:200,msg:"请求成功",data:[{name:"@name",value:8e3,textStyle:{color:"#78fbb2"},emphasis:{textStyle:{color:"red"}}},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"},{name:"@name",value:"@integer(10, 8000)"}]},fetchTreemap:{code:0,status:200,msg:"请求成功",data:Ht},threeEarth01Data:{code:0,status:200,msg:"请求成功",data:[{startArray:{name:"@name",N:"@integer(10, 100)",E:"@integer(10, 100)"},"endArray|10":[{name:"@name",N:"@integer(10, 100)",E:"@integer(10, 100)"}]}]},fetchSankey:{code:0,status:200,msg:"请求成功",data:zt},graphData:{code:0,status:200,msg:"请求成功",data:jt}},De="/mock/remote/chartData",Be="/mock/chartData",he="/mock/chartSingleData",xe="/mock/number/float",Se="/mock/number/int",Te="/mock/text",ke="/mock/image",Re="/mock/rankList",Ae="/mock/scrollBoard",we="/mock/radarData",Ie="/mock/heatMapData",Le="/mock/scatterBasic",Ue="/mock/map",Oe="/mock/capsule",He="/mock/wordCloud",Pe="/mock/treemap",Me="/mock/threeEarth01Data",Ge="/mock/sankey",ze="/mock/graphData";C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET,C.GET;const Yt=V({__name:"index",props:{targetDataRequest:Object},setup(D,{expose:t}){t();const l=D,{HelpOutlineIcon:e}=j.ionicons5,{chartEditStore:B}=se(),{requestOriginUrl:k}=J(B.getRequestGlobalConfig),{requestInterval:_,requestIntervalUnit:p,requestHttpType:r,requestUrl:E,requestContentType:q,requestSQLContent:s}=J(l.targetDataRequest),f=R([]),m=R(!1),F=[{value:`【基础 Bar 结构】${De}`},{value:`【图表】${Be}`},{value:`【单数据图表】${he}`},{value:`【文本】${Te}`},{value:`【0~100 整数】${Se}`},{value:`【0~1小数】${xe}`},{value:`【图片地址】${ke}`},{value:`【排名列表】${Re}`},{value:`【滚动表格】${Ae}`},{value:`【雷达】${we}`},{value:`【热力图】${Ie}`},{value:`【基础散点图】${Le}`},{value:`【地图数据】${Ue}`},{value:`【胶囊柱图】${Oe}`},{value:`【词云】${He}`},{value:`【树图】${Pe}`},{value:`【三维地球】${Me}`},{value:`【桑基图】${Ge}`},{value:`【关系图】${ze}`}],d=async b=>{var y;try{m.value=!0;const I=await be({pageSize:999999,page:1,teamId:(y=Ee())==null?void 0:y.teamId,needAll:!0});I.code===W.SUCCESS&&(f.value=I.data.data.map(N=>({label:N.dbName||N.database,value:N.id})),b&&window.$message.success(b),m.value=!1)}catch(I){m.value=!1,window.$message.error("获取数据失败, 请稍后重试!")}},x=b=>{b===C.DATA_BASE&&(q.value=K.SQL)};Ze(()=>{d()});const u={props:l,HelpOutlineIcon:e,chartEditStore:B,requestOriginUrl:k,requestInterval:_,requestIntervalUnit:p,requestHttpType:r,requestUrl:E,requestContentType:q,requestSQLContent:s,dataBaseListOptions:f,dataBaseListLoading:m,apiList:F,fetchDataBaseList:d,httpTypeChangeHandle:x,SettingItemBox:re,SettingItem:oe,get selectTypeOptions(){return at},get selectTimeOptions(){return le},get RequestHttpEnum(){return C},get RequestHeader(){return Rt},get isDev(){return $e}};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}}),Wt={class:"go-pl-0"};function Jt(D,t,l,e,B,k){const _=o("n-divider"),p=o("n-icon"),r=o("n-text"),E=o("n-tooltip"),q=o("n-select"),s=o("n-input"),f=o("n-button"),m=o("n-input-group"),F=o("n-input-number");return g(),A(U,null,[n(_,{class:"go-my-3","title-placement":"left"}),n(e.SettingItemBox,{itemRightStyle:{gridTemplateColumns:"6fr 2fr"},style:{"padding-right":"25px"}},{name:a(()=>[t[7]||(t[7]=c(" 地址 ")),e.isDev()?(g(),T(E,{key:0,trigger:"hover"},{trigger:a(()=>[n(p,{size:"21",depth:3},{default:a(()=>[n(e.HelpOutlineIcon)]),_:1})]),default:a(()=>[v("ul",Wt,[t[6]||(t[6]=c(" 开发环境使用 mock 数据，请输入 ")),(g(),A(U,null,G(e.apiList,d=>v("li",{key:d.value},[n(r,{type:"info"},{default:a(()=>[c(H(d.value),1)]),_:2},1024)])),64))])]),_:1})):z("",!0)]),default:a(()=>[n(e.SettingItem,{name:"请求方式 & URL 地址"},{default:a(()=>[n(m,null,{default:a(()=>[n(q,{class:"select-type-options",value:e.requestHttpType,"onUpdate:value":[t[0]||(t[0]=d=>e.requestHttpType=d),e.httpTypeChangeHandle],options:e.selectTypeOptions},null,8,["value","options"]),e.requestHttpType!==e.RequestHttpEnum.DATA_BASE?(g(),T(s,{key:0,value:e.requestUrl,"onUpdate:value":t[1]||(t[1]=d=>e.requestUrl=d),valueModifiers:{trim:!0},min:1,placeholder:"请输入地址，可用 { } 包裹来使用全局变量"},{prefix:a(()=>[n(r,null,{default:a(()=>[c(H(e.requestOriginUrl),1)]),_:1}),n(_,{vertical:""})]),_:1},8,["value"])):(g(),A(U,{key:1},[n(q,{clearable:"",value:e.requestSQLContent.dataSourceId,"onUpdate:value":t[2]||(t[2]=d=>e.requestSQLContent.dataSourceId=d),options:e.dataBaseListOptions},null,8,["value","options"]),n(f,{secondary:"",loading:e.dataBaseListLoading,onClick:t[3]||(t[3]=d=>e.fetchDataBaseList("更新成功"))},{default:a(()=>t[8]||(t[8]=[c(" 更新下拉数据 ")])),_:1},8,["loading"])],64))]),_:1})]),_:1}),n(e.SettingItem,{name:"更新间隔，为 0 只会初始化"},{default:a(()=>[e.props.targetDataRequest?(g(),T(m,{key:0},{default:a(()=>[n(F,{value:e.props.targetDataRequest.requestInterval,"onUpdate:value":t[4]||(t[4]=d=>e.props.targetDataRequest.requestInterval=d),valueModifiers:{trim:!0},class:"select-time-number",min:"0","show-button":!1,precision:0,placeholder:"默认使用环境配置"},null,8,["value"]),n(q,{class:"select-time-options",value:e.requestIntervalUnit,"onUpdate:value":t[5]||(t[5]=d=>e.requestIntervalUnit=d),options:e.selectTimeOptions},null,8,["value","options"])]),_:1})):z("",!0)]),_:1})]),_:1}),n(e.SettingItemBox,{name:"请求方式",class:"go-mt-0"},{default:a(()=>[n(e.RequestHeader,{targetDataRequest:l.targetDataRequest},null,8,["targetDataRequest"])]),_:1})],64)}const fn=Q(Yt,[["render",Jt],["__scopeId","data-v-082a5a1c"],["__file","index.vue"]]),Kt=V({__name:"index",props:fe({targetData:{},request:{}},{modalShow:{},modalShowModifiers:{}}),emits:fe(["cancel"],["update:modalShow"]),setup(D,{expose:t,emit:l}){t();const e=D,B=l,{AddIcon:k,CloseIcon:_,CheckmarkIcon:p,HelpOutlineIcon:r}=j.ionicons5,E=gt(),q=et(D,"modalShow"),s=R(),f=R([]),m=R(!1),F=R(""),d=ye([]),x=R([]),u=R([]);let b=null;const y=i=>"```"+i+"```",I=i=>i.replace(/```/g,"").replace(/```/g,"");ne(()=>q.value,async i=>{if(i){e.request.requestHttpType=C.DATA_BASE,e.request.requestContentType=K.SQL,de();const h=await E.getGenerateSQL();h!=null&&h.length&&(d.length=0,h.forEach(w=>{d.push(_e(y(w.sqlString),w.AIContent))})),Promise.all([X()]).then(()=>{d.push(mt("历史消息"))})}}),ne(()=>{var i;return(i=e.request.requestSQLContent)==null?void 0:i.dataSourceId},async i=>{var h;if(u.value=[],x.value=[],i){const w=await nt({id:i});x.value=(h=w.data)==null?void 0:h.map(O=>({id:O.id,name:O.dbName,desc:O.describe}))}},{immediate:!0});const N=i=>{const h=ee("img",{class:"go-mr-1",src:ot,style:{height:"14px"}});return[ee(h,{style:{verticalAlign:"-0.15em",marginRight:"4px"}}),i.name,ee("n-text",{depth:"3",style:{marginLeft:"8px",color:"#8c939d"}},{default:()=>i.desc})]},de=async i=>{var h;try{m.value=!0;const w=await be({pageSize:999999,page:1,teamId:(h=Ee())==null?void 0:h.teamId,needAll:!0});w.code===W.SUCCESS&&(f.value=w.data.data.map(O=>({label:O.dbName||O.database,value:O.id})),i&&window.$message.success(i),m.value=!1)}catch(w){m.value=!1,window.$message.error("获取数据失败, 请稍后重试!")}},Ve=i=>{e.request.requestSQLContent.sql=I(i),window.$message.success("应用成功")},Qe=async i=>{var pe;const h=rt(i,i),w=x.value.filter(L=>u.value.includes(L.id)),O=st("关联表",tt.cloneDeep(w));if(d.push(h),d.push(O),!((pe=e.request.requestSQLContent)!=null&&pe.dataSourceId)){window.$message.warning("请先在右侧选择目标数据库"),te(()=>{var L,M;(L=s.value)==null||L.unLoading(),(M=s.value)==null||M.setValue("")});return}if(!x.value.length){window.$message.warning("当前数据库未进行数据描述处理，请前往首页数据库进行表和字段配置"),te(()=>{var L,M;(L=s.value)==null||L.unLoading(),(M=s.value)==null||M.setValue("")});return}if((await lt({ids:u.value,demand:i})).code===W.SUCCESS)setTimeout(async()=>{d.push(it("正在解析中，预计还需10～30秒，请稍等...")),await me()},500);else{window.$message.error("解析失败, 请稍后重试!"),te(()=>{var L,M;(L=s.value)==null||L.unLoading(),(M=s.value)==null||M.setValue("")});return}},me=async()=>{setTimeout(()=>{var i;(i=s.value)==null||i.unLoading()},5e3),b=setInterval(async()=>{await X(i=>{var h;i!=null&&i.length&&((h=s.value)==null||h.unLoading(),clearInterval(b))})},3e3)},X=async i=>{const h=await dt({});h.code===W.SUCCESS&&h.data&&(await E.pushGenerateSQL(h.data),h.data.forEach(w=>{d.push(_e(y(w.AIContent),w.sqlString))}),i&&i(h.data))},Y=Fe(),ge=()=>{Y.handleSQLBlur(e.request.requestSQLContent)},Ne=()=>{ve({message:"确定保存当前的配置？将同步修改所有使用此接口的组件",onPositiveCallback:async()=>{ge(),Z()}})},je=()=>{ve({message:"确定不保存当前的请求配置？",onPositiveCallback:async()=>{try{window.oldTargetData&&(e.targetData.request=window.oldTargetData.request,window.oldTargetData=null),window.oldRequestGlobalConfig&&Y.getRequestGlobalConfig&&(Y.getRequestGlobalConfig.requestDataPond=window.oldRequestGlobalConfig.requestDataPond),Z(),B("cancel")}catch(i){window.$message.error("取消失败, 请稍后重试!")}}})},Z=()=>{F.value="",q.value=!1,clearInterval(b)},ce={props:e,emits:B,AddIcon:k,CloseIcon:_,CheckmarkIcon:p,HelpOutlineIcon:r,indexDBStore:E,modalShow:q,AIChatRef:s,dataBaseListOptions:f,dataBaseListLoading:m,aiDesc:F,messageList:d,allTableList:x,linkTableList:u,get intervalTime(){return b},set intervalTime(i){b=i},sqlContentHandle:y,sqlContentApplyHandle:I,renderLabel:N,fetchDataBaseList:de,sqlHandle:Ve,sendHandle:Qe,getAIHandle:me,getAIDataToIndexDB:X,chartEditStore:Y,editorBlurHandle:ge,saveHandle:Ne,cancelHandle:je,closeHandle:Z,DataBaseAIChat:ut,get selectTimeOptions(){return le},SettingItem:oe,MonacoEditor:ie};return Object.defineProperty(ce,"__isScriptSetup",{enumerable:!1,value:!0}),ce}}),Xt={class:"content-layout"},Zt={class:"content-box"},$t={class:"link-table-box"},en={class:"bottom"};function tn(D,t,l,e,B,k){const _=o("n-divider"),p=o("n-select"),r=o("n-card"),E=o("n-text"),q=o("n-icon"),s=o("n-flex"),f=o("n-popover"),m=o("n-button"),F=o("n-input-group"),d=o("n-input-number"),x=o("n-modal");return g(),T(x,{class:"go-create-data-base go-background-filter",title:"AI 一键解析",preset:"card",size:"small",show:e.modalShow,"onUpdate:show":t[6]||(t[6]=u=>e.modalShow=u),"transform-origin":"center",bordered:!0,"close-on-esc":!1,"mask-closable":!1,onAfterLeave:e.closeHandle,style:{width:"1280px"}},{default:a(()=>[n(_,{style:{"margin-top":"4px","margin-bottom":"0"}}),v("div",Xt,[v("div",Zt,[n(e.DataBaseAIChat,{ref:"AIChatRef",width:0,height:500,contentHeight:0,messageList:e.messageList,hiddenBtn:!1,inputTitle:"请输入需求，需描述清楚 AI 的统计目标，包括统计指标（如总和、均值、计数）、分组字段、筛选条件（如时间范围）及排序要求等",onSend:e.sendHandle,onUseResponse:e.sqlHandle},{inputTop:a(()=>[v("div",$t,[n(r,{size:"small","content-style":{padding:"0px 8px 8px",maxHeight:"90px",overflowY:"auto"},"footer-style":{padding:"0px 8px 8px"}},{footer:a(()=>[n(p,{value:e.linkTableList,"onUpdate:value":t[0]||(t[0]=u=>e.linkTableList=u),multiple:"",filterable:"",placeholder:"选择关联的数据表",options:e.allTableList,"label-field":"name","value-field":"id","render-label":e.renderLabel,"max-tag-count":10,style:{"margin-top":"8px"},placement:"top"},{empty:a(()=>t[7]||(t[7]=[c(" 请先选择右侧目标数据库 ")])),_:1},8,["value","options"])]),_:1})])]),inputBottomLeft:a(()=>[n(f,{trigger:"hover"},{trigger:a(()=>[n(s,{align:"center",size:4},{default:a(()=>[n(E,{depth:"3"},{default:a(()=>t[8]||(t[8]=[c(" 案例 ")])),_:1}),n(q,{size:18},{default:a(()=>[n(e.HelpOutlineIcon)]),_:1})]),_:1})]),header:a(()=>t[9]||(t[9]=[c("需求案例1: 统计2024年Q4各产品类别的总销售额和平均订单金额，并按销售额降序排列")])),footer:a(()=>t[10]||(t[10]=[c("需求案例2: 统计2024年1月至2025年1月期间每月的总交易量和交易金额")])),_:1})]),_:1},8,["messageList"]),n(r,{class:"content-right",size:"small"},{default:a(()=>[n(s,{size:12,vertical:""},{default:a(()=>[l.request?(g(),T(s,{key:0},{default:a(()=>[t[12]||(t[12]=v("div",{class:"go-mt-1 un-wrap"},"选择目标数据库：",-1)),n(F,null,{default:a(()=>[n(p,{clearable:"",value:l.request.requestSQLContent.dataSourceId,"onUpdate:value":t[1]||(t[1]=u=>l.request.requestSQLContent.dataSourceId=u),options:e.dataBaseListOptions},null,8,["value","options"]),n(m,{secondary:"",loading:e.dataBaseListLoading,onClick:t[2]||(t[2]=u=>e.fetchDataBaseList("更新成功"))},{default:a(()=>t[11]||(t[11]=[c(" 更新数据 ")])),_:1},8,["loading"])]),_:1}),t[13]||(t[13]=v("div",{class:"go-mt-1 un-wrap"},"设置时间：",-1)),n(F,null,{default:a(()=>[n(e.SettingItem,{name:"更新间隔，为 0 只会初始化"},{default:a(()=>[l.request?(g(),T(F,{key:0},{default:a(()=>[n(d,{value:l.request.requestInterval,"onUpdate:value":t[3]||(t[3]=u=>l.request.requestInterval=u),valueModifiers:{trim:!0},class:"select-time-number",min:"0","show-button":!1,precision:0,placeholder:"默认使用环境配置"},null,8,["value"]),n(p,{class:"select-time-options",value:l.request.requestIntervalUnit,"onUpdate:value":t[4]||(t[4]=u=>l.request.requestIntervalUnit=u),options:e.selectTimeOptions},null,8,["value","options"])]),_:1})):z("",!0)]),_:1})]),_:1})]),_:1})):z("",!0),n(s,{vertical:""},{default:a(()=>[t[14]||(t[14]=v("div",{class:"un-wrap"},"SQL 内容：",-1)),n(e.MonacoEditor,{modelValue:l.request.requestSQLContent.sql,"onUpdate:modelValue":t[5]||(t[5]=u=>l.request.requestSQLContent.sql=u),width:"100%",height:"280px",language:"sql"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),n(_,{style:{margin:"0"}}),v("div",en,[n(m,{class:"move-btn",focusable:!1,onClick:e.cancelHandle},{default:a(()=>t[15]||(t[15]=[v("span",null,"取消",-1)])),_:1}),n(m,{class:"move-btn",type:"primary",focusable:!1,onClick:e.saveHandle},{default:a(()=>t[16]||(t[16]=[v("span",null,"保存修改",-1)])),_:1})])])]),_:1},8,["show"])}const vn=Q(Kt,[["render",tn],["__scopeId","data-v-5c2cbc0f"],["__file","index.vue"]]);export{vn as C,fn as R,pn as a};
