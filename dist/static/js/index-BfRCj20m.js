import{d as te,a5 as oe,e as j,r as H,ac as se,G as ne,A as O,H as ie,f6 as le,aa as ae,R as N,aO as Y,ak as K,aP as q,f7 as re,bv as de,c1 as ce,f8 as ue,aw as me,_ as _e,U as d,c as m,o as l,q as a,t as w,V as p,s as i,w as o,F as G,n as X,Y as k,X as f,Z as pe}from"./index-DzJUk-4s.js";import{u as fe,d as ge}from"./systemStore-CDAOEx2u.js";import{g as ve,D as he}from"./plugin-BZaVEG5Y.js";import{u as ye}from"./projectStore-BUNtFK-_.js";import{i as Z}from"./icon-Bt2TghsQ.js";import{u as xe}from"./index-CNsebZrf.js";import{_ as we}from"./points-Bi1H5gtF.js";import"./index-YIaHLc6Z.js";import"./index-DumZb7Zp.js";import"./index-jtCf6VIy.js";import"./file-BoGdIhh5.js";import"./index-B2h3DCGB.js";import"./fileTypeEnum-22QBGXO_.js";import"./config-4CXe4sys.js";import"./config-Df8FU9mm.js";import"./svip-tip-BogTL7q_.js";import"./import-C6j5z5Sk.js";import"./team.api-Dw2fcOfS.js";import"./index-CYCNU51b.js";import"./doc-Br7GyA9J.js";import"./project-list-bg-C8sD85Ky.js";import"./masterplates.api-CmXDBnKg.js";/* empty css                                                              *//* empty css                                                                          */import"./GoUserAvatar-BBITl89l.js";import"./chart_default-Cv54ZmSo.js";import"./noCard-C4rQreFQ.js";const Ee="/static/png/create-3d.png",be=te({__name:"index",setup(J,{expose:n}){n(),oe(s=>({cd381172:C.value}));const z=H(window.__PRIVATE_MODULE__.MemberPoint),{AddIcon:e,TrashOutlineIcon:D}=Z.ionicons5,{EditIcon:L}=Z.carbon,g=se(),E=fe(),b=ye(),C=j(()=>g.getAppTheme),h=j(()=>E.getTeamInfo),B=[{label:"创建模型",desc:"3D模型编辑器",img:Ee,key:"createFile"}],{bottom:A,list:_,inBottom:y,page:u,pageSize:S}=xe(),I=H(!0),t=async()=>{const s=h.value.id,c=await le({title:ae(),team_id:s});try{if(c.code===N.SUCCESS){window.$message.success("创建成功"),u.value=1,_.value=[],T();const x=Y(K.THREE_EDIT_NAME,"href");q(x,[c.data.id],void 0,!0)}}catch(x){window.$message.error("创建失败, 请稍后重试!")}},F=s=>{const c=Y(K.THREE_EDIT_NAME,"href");q(c,[s],void 0,!0)},v=async(s,c)=>{ve({type:he.DELETE,center:!0,promise:!0,onPositiveCallback:async()=>{(await re({id:s})).code===N.SUCCESS&&(window.$message.success("删除成功"),_.value.splice(c,1))}})},T=async(s=!1)=>{I.value=!0;const c=b.getHomeSort,{sortKey:x,sortValue:W}=c,$=h.value.id;s&&(u.value=1);const M=await de({sortKey:x,sortValue:W,page:u.value,pageSize:S.value,teamId:$});I.value=!1,M.code===N.SUCCESS&&(s&&(_.value=[]),M.data.data.length===0||M.data.data.length<S.value?y.value=!0:y.value=!1,_.value.push(...M.data.data),setTimeout(()=>{_.value.forEach(ee=>{ee.state=0})},0))},Q=async s=>{s.state=1,await ce(s,{controls:!0}),s.state=2};ne(()=>{O(()=>A.value,s=>{if(s){if(u.value+=1,y.value)return;T()}})}),O(()=>b.getHomeSort,s=>{u.value=1,_.value=[],T(!0)},{immediate:!0});const U=H({}),P=H(null),r=ie({idEdit:!1,isEnter:!1,newTitle:"",oldTitle:""}),R=async(s=!1)=>{const c=r.idEdit;if(r.isEnter=s,r.idEdit=!1,!r.newTitle.trim()){window.$message.warning("名称不能为空");return}if(r.newTitle!==r.oldTitle&&c)try{(await ue({id:c,data:{title:r.newTitle}})).code==N.SUCCESS&&(window.$message.success("修改成功"),T(!0))}catch(x){window.$message.error("操作失败, 请稍后重试")}},V={isPrivateMemberPoint:z,AddIcon:e,TrashOutlineIcon:D,EditIcon:L,designStore:g,systemStore:E,projectStore:b,themeColor:C,teamInfo:h,listItem:B,bottom:A,list:_,inBottom:y,page:u,pageSize:S,fetchDataLoading:I,createModel:t,editHandle:F,deleteHandle:v,getListData:T,loadItemModel:Q,currentCard:U,inputInstRef:P,editNameInfo:r,saveNewName:R,blurHandle:()=>{if(r.isEnter){r.idEdit=!1;return}R()},renameHandle:s=>{r.newTitle=s.title||"",r.oldTitle=s.title||"",r.idEdit=s.id,U.value=s,me(()=>{P.value&&P.value[0].focus()})},get dayjs(){return ge}};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),ke={class:"three-model-box"},Ce={class:"create-box"},Se={class:"go-flex-center"},Ie=["src"],Te={class:"right-desc"},Be={class:"label"},Ae={key:0,class:"go-items-list-card"},Fe={class:"list-content"},Me=["id"],He={key:0,class:"list-content-btn"},Ne={class:"list-footer-box"},Pe={style:{"line-height":"28px"}},ze={key:1,class:"badge-box"},De={class:"list-footer"},Le={class:"item-left"},Ue={class:"go-flex-items-center list-footer-ri"},Re={key:0,class:"points-tip"},Ve={class:"go-pl-1"},je={key:1,class:"loading-box"},Oe={key:2,class:"go-flex-center go-mt-3"},Ye={key:3,class:"go-flex-center",style:{"flex-direction":"column",margin:"100px auto","user-select":"none"}};function Ke(J,n,z,e,D,L){const g=d("n-text"),E=d("n-icon"),b=d("n-grid-item"),C=d("n-grid"),h=d("n-button"),B=d("n-spin"),A=d("n-input"),_=d("n-badge"),y=d("n-tag"),u=d("n-tooltip"),S=d("n-space"),I=d("n-card");return l(),m("div",ke,[a("div",Ce,[i(C,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:2 l:3 xl:4 xxl:4",responsive:"screen"},{default:o(()=>[(l(),m(G,null,X(e.listItem,t=>i(b,{key:t.key},{default:o(()=>[a("div",{class:"item go-flex-center go-transition-quick",onClick:n[0]||(n[0]=F=>e.createModel())},[a("div",Se,[a("img",{class:"go-transition",src:t.img,alt:"创建"},null,8,Ie),a("div",Te,[a("div",Be,k(t.label),1),i(g,{class:"desc",depth:3},{default:o(()=>[f(k(t.desc),1)]),_:2},1024)])]),i(E,{size:"16",component:e.AddIcon},null,8,["component"])])]),_:2},1024)),64))]),_:1})]),e.list.length?(l(),w(C,{key:0,"x-gap":20,"y-gap":20,cols:"2 s:2 m:2 l:2 xl:3 xxl:3",responsive:"screen"},{default:o(()=>[(l(!0),m(G,null,X(e.list,(t,F)=>(l(),w(b,{key:t.id},{default:o(()=>[t?(l(),m("div",Ae,[i(I,{hoverable:"",size:"small"},{action:o(()=>[a("div",Ne,[a("div",Pe,[e.editNameInfo.idEdit===t.id?(l(),w(A,{key:0,value:e.editNameInfo.newTitle,"onUpdate:value":n[1]||(n[1]=v=>e.editNameInfo.newTitle=v),valueModifiers:{trim:!0},ref_for:!0,ref:"inputInstRef",size:"small",type:"text",maxlength:16,placeholder:"输入新名称",onBlur:e.blurHandle,onKeyup:n[2]||(n[2]=pe(v=>e.saveNewName(!0),["enter"]))},null,8,["value"])):(l(),m("span",ze,[i(_,{class:"go-animation-twinkle go-mr-2",dot:"",color:t.state===0?"#fcbc40":"#34c749"},null,8,["color"]),i(g,{class:"go-ellipsis-1 text disabled-drag go-cursor-pointer",title:t.title,onDblclick:v=>e.renameHandle(t)},{default:o(()=>[f(k(t.title||""),1)]),_:2},1032,["title","onDblclick"])]))]),a("div",De,[a("div",Le,[i(g,{depth:3,style:{"font-size":"12px"}},{default:o(()=>[f(k(e.dayjs(t.updateAt).format("YYYY-MM-DD")||""),1)]),_:2},1024)]),a("div",Ue,[i(S,null,{default:o(()=>[e.isPrivateMemberPoint?p("",!0):(l(),m("span",Re,[t.points===0?(l(),w(y,{key:0,class:"tag",size:"small",bordered:!1},{default:o(()=>n[4]||(n[4]=[a("span",null,"免费",-1)])),_:1})):(l(),w(u,{key:1,trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:o(()=>[i(y,{class:"tag",size:"small",bordered:!1,type:"primary"},{default:o(()=>[n[5]||(n[5]=a("img",{src:we,alt:"",style:{position:"relative",top:"4px",height:"16px"}},null,-1)),a("span",Ve,k(t.points),1)]),_:2},1024)]),default:o(()=>[f(" "+k(t.points)+" 积分 ",1)]),_:2},1024))])),i(u,{trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:o(()=>[i(h,{text:"",focusable:!1,onClick:v=>e.editHandle(t.id)},{icon:o(()=>[i(E,null,{default:o(()=>[i(e.EditIcon)]),_:1})]),_:2},1032,["onClick"])]),default:o(()=>[n[6]||(n[6]=f(" 编辑 "))]),_:2},1024),i(u,{trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:o(()=>[i(h,{text:"",focusable:!1,onClick:v=>e.deleteHandle(t.id,F)},{icon:o(()=>[i(E,null,{default:o(()=>[i(e.TrashOutlineIcon)]),_:1})]),_:2},1032,["onClick"])]),default:o(()=>[n[7]||(n[7]=f(" 删除模型 "))]),_:2},1024)]),_:2},1024)])])])]),default:o(()=>[a("div",Fe,[a("div",{class:"list-content-img",id:t.id},null,8,Me),t.state!==2?(l(),m("div",He,[t.state===0?(l(),w(h,{key:0,dashed:"",onClick:v=>e.loadItemModel(t)},{default:o(()=>n[3]||(n[3]=[f("加载模型")])),_:2},1032,["onClick"])):p("",!0),t.state===1?(l(),w(B,{key:1})):p("",!0)])):p("",!0)])]),_:2},1024)])):p("",!0)]),_:2},1024))),128))]),_:1})):p("",!0),e.fetchDataLoading?(l(),m("div",je,[i(B,{size:"large"})])):p("",!0),e.inBottom&&e.list.length?(l(),m("div",Oe,[i(g,{depth:3},{default:o(()=>n[8]||(n[8]=[f("已经到底部啦~")])),_:1})])):p("",!0),!e.list.length&&!e.fetchDataLoading?(l(),m("div",Ye,[i(g,{depth:"3",style:{"font-size":"16px"}},{default:o(()=>n[9]||(n[9]=[f("暂无 3D 模型，请点击创建模型")])),_:1})])):p("",!0)])}const wt=_e(be,[["render",Ke],["__scopeId","data-v-2dad20ae"],["__file","index.vue"]]);export{wt as default};
