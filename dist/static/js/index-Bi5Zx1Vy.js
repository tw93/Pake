var Q=Object.defineProperty,W=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var q=(g,e,d)=>e in g?Q(g,e,{enumerable:!0,configurable:!0,writable:!0,value:d}):g[e]=d,A=(g,e)=>{for(var d in e||(e={}))$.call(e,d)&&q(g,d,e[d]);if(P)for(var d of P(e))ee.call(e,d)&&q(g,d,e[d]);return g},N=(g,e)=>W(g,Z(e));import{d as te,a5 as oe,e as ne,ac as ae,r as h,H as le,eY as se,bX as ue,aa as R,b8 as j,_ as ie,U as u,c as H,o as D,s as t,w as o,q as i,X as s,F as re,n as de,Y as I,t as G,V as J}from"./index-DzJUk-4s.js";import{g as ce}from"./plugin-BZaVEG5Y.js";import{d as me}from"./index-YIaHLc6Z.js";import{i as X}from"./icon-Bt2TghsQ.js";import{u as pe}from"./index-B2h3DCGB.js";import{M as fe}from"./index-DumZb7Zp.js";import{C as ge}from"./index-DkV0_qOD.js";import"./file-BoGdIhh5.js";import"./systemStore-CDAOEx2u.js";import"./fileTypeEnum-22QBGXO_.js";import"./querySelectorAll-CWDd-9ax.js";import"./noImage-C1O4zUTD.js";import"./index.d-J2-cmQid.js";import"./correct-mOxEQCJ-.js";import"./chart_default-Cv54ZmSo.js";import"./noFile-CJNz9t2r.js";import"./useSync.hook-CykodbHN.js";import"./listen-BenKfQqv.js";import"./driver.js-DincbcBx.js";import"./drawRemote-BVHvBcY1.js";import"./index-BWD_u572.js";import"./indexDBStore-BkJ2w0ZQ.js";/* empty css                                                              */import"./error-DU3-BFcz.js";import"./index-BCTmwJrR.js";/* empty css               */import"./GoUserAvatar-BBITl89l.js";import"./points-Bi1H5gtF.js";import"./index-CYCNU51b.js";import"./svip-tip-BogTL7q_.js";import"./doc-Br7GyA9J.js";const _e=te({__name:"index",setup(g,{expose:e}){e(),oe(l=>({"1c0caa98":b.value}));const{HelpOutlineIcon:d,DocumentTextIcon:n,TrashIcon:M,CopyIcon:T,BarcodeOutlineIcon:z}=X.ionicons5,{AreaCustomIcon:x}=X.carbon,F=ae(),p=pe(),c=h(!1),w=h(null),f=h(!1),C=h(!1),_=h(-1),r=le({name:"",desc:"",stringValue:"return args[0]"}),b=ne(()=>F.getAppTheme),V={name:{required:!0,message:"请输入「英文 | 数字 | 下划线」",trigger:"input",validator(l,m){return se(m)}},stringValue:{required:!0,message:"请输入默认值"}},L=[{label:"静态值",value:"static"},{label:"路由解析（如 http://www.xxx?A=1，解析A）",value:"router"}],S=()=>{c.value=!0},B=()=>{C.value=!1,_.value=-1,c.value=!1,r.name="",r.desc="",r.stringValue="return args[0]"},U={HelpOutlineIcon:d,DocumentTextIcon:n,TrashIcon:M,CopyIcon:T,BarcodeOutlineIcon:z,AreaCustomIcon:x,designStore:F,chartEditStore:p,showModal:c,formRef:w,saveLoading:f,isEdit:C,editIndex:_,formValue:r,themeColor:b,rules:V,options:L,addGlobalData:S,closeEvents:B,copyName:async(l,m)=>{l.preventDefault(),l.stopPropagation();const{copy:y,isSupported:v}=me({source:m.name});v?(await y(),window.$message.success("复制名称成功")):ue(m.name)?window.$message.success("复制名称成功"):window.$message.error("复制失败")},copyItem:(l,m,y)=>{l.preventDefault(),l.stopPropagation();const v=JSON.parse(JSON.stringify(m));v.id=R(),v.name=`${v.name}_copy`,p.getFilterList.splice(y+1,0,v)},deleteItem:(l,m,y)=>{l.preventDefault(),l.stopPropagation(),ce({message:`删除后无法恢复，确定删除过滤器 ${m.name} ?`,onPositiveCallback:()=>{p.getFilterList.splice(y,1)}})},editContent:(l,m)=>{C.value=!0,_.value=m,r.name=l.name,r.desc=l.desc,r.stringValue=l.stringValue,c.value=!0},saveHandle:l=>{var m;l.preventDefault(),(m=w.value)==null||m.validate(async y=>{if(!y&&r){f.value=!0;const v=()=>{const O=p.getFilterList.some((Y,K)=>Y.name===r.name&&K!==_.value);return O&&window.$message.error("保存失败，过滤器名称已存在！"),O};if(C.value)if(_.value>-1)if(!v())p.getFilterList[_.value]=N(A({},j(r)),{id:p.getFilterList[_.value].id});else{f.value=!1;return}else window.$message.error("保存失败，未找到编辑项！");else if(!v())p.getFilterList.push(N(A({},j(r)),{id:R()}));else{f.value=!1;return}setTimeout(()=>{f.value=!1,B()},300)}})},MonacoEditor:fe,get ContentBox(){return ge}};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),ve={class:"list-box"},Fe={class:"list-top"},xe={style:{height:"18px"}},Ce=["onClick"],Ee={class:"list-item-left"},ye={class:"code-model-box"},we={class:"go-flex-center"},be={class:"model-content-box"},he={class:"go-flex-items-center"};function De(g,e,d,n,M,T){const z=u("svg-icon"),x=u("n-button"),F=u("n-icon"),p=u("n-tooltip"),c=u("n-space"),w=u("n-divider"),f=u("n-text"),C=u("n-ellipsis"),_=u("n-code"),r=u("n-input"),b=u("n-form-item"),V=u("n-card"),L=u("n-form"),S=u("n-tag"),B=u("n-modal");return D(),H("div",null,[t(n.ContentBox,{class:"go-content-global-data",title:"全局过滤器",depth:1,backIcon:!1},{default:o(()=>[t(c,{class:"top go-flex-center","wrap-item":!1},{default:o(()=>[t(x,{class:"canvas-top-right-btn",tertiary:"",focusable:!1,onClick:n.addGlobalData},{default:o(()=>[t(z,{icon:"global-data",style:{"font-size":"18px"}}),e[4]||(e[4]=i("span",{class:"go-ml-2"},"新增过滤器",-1))]),_:1}),t(p,{trigger:"hover","show-arrow":!1},{trigger:o(()=>[t(F,{size:"20",depth:3},{default:o(()=>[t(n.HelpOutlineIcon)]),_:1})]),default:o(()=>[e[5]||(e[5]=s(" 支持多大屏复用，在过滤器中进行选择 "))]),_:1})]),_:1}),t(w,{style:{margin:"2px 0"}}),i("div",ve,[(D(!0),H(re,null,de(n.chartEditStore.getFilterList,(a,k)=>(D(),H("div",{class:"list-item-box",key:a.id},[i("div",Fe,[t(C,{style:{"max-width":"210px"}},{default:o(()=>[t(p,{trigger:"hover"},{trigger:o(()=>[t(f,{class:"title",depth:2,style:{"font-size":"13px"},onClick:E=>n.copyName(E,a)},{default:o(()=>[s(I(a.name),1)]),_:2},1032,["onClick"])]),default:o(()=>[e[6]||(e[6]=s(" 点击复制名称 "))]),_:2},1024)]),_:2},1024),i("div",xe,[t(p,{"show-arrow":!1,trigger:"hover"},{trigger:o(()=>[t(x,{class:"go-mr-1",text:"",onClick:E=>n.copyItem(E,a,k)},{icon:o(()=>[t(F,{size:"14",depth:3},{default:o(()=>[t(n.CopyIcon)]),_:1})]),_:2},1032,["onClick"])]),default:o(()=>[e[7]||(e[7]=s(" 复制 "))]),_:2},1024),t(p,{"show-arrow":!1,trigger:"hover"},{trigger:o(()=>[t(x,{text:"",onClick:E=>n.deleteItem(E,a,k)},{icon:o(()=>[t(F,{size:"16",depth:3},{default:o(()=>[t(n.TrashIcon)]),_:1})]),_:2},1032,["onClick"])]),default:o(()=>[e[8]||(e[8]=s(" 删除 "))]),_:2},1024)])]),t(w,{style:{margin:"0 0 1px"}}),i("div",{class:"list-item go-transition-quick",onClick:E=>n.editContent(a,k)},[i("div",Ee,[t(c,{vertical:"","wrap-item":!1,size:2},{default:o(()=>[i("div",ye,[t(_,{code:a.stringValue,language:"ts","word-wrap":!0,style:{"font-size":"12px"}},null,8,["code"]),e[9]||(e[9]=i("div",{class:"code-model"},null,-1))]),t(c,{size:4,"wrap-item":!1,align:"center"},{default:o(()=>[t(F,{size:"14",depth:5,style:{position:"relative",top:"1px"}},{default:o(()=>[t(n.DocumentTextIcon)]),_:1}),t(C,{style:{"margin-left":"4px","max-width":"236px"}},{default:o(()=>[t(f,{depth:3,style:{"font-size":"12px"}},{default:o(()=>[s(I(a.desc||"「暂无描述」"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])],8,Ce)]))),128)),i("div",we,[n.chartEditStore.getFilterList.length?J("",!0):(D(),G(f,{key:0,depth:3,style:{"font-size":"13px"}},{default:o(()=>e[10]||(e[10]=[s("暂无数据")])),_:1}))])])]),_:1}),t(B,{class:"go-background-filter",show:n.showModal,"onUpdate:show":e[3]||(e[3]=a=>n.showModal=a),"mask-closable":!1,onAfterLeave:n.closeEvents},{default:o(()=>[t(V,{bordered:!1,role:"dialog",size:"small","aria-modal":"true","content-style":"padding: 0",style:{width:"880px",height:"610px"}},{header:o(()=>[t(c,null,{default:o(()=>[t(f,null,{default:o(()=>[s(I(n.isEdit?"编辑过滤器":"新增过滤器"),1)]),_:1})]),_:1})]),action:o(()=>[t(c,{justify:"space-between",align:"end"},{default:o(()=>[i("div",he,[t(S,{bordered:!1,type:"primary",style:{"border-radius":"5px"}},{icon:o(()=>[t(F,{component:n.DocumentTextIcon},null,8,["component"])]),default:o(()=>[e[13]||(e[13]=s(" 说明 "))]),_:1}),t(c,{vertical:"",align:"start",size:"small",class:"go-ml-4 go-fs-13"},{default:o(()=>[t(f,{depth:"2"},{default:o(()=>e[14]||(e[14]=[s("在函数中，可使用「args」变量 (数组类型) 来获取所有参数")])),_:1}),t(f,{depth:"2"},{default:o(()=>e[15]||(e[15]=[s("window.$globalExposeFunction 下面的方法可以获取/编辑组件配置，或切换页面等")])),_:1})]),_:1})]),t(c,null,{default:o(()=>[t(x,{class:"go-px-4",size:"medium",focusable:!1,onClick:n.closeEvents},{default:o(()=>e[16]||(e[16]=[s("取消")])),_:1}),t(x,{class:"go-px-4",type:"primary",size:"medium",loading:n.saveLoading,onClick:n.saveHandle},{default:o(()=>[s(I(n.isEdit?"保存修改":"确认"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),default:o(()=>[t(w,{style:{margin:"0"}}),i("div",be,[n.formValue?(D(),G(L,{key:0,ref:"formRef",size:"medium","label-placement":"left",model:n.formValue,"label-width":80,rules:n.rules},{default:o(()=>[t(b,{label:"名称",path:"name"},{default:o(()=>[t(r,{value:n.formValue.name,"onUpdate:value":e[0]||(e[0]=a=>n.formValue.name=a),valueModifiers:{trim:!0},type:"text",maxlength:"20","show-count":"",placeholder:"请输入「英文 | 数字」过滤器名称"},null,8,["value"])]),_:1}),t(b,{label:"描述",path:"desc"},{default:o(()=>[t(r,{value:n.formValue.desc,"onUpdate:value":e[1]||(e[1]=a=>n.formValue.desc=a),valueModifiers:{trim:!0},type:"text",maxlength:"100","show-count":"",placeholder:"请输入描述"},null,8,["value"])]),_:1}),t(b,{label:"函数体",path:"stringValue"},{default:o(()=>[t(V,{size:"small","content-style":{paddingLeft:"10px",paddingRight:"10px"}},{default:o(()=>[t(c,{vertical:""},{default:o(()=>[e[11]||(e[11]=i("span",{style:{"font-size":"13px"}},[i("span",{class:"func-keyword"},"function"),i("span",{class:"func-name go-ml-2"},"filter"),s(" ( "),i("span",null,"...args"),s(" )  { ")],-1)),t(n.MonacoEditor,{modelValue:n.formValue.stringValue,"onUpdate:modelValue":e[2]||(e[2]=a=>n.formValue.stringValue=a),height:"220px",language:"javascript"},null,8,["modelValue"]),e[12]||(e[12]=s(" } "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):J("",!0)])]),_:1})]),_:1},8,["show"])])}const ut=ie(_e,[["render",De],["__scopeId","data-v-eb71fdc2"],["__file","index.vue"]]);export{ut as default};
