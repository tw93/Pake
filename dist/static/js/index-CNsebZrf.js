const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/js/remoteItem-CnFXa94E.js","static/js/index-DzJUk-4s.js","static/css/index-BZJqFamK.css","static/js/projectStore-BUNtFK-_.js","static/js/systemStore-CDAOEx2u.js","static/js/plugin-BZaVEG5Y.js","static/js/icon-Bt2TghsQ.js","static/js/file-BoGdIhh5.js","static/js/import-C6j5z5Sk.js","static/js/templateCode-B4T5QxGG.js","static/js/index-YIaHLc6Z.js","static/js/chart_default-Cv54ZmSo.js","static/js/points-Bi1H5gtF.js","static/js/index-DumZb7Zp.js","static/css/index-BZSqXE9v.css","static/js/index-jtCf6VIy.js","static/js/index-B2h3DCGB.js","static/js/fileTypeEnum-22QBGXO_.js","static/css/index-8Xm-dR8g.css","static/js/config-4CXe4sys.js","static/js/config-Df8FU9mm.js","static/js/svip-tip-BogTL7q_.js","static/css/index-C3YoGMPk.css","static/js/team.api-Dw2fcOfS.js","static/js/index-CYCNU51b.js","static/js/doc-Br7GyA9J.js","static/css/index-XBzHfgAz.css","static/js/project-list-bg-C8sD85Ky.js","static/js/masterplates.api-CmXDBnKg.js","static/js/GoUserAvatar-BBITl89l.js","static/css/GoUserAvatar-DY3OCpB8.css","static/js/noCard-C4rQreFQ.js","static/css/remoteItem-Ck6D-bb-.css","static/css/index-B4AnWmql.css","static/css/GoUserInfoSetting-CvEWRQQ9.css","static/js/index-BfRCj20m.js","static/css/index-BrZpQtQ7.css","static/js/memberProject-BCeR5DAx.js","static/css/memberProject-PytrfcaM.css","static/js/settingProject-BN-52te6.js","static/css/settingProject-BlAbblDQ.css","static/js/index-B86jA8o9.js","static/js/index-BBNnqqCS.js","static/css/index-VyL3it9o.css","static/js/logo-Bd1KfhDG.js","static/css/logo-xIaje4g0.css","static/js/noData-C0vzgK10.js","static/js/indexDBStore-BkJ2w0ZQ.js","static/css/index-BAZeGry4.css"])))=>i.map(i=>d[i]);
var Rt=Object.defineProperty,Pt=Object.defineProperties;var jt=Object.getOwnPropertyDescriptors;var st=Object.getOwnPropertySymbols;var Ht=Object.prototype.hasOwnProperty,Ot=Object.prototype.propertyIsEnumerable;var rt=(b,t,a)=>t in b?Rt(b,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):b[t]=a,Ie=(b,t)=>{for(var a in t||(t={}))Ht.call(t,a)&&rt(b,a,t[a]);if(st)for(var a of st(t))Ot.call(t,a)&&rt(b,a,t[a]);return b},Ve=(b,t)=>Pt(b,jt(t));import{d as ne,a5 as We,r as D,ac as Ue,e as W,D as ye,b1 as Bt,aa as Nt,R as z,E as Q,aO as Ge,a_ as Ye,aP as Ae,_ as oe,U as c,c as k,o as s,s as o,w as n,F as ee,n as _e,t as E,z as ze,q as p,V as j,Y as R,X as w,au as Ut,H as pe,A as fe,G as Me,ae as Qe,aw as Le,ah as Be,aD as bt,Z as qe,aS as Ne,ay as te,bc as lt,cv as zt,bd as ht,aH as de,K as Vt,bW as Gt,bT as qt,cw as Kt,cx as Jt,bY as Wt,b6 as Yt,W as Et,v as Ke,cy as Qt,p as Zt,cz as wt,cA as Xt,c7 as $t,b_ as en,cB as Ct,cC as tn,$ as nn,cD as on,cb as an,cE as sn,cF as rn,O as Te}from"./index-DzJUk-4s.js";import{j as ln}from"./index-YIaHLc6Z.js";import{l as Fe}from"./index-DumZb7Zp.js";import{i as ce}from"./icon-Bt2TghsQ.js";import{u as be,P as dn}from"./projectStore-BUNtFK-_.js";import{I as cn}from"./index-jtCf6VIy.js";import{i as un}from"./import-C6j5z5Sk.js";import{u as me,d as Ze,c as it}from"./systemStore-CDAOEx2u.js";import{d as St,e as mn,f as _n,g as Dt,h as xt,i as fn,j as dt,k as gn,l as pn}from"./team.api-Dw2fcOfS.js";import{g as Se,D as Re}from"./plugin-BZaVEG5Y.js";import{d as vn,a as yn}from"./file-BoGdIhh5.js";import{E as bn}from"./index-CYCNU51b.js";import{d as Xe}from"./project-list-bg-C8sD85Ky.js";import{g as hn}from"./masterplates.api-CmXDBnKg.js";import{F as Ce}from"./fileTypeEnum-22QBGXO_.js";import{g as N,T as En,a3 as wn,a4 as Cn,h as Sn}from"./index-B2h3DCGB.js";/* empty css                                                              *//* empty css                                                                          */import{G as Je}from"./GoUserAvatar-BBITl89l.js";import{r as Dn}from"./chart_default-Cv54ZmSo.js";import{_ as xn}from"./points-Bi1H5gtF.js";import{_ as ct}from"./noCard-C4rQreFQ.js";const kn="/static/png/create.png",In="/static/png/create-folder.png",Tn="/static/png/newFeature.png";var kt=(b=>(b.CREATE_FILE="createFile",b.IMPORT_JSON="importJson",b.CREATE_FOLDER="createFolder",b))(kt||{});const Fn=ne({__name:"CreateBox",props:{getCurrentFolder:{type:Boolean,default:!1}},setup(b,{expose:t}){t(),We(_=>({"39cf57cc":u.value}));const a=ye(),e=be(),{AddIcon:C}=ce.ionicons5,S=D([{label:"创建项目",desc:"多平台展示，打包部署",img:kn,key:"createFile"},{label:"创建文件夹",desc:"文件收纳归类",img:In,key:"createFolder"},{label:"导入项目",desc:"解析文件，生成新项目",img:un,key:"importJson"}]),f=Ue(),d=D(!1),u=W(()=>f.getAppTheme),m=me(),l=W(()=>m.getTeamInfo),y={eventBus:a,projectStore:e,AddIcon:C,ListItemEnum:kt,listItem:S,designStore:f,modalShow:d,themeColor:u,systemStore:m,teamInfo:l,clickHandle:async _=>{if(l.value.expired){window.$message.error("空间所有者的会员已到期，无法使用此功能");return}if(_==="importJson"){if(e.isProjectMax()){window.$message.error("您的项目数量已达到上限, 无法导入文件");return}d.value=!0}else if(_==="createFile"){if(e.isProjectMax()){window.$message.error("您的项目数量已达到上限, 无法创建新项目");return}try{const g=await Bt({projectName:Nt(),remarks:null,teamId:l.value.id,folderId:m.currentFolderId});if(g&&g.code===z.SUCCESS){a.emit(Q.PROJECT_GET_DATA);const{id:r,team_id:i}=g.data,v=Ge(Ye.CHART_HOME_NAME,"href");i?Ae(v,[r],void 0,!0,{teamId:i}):Ae(v,[r],void 0,!0)}}catch(g){}}else _==="createFolder"&&a.emit(Q.CREATEFOLDER)},get ImportJson(){return cn},get newFeature(){return Tn}};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),An={class:"go-project-create-box"},Ln=["onClick"],Mn={class:"go-flex-center"},Rn=["src"],Pn={class:"right-desc"},jn={class:"label"},Hn=["src"];function On(b,t,a,e,C,S){const f=c("n-text"),d=c("n-icon"),u=c("n-grid-item"),m=c("n-grid");return s(),k("div",An,[o(m,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:3 xl:4 xxl:5",responsive:"screen"},{default:n(()=>[(s(!0),k(ee,null,_e(e.listItem,l=>(s(),E(u,{key:l.key,class:ze({disabled:a.getCurrentFolder&&l.key===e.ListItemEnum.CREATE_FOLDER}),id:`${l.key}Driver`},{default:n(()=>[p("div",{class:"item go-flex-center go-transition-quick",onClick:h=>e.clickHandle(l.key)},[p("div",Mn,[p("img",{class:"go-transition",src:l.img,alt:"创建"},null,8,Rn),p("div",Pn,[p("div",jn,R(l.label),1),o(f,{class:"desc",depth:3},{default:n(()=>[w(R(l.desc),1)]),_:2},1024),l.key===e.ListItemEnum.IMPORT_JSON?(s(),k("img",{key:0,class:"new-feature",src:e.newFeature},null,8,Hn)):j("",!0)])]),o(d,{size:"16",component:e.AddIcon},null,8,["component"])],8,Ln)]),_:2},1032,["class","id"]))),128))]),_:1}),o(e.ImportJson,{modalShow:e.modalShow,"onUpdate:modalShow":t[0]||(t[0]=l=>e.modalShow=l)},null,8,["modalShow"])])}const Bn=oe(Fn,[["render",On],["__scopeId","data-v-09c8fbd4"],["__file","CreateBox.vue"]]),It="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='65'%20height='9'%20viewBox='0%200%2065%209'%20fill='none'%3e%3cg%20opacity='1'%20transform='translate(0%200)%20rotate(0%2032.5%204.5)'%3e%3cpath%20id='减去顶层'%20fill-rule='evenodd'%20style='fill:%23FFFFFF'%20transform='translate(1%201)%20rotate(0%2030.399999618530273%204)'%20opacity='1'%20d='M0%208L60.8%208C59.47%208%2058.2%207.72%2056.99%207.15C55.78%206.58%2054.75%205.79%2053.89%204.76L52.02%202.52C51.36%201.72%2050.55%201.1%2049.61%200.66C48.67%200.22%2047.68%200%2046.64%200L7%200C6.05%200%205.14%200.18%204.27%200.55Q3.025%201.075%202.05%202.05Q1.075%203.025%200.55%204.27C0.18%205.14%200%206.05%200%207L0%208Z%20'%3e%3c/path%3e%3cpath%20id='减去顶层'%20fill-rule='evenodd'%20style='fill:%23E9E9E9'%20transform='translate(0%200)%20rotate(0%2032.5%204.5)'%20opacity='1'%20d='M61.8%208L65%208L65%209L61.8%209C60.47%209%2059.2%208.72%2057.99%208.15C56.78%207.58%2055.75%206.79%2054.89%205.76L53.02%203.52C52.36%202.72%2051.55%202.1%2050.61%201.66C49.67%201.22%2048.68%201%2047.64%201L8%201C7.05%201%206.14%201.18%205.27%201.55Q4.025%202.075%203.05%203.05Q2.075%204.025%201.55%205.27C1.18%206.14%201%207.05%201%208L1%209L0%209L0%208C0%203.58%203.58%200%208%200L47.64%200C50.02%200%2052.27%201.05%2053.79%202.88L55.66%205.12C57.18%206.94%2059.43%208%2061.8%208Z%20'%3e%3c/path%3e%3c/g%3e%3c/svg%3e",Tt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='65'%20height='9'%20viewBox='0%200%2065%209'%20fill='none'%3e%3cg%20opacity='1'%20transform='translate(0%200)%20rotate(0%2032.5%204.5)'%3e%3cpath%20id='减去顶层'%20fill-rule='evenodd'%20style='fill:%2318181C'%20transform='translate(1%201)%20rotate(0%2030.399999618530273%204)'%20opacity='1'%20d='M0%208L60.8%208C59.47%208%2058.2%207.72%2056.99%207.15C55.78%206.58%2054.75%205.79%2053.89%204.76L52.02%202.52C51.36%201.72%2050.55%201.1%2049.61%200.66C48.67%200.22%2047.68%200%2046.64%200L7%200C6.05%200%205.14%200.18%204.27%200.55Q3.025%201.075%202.05%202.05Q1.075%203.025%200.55%204.27C0.18%205.14%200%206.05%200%207L0%208Z%20'%3e%3c/path%3e%3cpath%20id='减去顶层'%20fill-rule='evenodd'%20style='fill:%2318181C'%20transform='translate(0%200)%20rotate(0%2032.5%204.5)'%20opacity='1'%20d='M61.8%208L65%208L65%209L61.8%209C60.47%209%2059.2%208.72%2057.99%208.15C56.78%207.58%2055.75%206.79%2054.89%205.76L53.02%203.52C52.36%202.72%2051.55%202.1%2050.61%201.66C49.67%201.22%2048.68%201%2047.64%201L8%201C7.05%201%206.14%201.18%205.27%201.55Q4.025%202.075%203.05%203.05Q2.075%204.025%201.55%205.27C1.18%206.14%201%207.05%201%208L1%209L0%209L0%208C0%203.58%203.58%200%208%200L47.64%200C50.02%200%2052.27%201.05%2053.79%202.88L55.66%205.12C57.18%206.94%2059.43%208%2061.8%208Z%20'%3e%3c/path%3e%3c/g%3e%3c/svg%3e",Nn=ne({__name:"index",props:{type:{type:String,required:!1},isRecycle:{type:Boolean,required:!1,default:!1}},setup(b,{expose:t}){t(),We(F=>({"2796f4c0":m.value}));const a=Ut(),e=ye(),C=me(),S=be(),f=W(()=>C.getTeamInfo),d=b,u=Ue(),m=W(()=>u.getAppTheme),l=pe([{label:"查看",key:"view"},{label:"重命名",key:"rename"},{label:"",type:"divider",key:"d1"},{label:"删除",key:"delete"}]),h=pe([{label:"恢复",key:"restore"},{label:"彻底删除",key:"delete"}]),y=D(!1),_=D(null),g=D({name:""}),r=D({name:[{required:!0,message:"请输入文件夹名称",trigger:"input"},{message:"文件夹名称长度需要1-16个字符",max:16,min:1,trigger:"input"}]}),i=D(),v=D(!1),A=D(0),H=D(0),G=(F,V)=>{F.preventDefault(),L.value=V.id,v.value=!1,Le().then(()=>{i.value=V,v.value=!0,A.value=F.clientX,H.value=F.clientY})},U=()=>{v.value=!1},B=F=>{switch(F){case"view":De(i.value.id);break;case"rename":q();break;case"delete":Y();break;case"restore":ae();break}U()},O=()=>{g.value.name=""},Y=async()=>{Se({type:Re.DELETE,message:"是否删除文件夹包括内部的所有文件？",onPositiveCallback:async()=>{try{(await fn({folder_id:i.value.id,clear:d.isRecycle})).code==z.SUCCESS&&(window.$message.success("删除成功"),I())}catch(F){window.$message.error("操作失败, 请稍后重试")}}})},ae=async()=>{try{(await mn({folder_id:i.value.id})).code==z.SUCCESS&&(window.$message.success("恢复成功"),I())}catch(F){window.$message.error("操作失败, 请稍后重试")}},ue=()=>{x.isEnter||le()},le=async(F=!1)=>{if(x.isEnter=F,x.idEdit=!1,!x.newTitle.trim()){window.$message.warning("名称不能为空");return}if(x.newTitle!==x.oldTitle&&i.value)try{(await _n({folder_id:i.value.id,folder_name:x.newTitle})).code==z.SUCCESS&&(window.$message.success("修改成功"),i.value.folder_name=x.newTitle)}catch(V){window.$message.error("操作失败, 请稍后重试")}},J=D(null),x=pe({idEdit:!1,isEnter:!1,newTitle:"",oldTitle:""}),q=()=>{i.value&&(x.newTitle=i.value.folder_name||"",x.oldTitle=i.value.folder_name||"",x.idEdit=i.value.id,Le(()=>{J.value&&J.value[0].focus()}))},se=async()=>{y.value=!0};e.on(Q.CREATEFOLDER,se);const T=async()=>{var F;(F=_.value)==null||F.validate(async V=>{if(!V){let Z="chart";d.type==="component"&&(Z="component");try{const X=await Dt({team_id:f.value.id,folder_name:g.value.name,content_type:Z});if(!X||X.code!==z.SUCCESS){window.$message.error("创建文件夹失败！");return}window.$message.success("创建文件夹成功！"),I()}catch(X){}y.value=!1}})};fe(()=>S.getHomeSort,F=>{I()},{immediate:!1});const M=D([]),I=async()=>{var X;const F=S.getHomeSort,{sortKey:V,sortValue:Z}=F;try{const re=await xt({teamId:f.value.id,sortKey:V,sortValue:Z,dustbin:d.isRecycle,folderId:C.currentFolderId});if(!re||re.code!==z.SUCCESS)return;const Pe=((X=re==null?void 0:re.data)==null?void 0:X.list)||[],je=()=>{var ke;M.value=((ke=re==null?void 0:re.data)==null?void 0:ke.children)||[],C.setItem(Be.FILEFOLDERLIST,Pe)};e.emit(Q.PROJECT_GET_DATA,{callback:je})}catch(re){console.log(re)}};e.on(Q.UPDATEFOLDER,I);const L=D(""),K=(F,V)=>{L.value=V.id,F.preventDefault()},ie=F=>{L.value=""},ve=(F,V)=>{F.stopPropagation(),F.preventDefault(),d.isRecycle||(L.value=V)},De=F=>{x.idEdit||d.isRecycle||(C.setItem(Be.CURRENTFOLDERID,F),L.value="",I())},he=F=>{L.value=""};let Ee;fe(()=>a.currentRoute.value,F=>{const V=C.currentFolderId,Z=C.getTeamInfo.id,X=V+Z;X!==Ee&&(Ee=X,I())},{immediate:!0}),e.on(Q.FILEDRAGEND,async({id:F,target:V})=>{const Z=L.value;Z&&(console.log("你需要将内容移入文件夹"),L.value="",we({folderId:Z,contentId:F,teamId:f.value.id}))}),e.on(Q.MOVEFILETOFOLDER,async({contentId:F,folderId:V,teamId:Z})=>{F&&(console.log("你需要将内容移出文件夹"),we({folderId:V,contentId:F,teamId:Z}))});const we=async({folderId:F,contentId:V,teamId:Z})=>{if(F===void 0||V===void 0||Z===void 0){console.warn("需要传入正确的参数!");return}try{const X=await St({content_type:"chart",folder_id:F,content_id:V,team_id:Z});if(!X||X.code!==z.SUCCESS)return;L.value="",window.$message.success("移动成功！"),e.emit(Q.UPDATEFOLDER)}catch(X){console.log(X)}};Me(()=>{document.addEventListener("click",he)}),Qe(()=>{document.removeEventListener("click",he)});const xe={router:a,eventBus:e,systemStore:C,projectStore:S,teamInfo:f,props:d,designStore:u,themeColor:m,selectOptions:l,recycleSelectOptions:h,showRef:y,formRef:_,formValue:g,rules:r,currentContentMenuItem:i,showDropdownRef:v,xRef:A,yRef:H,handleContextMenu:G,onClickoutside:U,handleSelect:B,closeHandle:O,deleteHandle:Y,restoreHandle:ae,blurHandle:ue,saveNewName:le,inputNameRef:J,editNameInfo:x,renameHandle:q,createFolder:se,createFolderHandle:T,fileFolderList:M,getFileFolderList:I,dragActived:L,dragenterFn:K,dragleaveFn:ie,handleClick:ve,handleDoubleClick:De,removeSelect:he,get oldKey(){return Ee},set oldKey(F){Ee=F},moveFolderFn:we,get folderLight(){return It},get folderDark(){return Tt},get NInput(){return bt},get dayjs(){return Ze}};return Object.defineProperty(xe,"__isScriptSetup",{enumerable:!1,value:!0}),xe}}),Un={class:"container"},zn=["data-id","onDragover","onClick","onDblclick","onContextmenu"],Vn={class:"file-folder-box"},Gn=["src"],qn={key:1,class:"folder-content-box"},Kn={class:"left"},Jn={class:"right"},Wn={key:0,class:"right__top"},Yn={key:1,style:{width:"45px",height:"54px"}},Qn={class:"right__bottom"},Zn={class:"file-folder-list-name"},Xn={class:"content"};function $n(b,t,a,e,C,S){const f=c("n-text"),d=c("n-image"),u=c("n-dropdown"),m=c("n-divider"),l=c("n-form-item"),h=c("n-form"),y=c("n-button"),_=c("n-space"),g=c("n-modal");return s(),k("div",Un,[e.fileFolderList.length?(s(),k("div",{key:0,class:"file-folder-list",onDragenter:t[2]||(t[2]=r=>{e.dragleaveFn(r)}),onDragleave:t[3]||(t[3]=r=>{e.dragleaveFn(r)})},[(s(!0),k(ee,null,_e(e.fileFolderList,r=>(s(),k("div",{class:ze(["file-folder-list-item go-transition-quick",{actived:r.id===e.dragActived}]),key:r.id,"data-id":r.id,onDragover:Ne(i=>{e.dragenterFn(i,r)},["stop"]),onClick:i=>e.handleClick(i,r.id),onDblclick:i=>e.handleDoubleClick(r.id),onContextmenu:i=>{e.handleContextMenu(i,r)}},[p("div",Vn,[p("img",{class:"file-folder-box-svg",src:e.designStore.getDarkTheme?e.folderDark:e.folderLight},null,8,Gn),r.total?(s(),k("div",qn,[p("div",Kn,[r!=null&&r.thumbnails.filter(i=>i!=="")[0]?(s(),E(d,{key:0,src:r==null?void 0:r.thumbnails.filter(i=>i!=="")[0],width:"72",height:"72","object-fit":"contain","preview-disabled":""},null,8,["src"])):j("",!0)]),p("div",Jn,[(r==null?void 0:r.thumbnails[1])!==null&&(r==null?void 0:r.thumbnails[1])!==void 0?(s(),k("div",Wn,[r!=null&&r.thumbnails.filter(i=>i!=="")[1]?(s(),E(d,{key:0,src:r==null?void 0:r.thumbnails.filter(i=>i!=="")[1],width:"45",height:"45","object-fit":"contain","preview-disabled":""},null,8,["src"])):j("",!0)])):(s(),k("div",Yn)),p("div",Qn,[o(f,{depth:"3"},{default:n(()=>[w("+"+R(r.total),1)]),_:2},1024)])])])):(s(),E(f,{key:0,class:"num",depth:3},{default:n(()=>[w(R(r.total?`+${r.total}`:"[空]"),1)]),_:2},1024))]),p("div",Zn,[e.editNameInfo.idEdit===r.id?(s(),E(e.NInput,{key:0,value:e.editNameInfo.newTitle,"onUpdate:value":t[0]||(t[0]=i=>e.editNameInfo.newTitle=i),valueModifiers:{trim:!0},ref_for:!0,ref:"inputNameRef",size:"tiny",type:"text",placeholder:"输入新名称",onBlur:e.blurHandle,onKeyup:t[1]||(t[1]=qe(i=>e.saveNewName(!0),["enter"]))},null,8,["value"])):(s(),E(f,{key:1,class:"go-ellipsis-1",title:r.folder_name},{default:n(()=>[w(R(r.folder_name),1)]),_:2},1032,["title"]))]),o(f,{class:"file-folder-list-text",depth:3},{default:n(()=>[w(R(e.dayjs(r.createdAt).format("YYYY-MM-DD HH:mm:ss")),1)]),_:2},1024)],42,zn))),128))],32)):j("",!0),o(u,{trigger:"manual",placement:"bottom-start",options:a.isRecycle?e.recycleSelectOptions:e.selectOptions,"show-arrow":!1,x:e.xRef,y:e.yRef,show:e.showDropdownRef,"on-clickoutside":e.onClickoutside,onSelect:e.handleSelect},null,8,["options","x","y","show"]),o(g,{class:"go-team-modal-box go-background-filter",show:e.showRef,"onUpdate:show":t[5]||(t[5]=r=>e.showRef=r),preset:"card",size:"small",style:{width:"560px"},"transform-origin":"center","close-on-esc":!0,"mask-closable":!0,"content-style":"",onAfterLeave:e.closeHandle},{header:n(()=>t[6]||(t[6]=[p("div",{class:"header"},"创建文件夹",-1)])),default:n(()=>[o(m,{style:{margin:"0"}}),p("div",Xn,[o(h,{ref:"formRef","label-width":80,model:e.formValue,rules:e.rules},{default:n(()=>[o(l,{path:"name"},{default:n(()=>[o(e.NInput,{value:e.formValue.name,"onUpdate:value":t[4]||(t[4]=r=>e.formValue.name=r),autofocus:"",type:"text",size:"large",placeholder:"请输入文件夹名称",maxlength:"16",onKeyup:qe(e.createFolderHandle,["enter"])},null,8,["value"])]),_:1})]),_:1},8,["model","rules"]),o(_,{"wrap-item":!1,justify:"end"},{default:n(()=>[o(y,{type:"primary",onClick:e.createFolderHandle},{default:n(()=>[o(f,{style:{"font-size":"14px"}},{default:n(()=>t[7]||(t[7]=[w("创建")])),_:1})]),_:1})]),_:1})])]),_:1},8,["show"])])}const Ft=oe(Nn,[["render",$n],["__scopeId","data-v-abc37bc7"],["__file","index.vue"]]),eo=ne({__name:"index",props:{modalShow:Boolean,isManage:Boolean,isTeamManger:Boolean,isTeamCreate:Boolean,cardData:Object},emits:["update:modalShow"],setup(b,{expose:t,emit:a}){t();const e={[N.MANAGE]:"管理",[N.EDIT]:"编辑",[N.VIEW]:"查看",[N.REMOVE]:"移除协作"},C=a,S=b,{ChevronDownIcon:f,TrashIcon:d,CloseCircleOutlineIcon:u}=ce.ionicons5,m=me(),l=D({content_role_status:N.VIEW}),{id:h}=m.getUserInfo,{id:y,createUserId:_}=m.getTeamInfo,g=D(!1),r=D([]),i=D([]),v=D(!0),A=[{label:e[N.MANAGE],key:N.MANAGE,desc:"可管理协作人员，拥有大屏所有操作权限"},{label:e[N.EDIT],key:N.EDIT,desc:"可查看、编辑、保存、重命名大屏"},{label:e[N.VIEW],key:N.VIEW,desc:"可查看大屏内容"},{type:"divider",key:"d1"},{key:N.REMOVE,label:()=>te("div",[te("span",{style:"color: #E55D5D; font-weight: 500"},e[N.REMOVE])])}],H=[{label:e[N.MANAGE],key:N.MANAGE,desc:"可管理协作人员，拥有大屏所有操作权限"},{label:e[N.EDIT],key:N.EDIT,desc:"可查看、编辑、保存、重命名大屏"},{label:e[N.VIEW],key:N.VIEW,desc:"可查看大屏内容"}],G=[{label:e[N.VIEW],key:N.VIEW},{type:"divider",key:"d1"},{key:N.REMOVE,label:()=>te("div",[te("span",{style:"color: #E55D5D; font-weight: 500"},"离开协作"),te(lt,{color:" #E55D5D",style:"position: relative; top: 2px;"},{default:()=>te(d)})])}],U=T=>te("div",{style:{display:"flex",alignItems:"center",gap:"10px"}},[te(Je,{width:22,height:22,avatarUrl:T.avatar,style:{height:"22px"}}),te("span",{style:{fontSize:"13px"}},T.nickname)]),B=T=>{const{option:M,node:I}=T;return M.desc?te(zt,{keepAliveOnHover:!1,showArrow:!1,style:{width:"max-content"},placement:"right"},{trigger:()=>[I],default:()=>M.desc}):I},O=T=>{l.value&&(l.value.content_role_status=T)},Y=async(T,M,I)=>{const L=async(K=()=>{})=>{var ve;(await dt({team_member_id:M.id,status:T===N.REMOVE?null:T,content_id:(ve=S.cardData)==null?void 0:ve.id,team_id:y,content_type:"chart"})).code===z.SUCCESS&&(i.value[I].content_role_status=T,K())};T===N.REMOVE?Se({message:"是否移除成员？",onPositiveCallback:async()=>{L(()=>{window.$message.success("移除成功"),i.value.splice(I,1),r.value.push(M)})}}):L(()=>{window.$message.success("设置成功")})},ae=(T,M)=>{var I;l.value=Ve(Ie({},M),{content_role_status:((I=l.value)==null?void 0:I.content_role_status)||N.VIEW})},ue=T=>{T.preventDefault(),T.stopPropagation(),l.value={content_role_status:N.VIEW}},le=async()=>{var M;(await dt({team_member_id:l.value.id,status:l.value.content_role_status||N.VIEW,content_id:(M=S.cardData)==null?void 0:M.id,team_id:y,content_type:"chart"})).code===z.SUCCESS&&(i.value.push(l.value),r.value.splice(r.value.findIndex(I=>I.id===l.value.id),1),l.value={content_role_status:N.VIEW},window.$message.success("添加成功"))},J=async()=>{var M;const T=await gn({content_id:(M=S.cardData)==null?void 0:M.id,content_type:"chart"});if(T.code===z.SUCCESS){const I=[],L=[];T.data.forEach(K=>{var ie;if(K.id===((ie=S.cardData)==null?void 0:ie.user.id)){I.unshift(K);return}if(K.content_role_status!==null){I.push(K);return}L.push(K)}),i.value=I,r.value=L,v.value=!1}},x=async()=>{const T=await pn({teamId:y});T.code===z.SUCCESS&&(r.value=T.data.map(M=>{const I=i.value.findIndex(L=>L.id===M.users.id)!==-1;return Ve(Ie({},M.users),{nickname:I?M.users.nickname+"（已添加）":M.users.nickname,disabled:I})}))};fe(()=>S.modalShow,async T=>{g.value=T,v.value=!0,l.value={content_role_status:N.VIEW},T&&await J()});const se={authorityConfigDesc:e,emit:C,props:S,ChevronDownIcon:f,TrashIcon:d,CloseCircleOutlineIcon:u,systemStore:m,moveTarget:l,userId:h,teamId:y,createUserId:_,showRef:g,infoList:r,userList:i,userListLoading:v,options:A,optionsNum:H,optionsMember:G,renderMoveLabel:U,renderOption:B,handleAddSelect:O,handleSelect:Y,handleMoveSelect:ae,deleteMoveTargetHandle:ue,addNumHandle:le,getMainContentGetContentUserList:J,getTeamUserListInfo:x,closeHandle:()=>{C("update:modalShow",!1)},GoUserAvatar:Je,get NIcon(){return lt}};return Object.defineProperty(se,"__isScriptSetup",{enumerable:!1,value:!0}),se}}),to={style:{"margin-top":"10px"}},no={class:"max-list-box"},oo={key:0,class:"list-box"},ao={key:1,class:"list-box"},so={class:"left"},ro={style:{"font-size":"13px"}},lo={key:0,class:"right"};function io(b,t,a,e,C,S){const f=c("n-divider"),d=c("n-text"),u=c("n-space"),m=c("n-button"),l=c("n-dropdown"),h=c("n-skeleton"),y=c("n-modal");return s(),E(y,{class:"go-coordinate-box go-background-filter",title:"协作管理",preset:"card",size:"small",style:{width:"520px"},show:e.showRef,"onUpdate:show":t[0]||(t[0]=_=>e.showRef=_),"transform-origin":"center",bordered:!0,onAfterLeave:e.closeHandle},{default:n(()=>[o(f,{style:{margin:"4px 0 10px"}}),p("div",null,[a.isManage?(s(),E(d,{key:0,depth:"3",style:{"font-size":"13px"}},{default:n(()=>t[1]||(t[1]=[w("管理协作")])),_:1})):j("",!0),a.isManage?(s(),E(u,{key:1,class:"member-box"},{default:n(()=>{var _;return[o(l,{trigger:"click","key-field":"id","label-field":"nickname","menu-props":()=>({style:{width:"300px"}}),"render-label":e.renderMoveLabel,options:e.infoList,onSelect:e.handleMoveSelect},{default:n(()=>[o(m,{secondary:"",disabled:!e.infoList.length,style:{width:"300px","justify-content":"flex-start"}},{default:n(()=>{var g;return[(g=e.moveTarget)!=null&&g.id?(s(),E(u,{key:0,align:"center","wrap-item":!1,justify:"space-between",style:{width:"300px"}},{default:n(()=>[o(u,{"wrap-item":!1,align:"center"},{default:n(()=>[o(e.GoUserAvatar,{width:22,height:22,avatarUrl:e.moveTarget.avatar},null,8,["avatarUrl"]),o(d,{depth:2,style:{"font-size":"13px"}},{default:n(()=>[w(R(e.moveTarget.nickname),1)]),_:1})]),_:1}),o(e.NIcon,{depth:"3",size:"18",onClick:e.deleteMoveTargetHandle},{default:n(()=>[o(e.CloseCircleOutlineIcon)]),_:1})]),_:1})):(s(),E(u,{key:1},{default:n(()=>[o(d,{depth:3,style:{"font-size":"13px"}},{default:n(()=>[w(R(e.infoList.length?"点击选择人员":"暂无人员可添加"),1)]),_:1})]),_:1}))]}),_:1},8,["disabled"])]),_:1},8,["options"]),o(l,{trigger:"hover",options:e.optionsNum,onSelect:e.handleAddSelect,disabled:!e.infoList.length},{default:n(()=>[o(u,{align:"center"},{default:n(()=>[o(m,{secondary:"",disabled:!e.infoList.length,style:{"justify-content":"flex-start"}},{default:n(()=>[o(d,null,{default:n(()=>{var g;return[w(R((g=e.moveTarget)!=null&&g.content_role_status?e.authorityConfigDesc[e.moveTarget.content_role_status]:"无"),1)]}),_:1}),o(e.NIcon,{style:{position:"relative",top:"2px"}},{default:n(()=>[o(e.ChevronDownIcon)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1},8,["disabled"]),o(m,{type:"primary",disabled:!((_=e.moveTarget)!=null&&_.id),onClick:e.addNumHandle},{default:n(()=>[o(d,null,{default:n(()=>t[2]||(t[2]=[w("添加人员")])),_:1})]),_:1},8,["disabled"])]}),_:1})):j("",!0),p("div",to,[o(d,{depth:"3",style:{"font-size":"13px"}},{default:n(()=>t[3]||(t[3]=[w("协作者列表")])),_:1})]),p("div",no,[e.userListLoading?(s(),k("div",oo,[(s(),k(ee,null,_e(1,_=>o(u,{class:"go-mt-1",justify:"space-between"},{default:n(()=>[o(u,null,{default:n(()=>[o(h,{circle:"",size:"small"}),o(h,{sharp:!1,size:"small",width:300})]),_:1}),o(h,{sharp:!1,size:"small",round:"",width:50})]),_:1})),64))])):(s(),k("div",ao,[(s(!0),k(ee,null,_e(e.userList,(_,g)=>(s(),k("div",{class:"item",key:_.id},[p("div",so,[o(e.GoUserAvatar,{class:"go-mr-3",avatarUrl:_.avatar,circle:!0},null,8,["avatarUrl"]),p("span",ro,R(_.nickname),1),String(_.id)===String(e.userId)?(s(),E(d,{key:0,depth:"3"},{default:n(()=>t[4]||(t[4]=[w("「我」")])),_:1})):j("",!0)]),a.cardData?(s(),k("div",lo,[_.id===a.cardData.user.id?(s(),E(d,{key:0,depth:"3",style:{"font-size":"13px"}},{default:n(()=>t[5]||(t[5]=[w("所有者")])),_:1})):String(_.id)===String(e.userId)&&!a.isTeamCreate&&!a.isTeamManger?(s(),E(d,{key:1},{default:n(()=>[w(R(_.content_role_status?e.authorityConfigDesc[_.content_role_status]:"无"),1)]),_:2},1024)):(s(),E(l,{key:2,trigger:"hover","render-option":e.renderOption,options:a.isManage?e.options:e.optionsMember,onSelect:r=>e.handleSelect(r,_,g)},{default:n(()=>[o(u,{align:"center"},{default:n(()=>[o(d,null,{default:n(()=>[w(R(_.content_role_status?e.authorityConfigDesc[_.content_role_status]:"无"),1)]),_:2},1024),o(e.NIcon,{style:{position:"relative",top:"2px"}},{default:n(()=>[o(e.ChevronDownIcon)]),_:1})]),_:2},1024)]),_:2},1032,["options","onSelect"]))])):j("",!0)]))),128))]))])])]),_:1},8,["show"])}const co=oe(eo,[["render",io],["__scopeId","data-v-64fa4525"],["__file","index.vue"]]),uo=ne({__name:"index",props:{cardData:Object,index:Number},emits:["delete","resize","edit","preview","update","move","export"],setup(b,{expose:t,emit:a}){var ot;t(),We(P=>({"79e20142":ue.value,"53d01c7b":le.value}));const{EllipsisVerticalIcon:e,CopyOutlineIcon:C,TrashOutlineIcon:S,DownloadOutlineIcon:f,PushOutlineIcon:d,BrowsersOutlineIcon:u,LayersOutlineIcon:m,CubeOutlineIcon:l}=ce.ionicons5,{EditIcon:h,PenIcon:y,CarbonSendIcon:_,FolderMoveToIcon:g,GroupIcon:r}=ce.carbon,i=a,v=b,A=ye(),H=me(),G=Ue(),U=String((ot=v.cardData)==null?void 0:ot.user.id)===String(H.getUserInfo.id),B=String(H.getTeamInfo.createUserId)===String(H.getUserInfo.id),O=W(()=>String(H.getTeamInfo.user_role_status)===String(En.MANAGE)),Y=W(()=>{var P;return U||O.value||B||String((P=v.cardData)==null?void 0:P.permissionStatus)===String(N.MANAGE)}),ae=W(()=>{var P;return String((P=v.cardData)==null?void 0:P.permissionStatus)===String(N.EDIT)}),ue=W(()=>G.getAppTheme),le=W(()=>ht(G.getAppTheme,.2)),J=D(!1),x=D(!1),q=pe([{label:"更多",key:"select",icon:de(e)}]),se=pe([{label:"复制",key:"copy",icon:de(C)},{label:"移动",key:"move",icon:de(g)},{label:"重命名",key:"rename",icon:de(y)},{label:"协作管理",key:"coordinate",icon:de(r)},{label:"",type:"divider",key:"d1"},{label:W(()=>{var P;return(P=v.cardData)!=null&&P.release?"取消发布":"发布"}),key:"send",icon:de(_)},{label:"转成模板",key:"template",icon:de(m)},{label:"打包部署",icon:de(l),key:"deploy"},{label:"导出项目",key:"export",icon:de(f)},{label:"上传预览图",key:"upload",icon:de(d)},{type:"divider",key:"d2"},{label:"删除",key:"delete",icon:de(S)}]),T=D(null),M=pe({idEdit:!1,isEnter:!1,newTitle:"",oldTitle:""}),I=P=>{const $=Vt.cloneDeep(P);return H.getTeamInfo.isPersonTeam?$.splice(P.findIndex(ge=>ge.key==="coordinate"),1):U||$.splice(P.findIndex(ge=>ge.key==="template"),1),$},L=P=>{if(!(P==="edit"||P==="preview")&&H.getTeamInfo.expired){window.$message.error("空间所有者的会员已到期，无法使用此功能");return}switch(P){case"edit":he();break;case"preview":ve();break;case"copy":X();break;case"rename":we();break;case"move":V();break;case"coordinate":Z();break;case"download":re();break;case"upload":wn(Pe,[Ce.PNG,Ce.JPEG,Ce.GIF]);break;case"send":je();break;case"template":ke();break;case"delete":De();break;case"deploy":K();break;case"export":ie();break}tt()},K=()=>{J.value=!0},ie=()=>{i("export",v.cardData)},ve=()=>{i("preview",Gt.CHART_PREVIEW_NAME,v.cardData)},De=()=>{i("delete",v.cardData)},he=()=>{i("edit",Ye.CHART_HOME_NAME,v.cardData)},Ee=()=>{i("resize",v.cardData)},we=()=>{var P,$;M.newTitle=((P=v.cardData)==null?void 0:P.title)||"",M.oldTitle=(($=v.cardData)==null?void 0:$.title)||"",M.idEdit=!0,Le(()=>{T.value&&T.value.focus()})},xe=async(P=!1)=>{if(M.isEnter=P,M.idEdit=!1,!M.newTitle.trim()){window.$message.warning("名称不能为空");return}if(M.newTitle!==M.oldTitle&&v.cardData)try{(await qt({projectId:v.cardData.id,projectName:M.newTitle})).code==z.SUCCESS&&(window.$message.success("修改成功"),i("update"))}catch($){window.$message.error("操作失败, 请稍后重试")}},F=()=>{M.isEnter||xe()},V=()=>{i("move",v.cardData)},Z=()=>{x.value=!0},X=async()=>{if(!v.cardData)return;const P=await Kt({projectId:v.cardData.id,teamId:H.getTeamInfo.id});P&&P.code===z.SUCCESS&&(i("update"),window.$message.success("复制成功"))},re=()=>{!v.cardData||!v.cardData.img||vn(v.cardData.img,v.cardData.label,"png")},Pe=async(P,$)=>{try{if(!$||!Cn($,[Ce.PNG,Ce.JPEG,Ce.GIF])||!v.cardData)return;const ge=v.cardData.id,at=`thumbnail/${`thumbnail_${ge}.png`}`;(await(await H.getSTSClient()).putObject({key:at,body:$})).statusCode===200&&Jt({projectId:ge,fileKey:at}).then(ns=>{window.$message.success("上传预览图成功!"),A.emit(Q.PROJECT_GET_DATA)})}catch(ge){console.log(ge)}},je=async()=>{if(!v.cardData)return;const P=await Wt({projectId:v.cardData.id,state:+!v.cardData.release});P&&P.code===z.SUCCESS&&(i("update"),v.cardData.release?window.$message.success("取消发布成功"):window.$message.success("发布成功"))},ke=async()=>{var $;const P=await hn({id:(($=v.cardData)==null?void 0:$.id)||""});P&&P.code===z.SUCCESS&&window.$message.success("操作成功，已添加到模板")},Lt=()=>Xe,He=D(!1),$e=D(0),et=D(0),Mt=P=>{P.preventDefault(),Y.value&&(He.value=!1,Le().then(()=>{He.value=!0,$e.value=P.clientX,et.value=P.clientY}))},tt=()=>{He.value=!1},nt={EllipsisVerticalIcon:e,CopyOutlineIcon:C,TrashOutlineIcon:S,DownloadOutlineIcon:f,PushOutlineIcon:d,BrowsersOutlineIcon:u,LayersOutlineIcon:m,CubeOutlineIcon:l,EditIcon:h,PenIcon:y,CarbonSendIcon:_,FolderMoveToIcon:g,GroupIcon:r,emit:i,props:v,eventBus:A,systemStore:H,designStore:G,isCreate:U,isTeamCreate:B,isTeamManger:O,isManage:Y,isEdit:ae,themeColor:ue,fadeThemeColor:le,deployModal:J,coordinateModalShow:x,fnBtnList:q,selectOptions:se,inputInstRef:T,editNameInfo:M,personTeamHandle:I,handleSelect:L,deployHandle:K,exportHandle:ie,previewHandle:ve,deleteHandle:De,editHandle:he,resizeHandle:Ee,renameHandle:we,saveNewName:xe,blurHandle:F,moveHandle:V,coordinateHandle:Z,copyHandle:X,downloadHandle:re,customRequest:Pe,sendHandle:je,templateHandle:ke,requireErrorImg:Lt,showDropdownRef:He,xRef:$e,yRef:et,handleContextMenu:Mt,onClickoutside:tt,get EditDeploy(){return bn},get GoUserAvatar(){return Je},GoScreenCoordinate:co,get TeamProjectCardPermissionStatusObj(){return Sn}};return Object.defineProperty(nt,"__isScriptSetup",{enumerable:!1,value:!0}),nt}}),mo={key:0,class:"draggable-empty"},_o={class:"list-content"},fo={class:"list-content-img"},go=["src","alt"],po={key:0,class:"list-content-hover go-transition-quick"},vo={class:"go-fs-13"},yo={class:"list-footer",justify:"space-between"},bo={key:0,class:"left"},ho={class:"go-fs-13"},Eo={class:"go-flex-items-center list-footer-ri"},wo={key:0};function Co(b,t,a,e,C,S){var v;const f=c("n-image"),d=c("n-space"),u=c("n-text"),m=c("n-divider"),l=c("n-button"),h=c("n-tooltip"),y=c("n-input"),_=c("n-badge"),g=c("n-dropdown"),r=c("n-card"),i=Yt("draggableDiv");return s(),k(ee,null,[a.cardData?(s(),k("div",{key:0,class:"go-items-list-card",onContextmenu:e.handleContextMenu},[e.isManage?Et((s(),k("div",mo,null,512)),[[i,a.cardData.id]]):j("",!0),o(r,{hoverable:"",size:"small"},{action:n(()=>[p("div",yo,[a.cardData.user?(s(),k("div",bo,[e.systemStore.getTeamInfo.isPersonTeam?j("",!0):(s(),E(h,{key:0,"show-arrow":!1,trigger:"hover"},{trigger:n(()=>[o(l,{class:"avatar disabled-drag",type:"tertiary",secondary:"",circle:"",onClick:t[3]||(t[3]=A=>e.isManage&&(e.coordinateModalShow=!0))},{default:n(()=>[o(e.GoUserAvatar,{avatarUrl:a.cardData.user.avatar,width:24,height:24},null,8,["avatarUrl"])]),_:1})]),default:n(()=>[p("span",ho," 创建人："+R(a.cardData.user.nickname),1)]),_:1})),e.editNameInfo.idEdit?(s(),E(y,{key:1,value:e.editNameInfo.newTitle,"onUpdate:value":t[4]||(t[4]=A=>e.editNameInfo.newTitle=A),valueModifiers:{trim:!0},ref:"inputInstRef",size:"small",type:"text",maxlength:16,placeholder:"输入新名称",onBlur:e.blurHandle,onKeyup:t[5]||(t[5]=qe(A=>e.saveNewName(!0),["enter"]))},null,8,["value"])):(s(),E(u,{key:2,class:"go-ellipsis-1 text disabled-drag go-cursor-pointer",title:a.cardData.title,onDblclick:e.renameHandle},{default:n(()=>[w(R(a.cardData.title||""),1)]),_:1},8,["title"]))])):j("",!0),p("div",Eo,[o(d,{size:4},{default:n(()=>[o(u,null,{default:n(()=>[o(_,{class:"go-animation-twinkle",dot:"",color:a.cardData.release?"#34c749":"#fcbc40",style:{"margin-top":"-3px"}},null,8,["color"]),w(" "+R(a.cardData.release?"发布":"未发布"),1)]),_:1}),e.isManage?(s(),k("div",wo,[(s(!0),k(ee,null,_e(e.fnBtnList,A=>(s(),k(ee,{key:A.key},[A.key==="select"?(s(),E(g,{key:0,trigger:"click",placement:"right-end",options:e.personTeamHandle(e.selectOptions),"show-arrow":!1,onSelect:e.handleSelect},{default:n(()=>[o(l,{quaternary:"",size:"small",focusable:!1,style:{width:"24px"}},{icon:n(()=>[(s(),E(Ke(A.icon)))]),_:2},1024)]),_:2},1032,["options"])):(s(),E(h,{key:1,placement:"bottom",trigger:"hover","show-arrow":!1},{trigger:n(()=>[o(l,{size:"small",quaternary:"",focusable:!1,onClick:H=>e.handleSelect(A.key)},{icon:n(()=>[(s(),E(Ke(A.icon),{onClick:Ne(()=>{},["prevent"])}))]),_:2},1032,["onClick"])]),default:n(()=>[w(" "+R(A.label),1)]),_:2},1024))],64))),128))])):j("",!0)]),_:1})])])]),default:n(()=>{var A;return[p("div",_o,[p("div",fo,[a.cardData.img?(s(),E(f,{key:0,"object-fit":"contain",height:"180","preview-disabled":"","img-props":{draggable:!1},src:`${a.cardData.img}?rdn=${a.cardData.updateAt}`,alt:a.cardData.title,"fallback-src":e.requireErrorImg()},null,8,["src","alt","fallback-src"])):(s(),k("img",{key:1,class:"default-img",src:e.requireErrorImg(),draggable:"false",alt:a.cardData.title},null,8,go))]),e.isManage||(A=e.props.cardData)!=null&&A.permissionStatus?(s(),k("div",po,[o(d,null,{default:n(()=>[p("div",{class:"list-content-btn disabled-drag",onClick:t[0]||(t[0]=H=>e.handleSelect("preview"))},"查 看"),e.isManage||e.isEdit?(s(),k("div",{key:0,class:"list-content-btn list-content-btn-primary disabled-drag",onClick:t[1]||(t[1]=H=>e.handleSelect("edit"))}," 编 辑 ")):j("",!0)]),_:1})])):j("",!0),e.systemStore.getTeamInfo.isPersonTeam?j("",!0):(s(),E(h,{key:1,"show-arrow":!1,trigger:"hover"},{trigger:n(()=>[o(l,{class:"list-avatar right",type:"tertiary",secondary:"",circle:"",title:`创建人: ${a.cardData.user.nickname}`,onClick:t[2]||(t[2]=H=>e.isManage&&(e.coordinateModalShow=!0))},{default:n(()=>[o(u,{class:"go-fs-12",depth:"3"},{default:n(()=>t[8]||(t[8]=[w(" 权限 ")])),_:1}),o(m,{vertical:"",style:{margin:"0 0 0 6px"}}),e.isCreate?(s(),E(l,{key:0,class:"permission",size:"tiny",type:"primary",bordered:!1},{default:n(()=>[o(u,null,{default:n(()=>t[9]||(t[9]=[w(" 创建人 ")])),_:1})]),_:1})):e.isTeamCreate||e.isTeamManger?(s(),E(l,{key:1,class:"permission",type:"primary",size:"tiny",bordered:!1},{default:n(()=>[o(u,{depth:"2"},{default:n(()=>t[10]||(t[10]=[w("空间管理者 ")])),_:1})]),_:1})):(s(),E(l,{key:2,class:ze(["permission",{"self-bg":!e.isManage}]),type:e.isManage?"primary":"",size:"tiny",bordered:!1},{default:n(()=>[o(u,{depth:"2"},{default:n(()=>[w(R(a.cardData.permissionStatus?e.TeamProjectCardPermissionStatusObj[a.cardData.permissionStatus]:"无权限"),1)]),_:1})]),_:1},8,["class","type"]))]),_:1},8,["title"])]),default:n(()=>[p("span",vo,R(e.isManage?"点击配置协作人员":"无配置协作人员权限"),1)]),_:1}))])]}),_:1})],32)):j("",!0),o(g,{trigger:"manual",placement:"bottom-start",options:e.personTeamHandle(e.selectOptions),"show-arrow":!1,x:e.xRef,y:e.yRef,show:e.showDropdownRef,"on-clickoutside":e.onClickoutside,onSelect:e.handleSelect},null,8,["options","x","y","show"]),o(e.EditDeploy,{modalShow:e.deployModal,"onUpdate:modalShow":t[6]||(t[6]=A=>e.deployModal=A),projectId:(v=a.cardData)==null?void 0:v.id,isSvip:e.systemStore.checkSVIP},null,8,["modalShow","projectId","isSvip"]),o(e.GoScreenCoordinate,{modalShow:e.coordinateModalShow,"onUpdate:modalShow":t[7]||(t[7]=A=>e.coordinateModalShow=A),cardData:a.cardData,isManage:e.isManage,isTeamManger:e.isTeamManger,isTeamCreate:e.isTeamCreate},null,8,["modalShow","cardData","isManage","isTeamManger"])],64)}const So=oe(uo,[["render",Co],["__scopeId","data-v-3253eac9"],["__file","index.vue"]]),Do="/static/jpg/6.jpg",xo="/static/jpg/7.jpg",ko=ne({__name:"index",props:{modalShow:{required:!0,type:Boolean},cardData:{required:!0,type:Object}},emits:["close","edit"],setup(b,{expose:t,emit:a}){t();const{PencilIcon:e,CloseIcon:C}=ce.ionicons5,S=D(!1),f=a,d=b;fe(()=>d.modalShow,g=>{S.value=g},{immediate:!0});const u=()=>new URL(Object.assign({"../../../../../assets/images/screen/excellentTemplate/6.jpg":Do,"../../../../../assets/images/screen/excellentTemplate/7.jpg":xo})[`../../../../../assets/images/screen/excellentTemplate/${d.cardData.id}.jpg`],import.meta.url).href,m=pe([{label:"编辑",key:"edit",icon:de(e)}]),l=g=>{switch(g){case"edit":h();break}},h=()=>{f("edit",Ye.CHART_HOME_NAME,d.cardData)},_={PencilIcon:e,CloseIcon:C,showRef:S,emit:f,props:d,requireUrl:u,fnBtnList:m,handleSelect:l,editHandle:h,closeHandle:()=>{f("close")},get defaultItem(){return Xe}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),Io={class:"list-content"},To={class:"go-mr-2"},Fo={class:"list-content-img"},Ao=["src","alt"];function Lo(b,t,a,e,C,S){const f=c("n-text"),d=c("n-space"),u=c("n-icon"),m=c("n-button"),l=c("n-badge"),h=c("n-tooltip"),y=c("n-card"),_=c("n-modal");return s(),E(_,{class:"go-modal-box",show:e.showRef,"onUpdate:show":t[0]||(t[0]=g=>e.showRef=g),onAfterLeave:e.closeHandle},{default:n(()=>[o(y,{hoverable:"",size:"small"},{action:n(()=>[o(d,{class:"list-footer",justify:"space-between"},{default:n(()=>[o(f,{depth:"3"},{default:n(()=>[w(" 更新时间: "+R(a.cardData.updateAt),1)]),_:1}),o(d,null,{default:n(()=>[o(f,null,{default:n(()=>{var g,r;return[o(l,{class:"go-animation-twinkle",dot:"",color:(g=a.cardData)!=null&&g.release?"#34c749":"#fcbc40"},null,8,["color"]),w(" "+R((r=a.cardData)!=null&&r.release?"已发布":"未发布"),1)]}),_:1}),(s(!0),k(ee,null,_e(e.fnBtnList,g=>(s(),E(h,{key:g.key,placement:"bottom",trigger:"hover"},{trigger:n(()=>[o(m,{size:"small",focusable:!1,onClick:r=>e.handleSelect(g.key)},{icon:n(()=>[(s(),E(Ke(g.icon)))]),_:2},1032,["onClick"])]),default:n(()=>[w(" "+R(g.label),1)]),_:2},1024))),128))]),_:1})]),_:1})]),default:n(()=>{var g,r;return[p("div",Io,[o(d,{class:"list-content-top go-px-0",justify:"center"},{default:n(()=>[o(d,null,{default:n(()=>[o(f,null,{default:n(()=>{var i;return[w(R(((i=a.cardData)==null?void 0:i.title)||""),1)]}),_:1})]),_:1})]),_:1}),o(d,{class:"list-content-top",justify:"end"},{default:n(()=>[p("div",To,[o(m,{quaternary:"",size:"small",focusable:!1,onClick:e.closeHandle},{icon:n(()=>[o(u,null,{default:n(()=>[o(e.CloseIcon)]),_:1})]),_:1})])]),_:1}),p("div",Fo,[p("img",{src:((g=a.cardData)==null?void 0:g.img)||e.defaultItem,alt:(r=a.cardData)==null?void 0:r.title},null,8,Ao)])])]}),_:1})]),_:1},8,["show"])}const Mo=oe(ko,[["render",Lo],["__scopeId","data-v-1b7d3987"],["__file","index.vue"]]),Ro=()=>{const b=D(!1),t=D(null),a=me();return{modalData:t,modalShow:b,closeModal:()=>{b.value=!1,t.value=null},resizeHandle:d=>{d&&(b.value=!0,t.value=d)},editHandle:(d,u)=>{if(!u)return;const m=Ge(d,"href"),l=u.teamId||a.getTeamInfo.id;l?Ae(m,[u.id],void 0,!0,{teamId:l}):Ae(m,[u.id],void 0,!0)},previewHandle:(d,u)=>{if(!u)return;const m=Ge(d,"href"),l=Ae(m,[u.id],void 0,!0);l&&(l!=null&&l.window)&&(l.window.go_view_pro_isPreview=!0)}}},Po=ne({__name:"index",props:{modalShow:{required:!0,type:Boolean},cardData:{required:!0,type:Object},isPersonTeam:{required:!1,type:Boolean}},emits:["update:modalShow","removeCard"],setup(b,{expose:t,emit:a}){t();const e=ye(),C=be(),S=W(()=>g.getTeamInfo),f=a,d=b,{AddIcon:u}=ce.ionicons5,m=D(!1),l=D(""),h=D(),y=D(-1),_=Ue(),g=me(),r=D(""),i=D([]),v=D([]),A=W(()=>_.getAppTheme);fe(()=>d.modalShow,x=>{m.value=x,x&&(g.getTeamList.length?i.value=[{type:"my",label:"我的文件",key:"",endDate:g.getMembershipInfo.endDate},{type:"group",label:"空间",key:"people",children:g.getTeamList.map(q=>({type:"group",label:q.team_name,key:q.id,endDate:q.end_date,disabled:!1}))}]:i.value=[{label:"我的文件",key:""}],H())},{immediate:!0});const H=async()=>{const x=C.getHomeSort,{sortKey:q,sortValue:se}=x,T=await xt({sortKey:q,sortValue:se,teamId:l.value});T.code===z.SUCCESS?v.value=T.data.children||[]:(v.value=[],window.$message.error("获取文件夹列表失败，请稍后重试"))},G=async(x,q)=>{l.value=x,h.value=q,y.value=-1,await H()},U=(x,q)=>{x.stopPropagation(),x.preventDefault(),y.value=q},B=()=>{y.value=-1},O=()=>{m.value=!1,l.value="",B(),f("update:modalShow",!1)},J={eventBus:e,projectStore:C,teamInfo:S,emit:f,props:d,AddIcon:u,showRef:m,selectAsideId:l,asideContent:h,selectIndex:y,designStore:_,systemStore:g,createFileName:r,options:i,fileFolderList:v,themeColor:A,fetchFolderList:H,changeMenuHandle:G,selectHandle:U,clickBox:B,closeHandle:O,moveHandle:async()=>{const x=v.value[y.value];(await St({content_type:"chart",folder_id:x?x.id:"",content_id:d.cardData.id,team_id:l.value})).code===z.SUCCESS?(window.$message.success("移动成功"),O(),e.emit(Q.UPDATEFOLDER)):window.$message.error("移动失败，请稍后重试")},handleContextMenu:x=>{x.stopPropagation(),x.preventDefault()},createFileFolder:()=>{r.value="",Se({title:"创建文件夹",positiveText:"创建",closeNegativeText:!0,isMaskClosable:!0,type:Re.INFO,message:()=>te(bt,{placeholder:"请输入文件夹名称",value:r.value,maxlength:45,onUpdateValue:x=>r.value=x,style:{marginTop:"20px"}}),promise:!0,onPositiveCallback:async()=>{if(!r.value)return window.$message.warning("请输入文件夹名称！"),Promise.reject(!1);if(!r.value)return window.$message.warning("请输入文件夹名称！"),!1;try{const x=await Dt({team_id:S.value.id||l.value,folder_name:r.value,content_type:"chart"});if(!x||x.code!==z.SUCCESS){window.$message.error("创建文件夹失败！");return}await H()}catch(x){}}})},renderLabelHandle:x=>x.disabled?te("div",{style:{display:"flex",alignItems:"center"}},[te(Qt,{round:!0,bordered:!1,type:"error",size:"tiny",style:{fontSize:"12px",padding:"10px",marginRight:"6px"}},{default:()=>"过期"}),te("span",{class:"go-ellipsis-1",style:{fontSize:"12px",marginRight:"4px"},title:x.label},x.label)]):te("span",{class:"go-ellipsis-1",style:{fontSize:"13px"}},x.label),get dayjs(){return Ze},get folderLight(){return It},get folderDark(){return Tt},get fade(){return ht}};return Object.defineProperty(J,"__isScriptSetup",{enumerable:!1,value:!0}),J}}),jo={class:"scree-box"},Ho={class:"content-box"},Oo={class:"left-aside"},Bo={class:"top"},No={class:"top-title"},Uo={key:0,class:"top-title"},zo={class:"list"},Vo=["onClick"],Go={class:"file-folder-box"},qo=["src"],Ko={class:"file-folder-list-name"},Jo={class:"file-folder-list-info"},Wo={class:"bottom"};function Yo(b,t,a,e,C,S){const f=c("n-divider"),d=c("n-menu"),u=c("n-text"),m=c("n-icon"),l=c("n-button"),h=c("n-ellipsis"),y=c("n-modal");return s(),E(y,{class:"go-move-scree-model go-background-filter",title:`移动文件「${a.cardData.title}」`,preset:"card",size:"small",style:{width:"900px"},show:e.showRef,"onUpdate:show":t[0]||(t[0]=_=>e.showRef=_),"transform-origin":"center",bordered:!0,"content-style":"padding: 0 0 10px;",onAfterLeave:e.closeHandle},{default:n(()=>{var _,g;return[o(f,{style:{"margin-top":"4px","margin-bottom":"0"}}),p("div",jo,[p("div",Ho,[p("div",Oo,[o(d,{options:e.options,indent:16,value:e.selectAsideId,style:{width:"158px"},"default-value":"0","render-label":e.renderLabelHandle,"onUpdate:value":e.changeMenuHandle},null,8,["options","value"])]),o(f,{vertical:"",style:{height:"470px",margin:"0"}}),p("div",{class:"right-box",onClick:e.clickBox},[p("div",Bo,[o(u,{class:"top-desc",depth:3},{default:n(()=>t[1]||(t[1]=[w("移动到")])),_:1}),p("span",No,R(((_=e.asideContent)==null?void 0:_.label)||"全部项目")+" "+R(e.selectAsideId),1),e.selectIndex!==-1?(s(),k("span",Uo,"/ "+R((g=e.fileFolderList[e.selectIndex])==null?void 0:g.folder_name),1)):j("",!0)]),p("div",zo,[p("div",{class:"create-folder",onClick:e.createFileFolder},[o(l,{text:"",type:"primary"},{default:n(()=>[o(m,{size:26},{default:n(()=>[o(e.AddIcon)]),_:1})]),_:1}),o(l,{text:"",type:"primary"},{default:n(()=>t[2]||(t[2]=[p("span",{depth:3,style:{"font-size":"13px","font-weight":"bolder"}},"新增文件夹",-1)])),_:1})]),(s(!0),k(ee,null,_e(e.fileFolderList,(r,i)=>(s(),k("div",{class:ze(["file-folder-list-item go-transition-quick",{actived:e.selectIndex===i}]),key:r.id,style:Zt({borderColor:e.selectIndex===i?e.themeColor:"",backgroundColor:e.selectIndex===i?e.fade(e.themeColor,.85):""}),onClick:v=>e.selectHandle(v,i),onContextmenu:e.handleContextMenu},[p("div",Go,[p("img",{class:"file-folder-box-svg",src:e.designStore.getDarkTheme?e.folderDark:e.folderLight},null,8,qo),p("div",Ko,[o(h,{style:{"max-width":"140px"}},{default:n(()=>[o(u,{class:"num",depth:3},{default:n(()=>[w(R(r.total?`+${r.total}`:"[空]"),1)]),_:2},1024)]),_:2},1024)])]),p("div",Jo,[o(u,{depth:3},{default:n(()=>[w(R(r.folder_name),1)]),_:2},1024),o(u,{class:"file-folder-list-text",depth:3},{default:n(()=>[w(R(e.dayjs(r.createdAt).format("YYYY-MM-DD HH:mm:ss")),1)]),_:2},1024)])],46,Vo))),128))])])]),o(f,{style:{margin:"0"}}),p("div",Wo,[o(l,{class:"move-btn",focusable:!1,onClick:e.closeHandle},{default:n(()=>[o(u,null,{default:n(()=>t[3]||(t[3]=[w("取消")])),_:1})]),_:1}),o(l,{class:"move-btn go-ml-3",type:"primary",focusable:!1,onClick:e.moveHandle},{default:n(()=>[o(u,null,{default:n(()=>t[4]||(t[4]=[w("移动")])),_:1})]),_:1})])])]}),_:1},8,["title","show"])}const Qo=oe(Po,[["render",Yo],["__scopeId","data-v-55ab44d6"],["__file","index.vue"]]),ut=1,mt=9999,Zo=ne({__name:"index",setup(b,{expose:t}){t();const{modalData:a,modalShow:e,closeModal:C,resizeHandle:S,editHandle:f,previewHandle:d}=Ro(),u=me(),m=be(),l=W(()=>u.getTeamInfo),h=D([]),y=D(!1),_=D(!0),g=D({}),r=async(B=()=>{})=>{const O=m.getHomeSort,{sortKey:Y,sortValue:ae}=O,ue=l.value.id,le=u.currentFolderId;_.value=!0;const{data:J}=await wt({page:ut,pageSize:mt,sortKey:Y,sortValue:ae,teamId:ue,folderId:le});if(!J){_.value=!1,h.value=[],B&&B();return}const{data:x,pageNum:q,projectCount:se,projectLimitCount:T,permissionStatus:M}=J;_.value=!1,u.setProjectLimitItem(se,T),h.value=[],x&&x.length&&x.forEach(I=>{const L={id:I.id,title:I.projectName,label:I.projectName,release:I.state,img:I.thumbnail,updateAt:Ze(I.updateAt).format("YYYY-MM-DD HH:mm:ss"),user:I==null?void 0:I.User,teamId:I.team_id,permissionStatus:M[I.id]};h.value.push(L)}),B&&B()},i=async B=>{Se({type:Re.DELETE,promise:!0,onPositiveCallback:async()=>{const O=l.value.id;return await Ct({content_id:B,team_id:O})},promiseResCallback:O=>{O.code===z.SUCCESS&&(window.$message.success("删除成功"),r())}})},v=B=>{const{id:O}=B,Y=h.value.findIndex(ae=>ae.id===O);h.value.splice(Y,1)},A=B=>{g.value=B,y.value=!0},H=async B=>{const O=await Xt({projectId:B.id});if(O.code===z.SUCCESS)try{if(O.data.content=$t.decompress(O.data.content),O.data.content.startsWith("http")){window.OSSProjectURL=O.data.content;try{O.data.content=(await en.get(O.data.content,{responseType:"text"})).data}catch(Y){O.data.content=""}}yn(O.data.content,B.title,"json")}catch(Y){window.$message.error("导出失败，请稍后重试")}else window.$message.error("导出失败，请稍后重试")},G=ye();Me(()=>{G.on(Q.PROJECT_GET_DATA,(B={})=>{r(B.callback)})}),Qe(()=>{G.off(Q.PROJECT_GET_DATA)});const U={modalData:a,modalShow:e,closeModal:C,resizeHandle:S,editHandle:f,previewHandle:d,systemStore:u,projectStore:m,teamInfo:l,list:h,page:ut,pageSize:mt,moveScreenModelRef:y,loading:_,cardDataObject:g,getListData:r,deleteHandle:i,removeCardHandle:v,moveHandle:A,exportHandle:H,eventBus:G,get ProjectItemsCard(){return So},get ProjectItemsModalCard(){return Mo},get MoveScreenModel(){return Qo}};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),Xo={class:"go-items-list"},$o={key:0,class:"loading-box"},ea={key:2,class:"go-flex-center go-mt-3"};function ta(b,t,a,e,C,S){const f=c("n-grid-item"),d=c("n-grid"),u=c("n-spin"),m=c("n-text"),l=c("n-space");return s(),k(ee,null,[p("div",Xo,[o(d,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:3 xl:4 xxl:4",responsive:"screen"},{default:n(()=>[(s(!0),k(ee,null,_e(e.list,(h,y)=>(s(),E(f,{key:h.id},{default:n(()=>[o(e.ProjectItemsCard,{cardData:h,index:y,onResize:e.resizeHandle,onDelete:_=>e.deleteHandle(h.id),onEdit:e.editHandle,onPreview:e.previewHandle,onMove:e.moveHandle,onExport:e.exportHandle,onUpdate:t[0]||(t[0]=_=>e.getListData())},null,8,["cardData","index","onResize","onDelete","onEdit","onPreview"])]),_:2},1024))),128))]),_:1}),e.loading?(s(),k("div",$o,[o(u,{size:"large"})])):j("",!0),!e.loading&&!e.list.length?(s(),E(l,{key:1,justify:"center",style:{"margin-top":"100px","user-select":"none"}},{default:n(()=>[o(m,{depth:"3"},{default:n(()=>t[2]||(t[2]=[w("暂无项目，可用过【创建】或【导入】方式新增项目")])),_:1})]),_:1})):j("",!0),e.list.length>12?(s(),k("div",ea,[o(m,{depth:3},{default:n(()=>t[3]||(t[3]=[w("已经到底部啦~")])),_:1})])):j("",!0)]),e.modalData?(s(),E(e.ProjectItemsModalCard,{key:0,modalShow:e.modalShow,cardData:e.modalData,onClose:e.closeModal,onEdit:e.editHandle},null,8,["modalShow","cardData","onClose","onEdit"])):j("",!0),o(e.MoveScreenModel,{modalShow:e.moveScreenModelRef,"onUpdate:modalShow":t[1]||(t[1]=h=>e.moveScreenModelRef=h),cardData:e.cardDataObject,isPersonTeam:e.systemStore.getTeamInfo.isPersonTeam,onRemoveCard:e.removeCardHandle},null,8,["modalShow","cardData","isPersonTeam"])],64)}const na=oe(Zo,[["render",ta],["__scopeId","data-v-bf4f60c8"],["__file","index.vue"]]),oa=ne({__name:"index",props:{cardData:Object,index:Number},emits:["delete","restore","update"],setup(b,{expose:t,emit:a}){t();const e=b,C=a,{EllipsisVerticalIcon:S,RefreshIcon:f,TrashOutlineIcon:d}=ce.ionicons5,{EditIcon:u}=ce.carbon,m=D(!1),l=()=>Xe,h=()=>{C("delete",e.cardData)},y=me(),_=W(()=>y.getTeamInfo),r={props:e,emit:C,EllipsisVerticalIcon:S,RefreshIcon:f,TrashOutlineIcon:d,EditIcon:u,restoreLoading:m,requireErrorImg:l,deleteHandle:h,systemStore:y,teamInfo:_,restoreHandle:()=>{var i;m.value=!0,tn({id:((i=e.cardData)==null?void 0:i.id)||"",teamId:_.value.id}).then(v=>{C("update"),m.value=!1,!(!v||v.code!==z.SUCCESS)&&window.$message.success("操作成功")})}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),aa={key:0,class:"go-items-list-card"},sa={class:"list-content"},ra={class:"list-content-img"},la=["src"],ia={class:"go-flex-items-center list-footer",justify:"space-between"},da={class:"go-flex-items-center list-footer-ri"};function ca(b,t,a,e,C,S){const f=c("n-image"),d=c("n-text"),u=c("n-icon"),m=c("n-button"),l=c("n-tooltip"),h=c("n-space"),y=c("n-card");return a.cardData?(s(),k("div",aa,[o(y,{hoverable:"",size:"small"},{action:n(()=>[p("div",ia,[o(d,{class:"go-ellipsis-1",title:a.cardData.title},{default:n(()=>[w(R(a.cardData.title||""),1)]),_:1},8,["title"]),p("div",da,[o(h,null,{default:n(()=>[o(l,{trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:n(()=>[o(m,{text:"",loading:e.restoreLoading,focusable:!1,onClick:e.restoreHandle},{icon:n(()=>[o(u,null,{default:n(()=>[o(e.RefreshIcon)]),_:1})]),_:1},8,["loading"])]),default:n(()=>[t[0]||(t[0]=w(" 恢复 "))]),_:1}),o(l,{trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:n(()=>[o(m,{text:"",focusable:!1,onClick:e.deleteHandle},{icon:n(()=>[o(u,null,{default:n(()=>[o(e.TrashOutlineIcon)]),_:1})]),_:1})]),default:n(()=>[t[1]||(t[1]=w(" 彻底删除 "))]),_:1})]),_:1})])])]),default:n(()=>[p("div",sa,[p("div",ra,[a.cardData.img?(s(),E(f,{key:0,"object-fit":"contain",height:"120","preview-disabled":"",src:`${a.cardData.img}?rdn=${a.cardData.updateAt}`,alt:a.cardData.title,"fallback-src":e.requireErrorImg()},null,8,["src","alt","fallback-src"])):(s(),k("img",{key:1,class:"default-img",src:e.requireErrorImg(),alt:"cardData.title"},null,8,la))])])]),_:1})])):j("",!0)}const ua=oe(oa,[["render",ca],["__scopeId","data-v-3584c524"],["__file","index.vue"]]),_t=1,ft=9999,ma=ne({__name:"index",setup(b,{expose:t}){t();const a=()=>{},e=me(),C=be(),S=W(()=>e.getTeamInfo),f=D([]),d=D(!0),u=y=>{const _=y.id;Se({type:Re.DELETE,promise:!0,onPositiveCallback:async()=>{const g=S.value.id;return await Ct({content_id:_,clear:!0,team_id:g})},promiseResCallback:g=>{g.code===z.SUCCESS&&(m(),window.$message.success("删除成功"))}})},m=async(y=()=>{})=>{const _=C.getHomeSort,{sortKey:g,sortValue:r}=_,i=S.value.id;d.value=!0;const{data:v}=await wt({dustbin:!0,page:_t,pageSize:ft,sortKey:g,sortValue:r,teamId:i});if(d.value=!1,!v){f.value=[],y&&y();return}const{data:A,pageNum:H,count:G}=v;f.value=[],A&&A.length&&A.forEach(U=>{const B={id:U.id,title:U.projectName,label:U.projectName,release:U.state,img:U.thumbnail,updateAt:U.updateAt};f.value.push(B)}),y&&y()};e.setItem(Be.CURRENTFOLDERID,"");const l=ye();Me(()=>{l.on(Q.PROJECT_GET_DATA,(y={})=>{m(y.callback)})}),Qe(()=>{l.off(Q.PROJECT_GET_DATA)});const h={restoreHandle:a,systemStore:e,projectStore:C,teamInfo:S,list:f,page:_t,pageSize:ft,loading:d,deleteHandle:u,getListData:m,eventBus:l,get ProjectItemsCard(){return ua},FolderFiles:Ft};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),_a={key:0,class:"loading-box"},fa={class:"go-mt-3"},ga={class:"go-flex-center",style:{"margin-top":"20px"}};function pa(b,t,a,e,C,S){const f=c("n-spin"),d=c("n-text"),u=c("n-grid-item"),m=c("n-grid"),l=c("n-space");return s(),k(ee,null,[e.loading?(s(),k("div",_a,[o(f,{size:"large"})])):j("",!0),Et(p("div",null,[e.list.length||e.systemStore.fileFolderList.length?(s(),E(d,{key:0,class:"top-tip",depth:"3"},{default:n(()=>t[1]||(t[1]=[w(" 注意：回收站数据仅保留七天 ")])),_:1})):j("",!0),p("div",fa,[o(e.FolderFiles,{isRecycle:!0})]),p("div",ga,[e.list.length?(s(),E(m,{key:0,"x-gap":20,"y-gap":20,cols:"2 s:3 m:3 l:4 xl:5 xxl:6",responsive:"screen"},{default:n(()=>[(s(!0),k(ee,null,_e(e.list,(h,y)=>(s(),E(u,{key:h.id},{default:n(()=>[o(e.ProjectItemsCard,{cardData:h,index:y,onDelete:e.deleteHandle,onRestore:e.restoreHandle,onUpdate:t[0]||(t[0]=_=>e.getListData())},null,8,["cardData","index"])]),_:2},1024))),128))]),_:1})):j("",!0),!e.loading&&!e.list.length&&!e.systemStore.fileFolderList.length?(s(),E(l,{key:1,vertical:"",style:{"margin-top":"100px","user-select":"none"}},{default:n(()=>[o(d,{depth:"3",style:{"font-size":"16px"}},{default:n(()=>t[2]||(t[2]=[w("暂无大屏项目回收数据")])),_:1})]),_:1})):j("",!0)])],512),[[nn,!e.loading]])],64)}const va=oe(ma,[["render",pa],["__scopeId","data-v-8229c5d3"],["__file","index.vue"]]),ya=ne({__name:"index",props:{cardData:Object,index:Number},emits:["delete","restore"],setup(b,{expose:t,emit:a}){t();const e=D(window.__PRIVATE_MODULE__.MemberPoint),C=b,S=a,{EllipsisVerticalIcon:f,RefreshIcon:d,TrashOutlineIcon:u}=ce.ionicons5,{EditIcon:m}=ce.carbon,l=D(!1),g={isPrivateMemberPoint:e,props:C,emit:S,EllipsisVerticalIcon:f,RefreshIcon:d,TrashOutlineIcon:u,EditIcon:m,restoreLoading:l,requireErrorImg:()=>Dn,deleteHandle:()=>{S("delete")},restoreHandle:async()=>{var i;l.value=!0,(await on({id:((i=C.cardData)==null?void 0:i.id)||""})).code===z.SUCCESS?(S("restore"),l.value=!1,window.$message.success("还原成功")):window.$message.error("操作失败，请稍后重试！")}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),ba={key:0,class:"go-items-list-card"},ha={class:"list-content"},Ea={class:"list-content-img"},wa=["src"],Ca={class:"go-flex-items-center list-footer",justify:"space-between"},Sa={class:"go-flex-items-center list-footer-ri"},Da={key:0,class:"points-tip"},xa={class:"go-pl-1"};function ka(b,t,a,e,C,S){const f=c("n-image"),d=c("n-text"),u=c("n-tag"),m=c("n-tooltip"),l=c("n-icon"),h=c("n-button"),y=c("n-card");return a.cardData?(s(),k("div",ba,[o(y,{hoverable:"",size:"small"},{action:n(()=>[p("div",Ca,[o(d,{class:"go-ellipsis-1",title:a.cardData.title},{default:n(()=>[w(R(a.cardData.title||""),1)]),_:1},8,["title"]),p("div",Sa,[e.isPrivateMemberPoint?j("",!0):(s(),k("span",Da,[a.cardData.points===0?(s(),E(u,{key:0,class:"tag",size:"small",bordered:!1},{default:n(()=>t[0]||(t[0]=[p("span",null,"免费",-1)])),_:1})):(s(),E(m,{key:1,trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:n(()=>[o(u,{class:"tag",size:"small",bordered:!1,type:"primary"},{default:n(()=>[t[1]||(t[1]=p("img",{src:xn,alt:"",style:{position:"relative",top:"4px",height:"16px"}},null,-1)),p("span",xa,R(a.cardData.points),1)]),_:1})]),default:n(()=>[w(" "+R(a.cardData.points)+" 积分 ",1)]),_:1}))])),o(m,{trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:n(()=>[o(h,{text:"",loading:e.restoreLoading,focusable:!1,onClick:e.restoreHandle},{icon:n(()=>[o(l,null,{default:n(()=>[o(e.RefreshIcon)]),_:1})]),_:1},8,["loading"])]),default:n(()=>[t[2]||(t[2]=w(" 恢复 "))]),_:1}),o(m,{trigger:"hover",placement:"bottom","show-arrow":!1},{trigger:n(()=>[o(h,{text:"",focusable:!1,onClick:e.deleteHandle},{icon:n(()=>[o(l,null,{default:n(()=>[o(e.TrashOutlineIcon)]),_:1})]),_:1})]),default:n(()=>[t[3]||(t[3]=w(" 彻底删除 "))]),_:1})])])]),default:n(()=>[p("div",ha,[p("div",Ea,[a.cardData.thumbnail?(s(),E(f,{key:0,"object-fit":"contain",height:"120","preview-disabled":"",src:`${a.cardData.thumbnail}?rdn=${a.cardData.updateAt}`,alt:a.cardData.title,"fallback-src":e.requireErrorImg()},null,8,["src","alt","fallback-src"])):(s(),k("img",{key:1,class:"default-img",src:e.requireErrorImg(),alt:"cardData.title"},null,8,wa))])])]),_:1})])):j("",!0)}const Ia=oe(ya,[["render",ka],["__scopeId","data-v-e9af0768"],["__file","index.vue"]]),gt=D(0),pt=D([]),Oe=D(!1),vt=D(!1),yt=D(12),Ta=(b=300)=>(pt.value=[],gt.value=0,Oe.value=!1,vt.value=!1,yt.value=an(b),{list:pt,page:gt,pageSize:yt,bottom:Oe,inBottom:vt,handleScroll:a=>{a<b?Oe.value=!0:Oe.value=!1}}),Fa=ne({__name:"index",setup(b,{expose:t}){t();const a=be(),{bottom:e,list:C,inBottom:S,page:f,pageSize:d}=Ta(),u=D(!0),m=pe({sortKey:"updateAt",sortValue:"desc"}),l=i=>{C.value.splice(i,1)},h=me(),y=W(()=>h.getTeamInfo),_=async()=>{u.value=!0;const i=a.getHomeSort,{sortKey:v,sortValue:A}=i,H=y.value.id,G=await sn({sortKey:v,sortValue:A,dustbin:!0,page:f.value,pageSize:d.value,teamId:H});u.value=!1,G.code===z.SUCCESS&&(G.data.data.length===0||G.data.data.length<d.value?S.value=!0:S.value=!1,C.value.push(...G.data.data))},g=(i,v)=>{const A=i.id;Se({type:Re.DELETE,promise:!0,onPositiveCallback:async()=>await rn({id:A,clear:!0}),promiseResCallback:H=>{H.code===z.SUCCESS&&(C.value.splice(v,1),window.$message.success("删除成功"))}})};fe(()=>a.getHomeSort,i=>{m.sortKey=i.sortKey,m.sortValue=i.sortValue,f.value=1,C.value=[],_()},{immediate:!0}),Me(()=>{fe(()=>e.value,i=>{if(i){if(f.value+=1,S.value)return;_()}})});const r={projectStore:a,bottom:e,list:C,inBottom:S,page:f,pageSize:d,fetchDataLoading:u,homeSort:m,restoreHandle:l,systemStore:h,teamInfo:y,getListData:_,deleteHandle:g,get ItemsCard(){return Ia}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),Aa={class:"go-collection-depot"},La={key:0,class:"loading-box"},Ma={class:"go-flex-center"};function Ra(b,t,a,e,C,S){const f=c("n-spin"),d=c("n-grid-item"),u=c("n-grid"),m=c("n-text"),l=c("n-space");return s(),k("div",Aa,[e.fetchDataLoading?(s(),k("div",La,[o(f,{size:"large"})])):j("",!0),e.list.length?(s(),E(u,{key:1,"x-gap":20,"y-gap":20,cols:"2 s:3 m:3 l:4 xl:5 xxl:6",responsive:"screen"},{default:n(()=>[(s(!0),k(ee,null,_e(e.list,(h,y)=>(s(),E(d,{key:h.id},{default:n(()=>[o(e.ItemsCard,{cardData:h,index:y,onDelete:_=>e.deleteHandle(h,y),onRestore:_=>e.restoreHandle(y)},null,8,["cardData","index","onDelete","onRestore"])]),_:2},1024))),128))]),_:1})):j("",!0),p("div",Ma,[!e.list.length&&!e.fetchDataLoading?(s(),E(l,{key:0,vertical:"",style:{"margin-top":"100px","user-select":"none"}},{default:n(()=>[o(m,{depth:"3",style:{"font-size":"16px"}},{default:n(()=>t[0]||(t[0]=[w("暂无自定义组件回收数据")])),_:1})]),_:1})):j("",!0)])])}const Pa=oe(Fa,[["render",Ra],["__scopeId","data-v-909845df"],["__file","index.vue"]]),ja=ne({__name:"remoteRecycle",setup(b,{expose:t}){t();const a={get Depot(){return Pa}};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),Ha={class:"go-remote-component"};function Oa(b,t,a,e,C,S){return s(),k("div",Ha,[o(e.Depot)])}const Ba=oe(ja,[["render",Oa],["__file","remoteRecycle.vue"]]),Na=ne({__name:"screenAndComDepot",setup(b,{expose:t}){t();const e={tabs:D("project"),ItemDepot:va,RemoteRecycle:Ba};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}});function Ua(b,t,a,e,C,S){const f=c("n-tab"),d=c("n-tabs");return s(),k(ee,null,[o(d,{value:e.tabs,"onUpdate:value":t[0]||(t[0]=u=>e.tabs=u),class:"depot-box",type:"segment",animated:"",size:"small"},{default:n(()=>[o(f,{name:"project"},{default:n(()=>t[1]||(t[1]=[w(" 大屏项目 ")])),_:1}),o(f,{name:"component"},{default:n(()=>t[2]||(t[2]=[w(" 自定义组件 ")])),_:1})]),_:1},8,["value"]),e.tabs==="project"?(s(),E(e.ItemDepot,{key:0})):(s(),E(e.RemoteRecycle,{key:1}))],64)}const za=oe(Na,[["render",Ua],["__scopeId","data-v-4ca8c155"],["__file","screenAndComDepot.vue"]]);var At=(b=>(b.PROJECT="project",b.COMPONENT="component",b.MODEL="model",b.DATABASE="database",b.DEPOT="depot",b.MEMBER="member",b.SETTING="setting",b))(At||{});const Va=ne({__name:"index",setup(b,{expose:t}){t();const a=Fe(()=>Te(()=>import("./remoteItem-CnFXa94E.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]))),e=Fe(()=>Te(()=>import("./index-BfRCj20m.js"),__vite__mapDeps([35,1,2,4,5,6,3,12,10,13,14,15,7,16,17,18,19,20,21,22,8,23,24,25,26,27,28,29,30,11,31,36,33,34]))),C=Fe(()=>Te(()=>import("./memberProject-BCeR5DAx.js"),__vite__mapDeps([37,1,2,23,5,6,4,29,30,10,38,33,34]))),S=Fe(()=>Te(()=>import("./settingProject-BN-52te6.js"),__vite__mapDeps([39,1,2,23,4,6,29,30,40,33,34]))),f=Fe(()=>Te(()=>import("./index-B86jA8o9.js"),__vite__mapDeps([41,1,2,5,6,4,42,43,44,10,29,30,45,33,34,46,47,3,13,14,15,7,16,17,18,19,20,21,22,8,23,24,25,12,26,27,28,11,31,48]))),{SortAscendingIcon:d,SortDescendingIcon:u}=ce.carbon,{ChevronDownIcon:m,ChevronBackIcon:l,InfiniteIcon:h}=ce.ionicons5,y=ye(),_=me(),g=be(),r=ln("history",{write:!0}),i=r.tabKey,v=D(i||"project"),A=W(()=>_.getTeamInfo.isPersonTeam),H=W(()=>{const L=_.fileFolderList,K=_.currentFolderId;return L.find(ie=>ie.id===K)}),G=(L="")=>{_.setItem(Be.CURRENTFOLDERID,L),y.emit(Q.UPDATEFOLDER)},U=()=>{g.setItem(dn.HOME_SORT,{sortKey:B.value,sortValue:O.value})},B=D("updateAt"),O=D("desc");U();const Y={updateAt:"更新时间",createdAt:"创建时间"},ae=[{type:"group",label:"排序方式",key:"sort",children:[{label:Y.updateAt,key:"updateAt"},{label:Y.createdAt,key:"createdAt"}]}],ue=L=>{B.value=L,U()},le=()=>{O.value=O.value==="asc"?"desc":"asc",U()},J=D(""),x=(L,K)=>{J.value=K,L.preventDefault()},q=D();y.on(Q.FILEDRAGEND,async({id:L,target:K})=>{if(!q.value||!q.value.contains(K))return;const ie=J.value;y.emit(Q.MOVEFILETOFOLDER,{folderId:ie,contentId:L,teamId:_.getTeamInfo.id})});const se=()=>{y.emit(Q.OPEN_UPGRADE_MEMBER)},T=L=>{!L||r.tabKey===L||(v.value=L,history.pushState(Ie({},r),"",window.location.href),Le(()=>{r.tabKey=L,history.pushState(Ie({},r),"",window.location.href)}))},M=W(()=>it());fe(()=>_.getTeamInfo.id,()=>{T("project")}),fe(()=>r,L=>{const K=L.tabKey||"project";T(K)}),Me(()=>{it()});const I={RemoteItem:a,MyModel:e,TeamMember:C,TeamSetting:S,DataBaseList:f,TabsEnum:At,SortAscendingIcon:d,SortDescendingIcon:u,ChevronDownIcon:m,ChevronBackIcon:l,InfiniteIcon:h,eventBus:y,systemStore:_,projectStore:g,params:r,tabKey:i,tabs:v,isPersonTeam:A,getCurrentFolder:H,changeCurrentFolder:G,updateHomeSortData:U,selectValue:B,sort:O,suffixObj:Y,suffixOptions:ae,handleSelect:ue,sortHandle:le,dragActived:J,dragenterFn:x,breadcrumbBox:q,upgradeClick:se,changeTabHandle:T,canUse:M,CreateBox:Bn,FolderFiles:Ft,get ProjectItemsList(){return na},ScreenAndComDepot:za};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),Ga={class:"header-box"},qa={class:"header-box-left",ref:"breadcrumbBox"},Ka={class:"header-box-right"},Ja={class:"team-header-tips"},Wa={class:"files-num"},Ya={key:0},Qa={key:1};function Za(b,t,a,e,C,S){const f=c("n-icon"),d=c("n-breadcrumb-item"),u=c("n-breadcrumb"),m=c("n-tab"),l=c("n-divider"),h=c("n-tabs"),y=c("n-button"),_=c("n-dropdown"),g=c("n-tooltip"),r=c("n-text"),i=c("n-space");return s(),k("div",{class:"go-project-item-box",onContextmenu:t[4]||(t[4]=Ne(()=>{},["prevent"]))},[p("div",Ga,[p("div",qa,[e.getCurrentFolder?(s(),E(u,{key:0},{default:n(()=>[o(d,{onClick:t[0]||(t[0]=v=>e.changeCurrentFolder()),onDragover:t[1]||(t[1]=Ne(v=>{e.dragenterFn(v,"")},["stop"]))},{default:n(()=>[o(f,{depth:"2",size:"16",style:{"margin-right":"4px"}},{default:n(()=>[o(e.ChevronBackIcon)]),_:1}),t[5]||(t[5]=p("span",null,"全部项目",-1))]),_:1}),o(d,null,{default:n(()=>[w(R(e.getCurrentFolder.folder_name),1)]),_:1})]),_:1})):(s(),E(h,{key:1,class:"project-tab",value:e.tabs,"onUpdate:value":[t[2]||(t[2]=v=>e.tabs=v),t[3]||(t[3]=v=>{e.changeTabHandle(v)})]},{default:n(()=>[o(m,{name:e.TabsEnum.PROJECT},{default:n(()=>t[6]||(t[6]=[w(" 项目 ")])),_:1},8,["name"]),o(m,{name:e.TabsEnum.COMPONENT},{default:n(()=>t[7]||(t[7]=[w(" 组件 ")])),_:1},8,["name"]),o(m,{name:e.TabsEnum.MODEL},{default:n(()=>t[8]||(t[8]=[w(" 3D 模型 ")])),_:1},8,["name"]),o(m,{name:e.TabsEnum.DATABASE},{default:n(()=>t[9]||(t[9]=[w(" 数据中心 ")])),_:1},8,["name"]),o(m,{name:e.TabsEnum.DEPOT},{default:n(()=>t[10]||(t[10]=[w(" 回收站 ")])),_:1},8,["name"]),e.isPersonTeam?j("",!0):(s(),E(m,{key:0,name:e.TabsEnum.DEPOT},{default:n(()=>[o(l,{vertical:"",style:{height:"20px",margin:"0",cursor:"default"}})]),_:1},8,["name"])),e.isPersonTeam?j("",!0):(s(),E(m,{key:1,name:e.TabsEnum.MEMBER},{default:n(()=>t[11]||(t[11]=[w(" 成员 ")])),_:1},8,["name"])),e.isPersonTeam?j("",!0):(s(),E(m,{key:2,name:e.TabsEnum.SETTING},{default:n(()=>t[12]||(t[12]=[w(" 设置 ")])),_:1},8,["name"]))]),_:1},8,["value"]))],512),p("div",Ka,[p("div",Ja,[t[13]||(t[13]=p("span",null,"「当前创建项目数",-1)),p("span",Wa,R(e.systemStore.currentProjectLimit.projectCount),1),t[14]||(t[14]=p("span",{class:"go-mx-1"}," / ",-1)),p("span",null,R(e.systemStore.currentProjectLimit.projectLimitCount),1),t[15]||(t[15]=p("span",null,"」",-1))]),o(_,{options:e.suffixOptions,onSelect:e.handleSelect},{default:n(()=>[o(y,{"icon-placement":"right",quaternary:"",size:"small",focusable:!1},{icon:n(()=>[o(f,{depth:"3",size:"16"},{default:n(()=>[o(e.ChevronDownIcon)]),_:1})]),default:n(()=>[w(R(e.suffixObj[e.selectValue])+" ",1)]),_:1})]),_:1}),o(g,{placement:"bottom",trigger:"hover","show-arrow":!1},{trigger:n(()=>[o(y,{class:"go-ml-1",quaternary:"",focusable:!1,size:"small",onClick:e.sortHandle},{icon:n(()=>[o(f,{size:"16"},{default:n(()=>[e.sort==="asc"?(s(),E(e.SortAscendingIcon,{key:0})):(s(),E(e.SortDescendingIcon,{key:1}))]),_:1})]),_:1})]),default:n(()=>[p("span",null,R(e.sort==="desc"?"倒序":"正序"),1)]),_:1})])]),o(l,{style:{"margin-top":"18px"}}),e.canUse?(s(),k("div",Ya,[e.tabs===e.TabsEnum.PROJECT?(s(),k(ee,{key:0},[o(e.CreateBox,{getCurrentFolder:!!e.getCurrentFolder},null,8,["getCurrentFolder"]),o(e.FolderFiles,{style:{"margin-top":"20px"}}),o(e.ProjectItemsList)],64)):e.tabs===e.TabsEnum.COMPONENT?(s(),E(e.RemoteItem,{key:1})):e.tabs===e.TabsEnum.MODEL?(s(),E(e.MyModel,{key:2})):e.tabs===e.TabsEnum.DATABASE?(s(),E(e.DataBaseList,{key:3})):e.tabs===e.TabsEnum.DEPOT?(s(),E(e.ScreenAndComDepot,{key:4})):e.tabs===e.TabsEnum.MEMBER?(s(),E(e.TeamMember,{key:5})):e.tabs===e.TabsEnum.SETTING?(s(),E(e.TeamSetting,{key:6})):j("",!0)])):(s(),k("div",Qa,[e.systemStore.getTeamInfo.isPersonTeam?(s(),E(i,{key:0,class:"go-mt-5",align:"center",vertical:""},{default:n(()=>[t[17]||(t[17]=p("img",{src:ct,width:"230"},null,-1)),o(r,{depth:"3"},{default:n(()=>t[16]||(t[16]=[w(" 您的个人会员已经到期，请续费使用 ~ ")])),_:1}),p("div",{class:"go-mt-3 upgrade-btn",onClick:e.upgradeClick},"立即续费")]),_:1})):(s(),E(i,{key:1,class:"go-mt-5",align:"center",vertical:""},{default:n(()=>[t[19]||(t[19]=p("img",{src:ct,width:"230"},null,-1)),o(r,{depth:"3"},{default:n(()=>t[18]||(t[18]=[w(" 您的空间使用时间已经到期，请立即联系创建者续费~ ")])),_:1})]),_:1}))]))],32)}const xs=oe(Va,[["render",Za],["__scopeId","data-v-c0f32f5c"],["__file","index.vue"]]);export{xs as p,Ta as u};
