import{d as y,r as u,f as g,a as S,R as m,g as h,u as C,_ as $,c as b,o as v}from"./index-DzJUk-4s.js";import{u as x}from"./systemStore-CDAOEx2u.js";const E=y({__name:"index",props:{id:{required:!1,type:String}},setup(a,{expose:d}){d();const n=x(),i=a,r=u(i.id||g()),o=u(null);window.addEventListener("message",function(t){const{type:s,data:e}=t.data;s==="saveFile"&&l(e),s==="findById"&&c(e.id)});const c=async t=>{const{code:s,data:e}=await S({id:t});if(s===m.SUCCESS){if(!e){window.$message.error("该模型不存在！");return}if(e.createdAt===e.updateAt&&o.value.contentWindow.postMessage({type:"hideLoading"},"*"),!e.file_path){o.value.contentWindow.postMessage({type:"hideLoading"},"*");return}const f=await h(e.file_path);o.value.contentWindow.postMessage({type:"loadOptions",data:f},"*")}},l=async t=>{const e=`three/${`three_${t.fileName}`}`;if(t.blob.size>100*1024*1024){window.$message.error(window.$t("project.Upload_Model_Size_Limit"));return}if((await(await n.getSTSClient()).putObject({key:e,body:t.blob})).statusCode===200){let _={fileKey:e,id:t.id};const{code:w}=await C(_);w===m.SUCCESS&&(o.value.contentWindow.postMessage({type:"hideLoading"},"*"),window.$message.success("保存成功！"))}},p={systemStore:n,props:i,id:r,selfIframe:o,findById:c,upload3DFile:l};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),I=["src"];function L(a,d,n,i,r,o){return v(),b("iframe",{ref:"selfIframe",src:`/3DEditor/editor/index.html?id=${i.id}`,class:"ifame-box"},null,8,I)}const D=$(E,[["render",L],["__scopeId","data-v-98aa3dfe"],["__file","index.vue"]]);export{D as default};
