var $=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var J=(_,t,m)=>t in _?$(_,t,{enumerable:!0,configurable:!0,writable:!0,value:m}):_[t]=m,M=(_,t)=>{for(var m in t||(t={}))oe.call(t,m)&&J(_,m,t[m]);if(G)for(var m of G(t))ue.call(t,m)&&J(_,m,t[m]);return _},N=(_,t)=>ee(_,te(t));import{d as le,a5 as ae,e as ne,ac as se,r as k,H as re,eY as ie,bX as de,aa as X,b8 as Y,_ as pe,U as r,c as K,o as y,s as e,w as o,q as n,X as a,F as me,n as fe,Y as w,t as B,V as H}from"./index-DzJUk-4s.js";import{g as ce}from"./plugin-BZaVEG5Y.js";import{d as ge}from"./index-YIaHLc6Z.js";import{i as Q}from"./icon-Bt2TghsQ.js";import{u as _e}from"./index-B2h3DCGB.js";import{C as ye}from"./index-DkV0_qOD.js";import{M as ve}from"./index-DumZb7Zp.js";import"./file-BoGdIhh5.js";import"./systemStore-CDAOEx2u.js";import"./fileTypeEnum-22QBGXO_.js";import"./querySelectorAll-CWDd-9ax.js";import"./noImage-C1O4zUTD.js";import"./index.d-J2-cmQid.js";import"./correct-mOxEQCJ-.js";import"./chart_default-Cv54ZmSo.js";import"./noFile-CJNz9t2r.js";import"./useSync.hook-CykodbHN.js";import"./listen-BenKfQqv.js";import"./driver.js-DincbcBx.js";import"./drawRemote-BVHvBcY1.js";import"./index-BWD_u572.js";import"./indexDBStore-BkJ2w0ZQ.js";/* empty css                                                              */import"./error-DU3-BFcz.js";import"./index-BCTmwJrR.js";/* empty css               */import"./GoUserAvatar-BBITl89l.js";import"./points-Bi1H5gtF.js";import"./index-CYCNU51b.js";import"./svip-tip-BogTL7q_.js";import"./doc-Br7GyA9J.js";const xe=le({__name:"index",setup(_,{expose:t}){t(),ae(s=>({"1a7309cc":E.value}));const{HelpOutlineIcon:m,DocumentTextIcon:u,TrashIcon:T,CopyIcon:q,BarcodeOutlineIcon:L}=Q.ionicons5,{AreaCustomIcon:V}=Q.carbon,F=se(),g=_e(),i=k(!1),D=k(null),C=k(!1),d=k(!1),f=k(-1),p=re({name:"",desc:"",type:"static",stringValue:"",routerKey:""}),E=ne(()=>F.getAppTheme),v={name:{required:!0,message:"请输入「英文 | 数字 | 下划线」",trigger:"input",validator(s,c){return ie(c)}},type:{required:!0,message:"请选择类型",trigger:"select"},stringValue:{required:!1,message:"请输入默认值",trigger:"select"},routerKey:{required:!0,message:"请输入需要解析的字段",trigger:"select"}},S={static:"静态值",router:"路由",func:"自定义函数"},U=[{label:"静态值",value:"static"},{label:"路由解析（如 http://www.xxx?A=1，解析A）",value:"router"},{label:"自定义函数",value:"func"}],z=()=>{i.value=!0},I=()=>{d.value=!1,f.value=-1,i.value=!1,p.name="",p.desc="",p.type="static",p.stringValue="",p.routerKey=""},P={HelpOutlineIcon:m,DocumentTextIcon:u,TrashIcon:T,CopyIcon:q,BarcodeOutlineIcon:L,AreaCustomIcon:V,designStore:F,chartEditStore:g,showModal:i,formRef:D,saveLoading:C,isEdit:d,editIndex:f,formValue:p,themeColor:E,rules:v,label:S,options:U,addGlobalData:z,closeEvents:I,copyName:async(s,c)=>{s.preventDefault(),s.stopPropagation();const{copy:h,isSupported:x}=ge({source:c.name});x?(await h(),window.$message.success("复制名称成功")):de(c.name)?window.$message.success("复制名称成功"):window.$message.error("复制失败")},copyItem:(s,c,h)=>{s.preventDefault(),s.stopPropagation();const x=JSON.parse(JSON.stringify(c));x.id=X(),x.name=`${x.name}_copy`,g.getVarList.splice(h+1,0,x)},deleteItem:(s,c,h)=>{s.preventDefault(),s.stopPropagation(),ce({message:`删除后无法恢复，确定删除变量 ${c.name} ?`,onPositiveCallback:()=>{g.getVarList.splice(h,1)}})},editContent:(s,c)=>{d.value=!0,f.value=c,p.name=s.name,p.desc=s.desc,p.type=s.type,p.stringValue=s.stringValue||"",p.routerKey=s.routerKey,i.value=!0},saveHandle:s=>{var c;s.preventDefault(),(c=D.value)==null||c.validate(async h=>{if(!h&&p){C.value=!0;const x=()=>{const j=g.getVarList.some((W,Z)=>W.name===p.name&&Z!==f.value);return j&&window.$message.error("保存失败，变量名称已存在！"),j};if(d.value)if(f.value>-1)if(!x())g.getVarList[f.value]=N(M({},Y(p)),{id:g.getVarList[f.value].id});else{C.value=!1;return}else window.$message.error("保存失败，未找到编辑项！");else if(!x())g.getVarList.push(N(M({},Y(p)),{id:X()}));else{C.value=!1;return}setTimeout(()=>{C.value=!1,I()},300)}})},get ContentBox(){return ye},MonacoEditor:ve};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),Fe={class:"list-box"},Ce={class:"list-top"},Ee={style:{"font-size":"10px","font-weight":"bold"}},we={style:{height:"18px"}},Be=["onClick"],Ve={class:"list-item-left"},De={class:"code-model-box"},be={class:"go-flex-center"},he={class:"model-content-box"},ke={class:"go-flex-items-center"};function ze(_,t,m,u,T,q){const L=r("svg-icon"),V=r("n-button"),F=r("n-icon"),g=r("n-tooltip"),i=r("n-space"),D=r("n-divider"),C=r("n-tag"),d=r("n-text"),f=r("n-ellipsis"),p=r("n-code"),E=r("n-input"),v=r("n-form-item"),S=r("n-select"),U=r("n-alert"),z=r("n-card"),I=r("n-flex"),O=r("n-form"),R=r("n-modal");return y(),K("div",null,[e(u.ContentBox,{class:"go-content-global-data",title:"全局变量",depth:1,backIcon:!1},{default:o(()=>[e(i,{class:"top go-flex-center","wrap-item":!1},{default:o(()=>[e(V,{class:"canvas-top-right-btn",tertiary:"",focusable:!1,onClick:u.addGlobalData},{default:o(()=>[e(L,{icon:"global-data",style:{"font-size":"18px"}}),t[9]||(t[9]=n("span",{class:"go-ml-2"},"新增变量",-1))]),_:1}),e(g,{trigger:"hover","show-arrow":!1},{trigger:o(()=>[e(F,{size:"20",depth:3},{default:o(()=>[e(u.HelpOutlineIcon)]),_:1})]),default:o(()=>[t[10]||(t[10]=n("div",{style:{"font-size":"13px"}},[a(" 支持多大屏复用，在动态请求配置中请使用 { } 包裹名称使用 "),n("br"),a(" 可以在过滤器中使用 【window.$globalVarList】来获取和修改变量 ")],-1))]),_:1})]),_:1}),e(D,{style:{margin:"2px 0"}}),n("div",Fe,[(y(!0),K(me,null,fe(u.chartEditStore.getVarList,(l,A)=>(y(),K("div",{class:"list-item-box",key:l.id},[n("div",Ce,[e(i,{align:"center","wrap-item":!1,size:6},{default:o(()=>[e(C,{size:"small",bordered:!1,type:l.type==="router"?"info":"success",style:{"border-radius":"5px"}},{default:o(()=>[n("span",Ee,w(u.label[l.type]||"暂无"),1)]),_:2},1032,["type"]),e(f,{style:{"max-width":"210px"}},{default:o(()=>[e(g,{trigger:"hover"},{trigger:o(()=>[e(d,{class:"title",depth:2,style:{"font-size":"13px"},onClick:b=>u.copyName(b,l)},{default:o(()=>[a(w(l.name),1)]),_:2},1032,["onClick"])]),default:o(()=>[t[11]||(t[11]=a(" 点击复制名称 "))]),_:2},1024)]),_:2},1024)]),_:2},1024),n("div",we,[e(g,{"show-arrow":!1,trigger:"hover"},{trigger:o(()=>[e(V,{class:"go-mr-1",text:"",onClick:b=>u.copyItem(b,l,A)},{icon:o(()=>[e(F,{size:"14",depth:3},{default:o(()=>[e(u.CopyIcon)]),_:1})]),_:2},1032,["onClick"])]),default:o(()=>[t[12]||(t[12]=a(" 复制 "))]),_:2},1024),e(g,{"show-arrow":!1,trigger:"hover"},{trigger:o(()=>[e(V,{text:"",onClick:b=>u.deleteItem(b,l,A)},{icon:o(()=>[e(F,{size:"16",depth:3},{default:o(()=>[e(u.TrashIcon)]),_:1})]),_:2},1032,["onClick"])]),default:o(()=>[t[13]||(t[13]=a(" 删除 "))]),_:2},1024)])]),e(D,{style:{margin:"0 0 1px"}}),n("div",{class:"list-item go-transition-quick",onClick:b=>u.editContent(l,A)},[n("div",Ve,[e(i,{vertical:"","wrap-item":!1,size:2},{default:o(()=>[l.type==="static"?(y(),B(i,{key:0,"wrap-item":!1,size:4},{default:o(()=>[e(d,{depth:3,style:{"font-size":"13px",opacity:"0.7"}},{default:o(()=>t[14]||(t[14]=[a(" 默认值:")])),_:1}),e(f,{style:{"max-width":"200px"}},{default:o(()=>[e(d,{class:"value-text",depth:3,style:{"font-size":"13px"}},{default:o(()=>[a(w(l.stringValue),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):l.type==="router"?(y(),B(i,{key:1},{default:o(()=>[n("div",null,[e(d,{depth:3,style:{"font-size":"13px",opacity:"0.7"}},{default:o(()=>t[15]||(t[15]=[a(" 字段 ")])),_:1}),e(f,{style:{"max-width":"70px"}},{default:o(()=>[e(d,{depth:3,style:{"font-size":"13px"}},{default:o(()=>[a(w(l.routerKey),1)]),_:2},1024)]),_:2},1024)]),e(D,{vertical:"",style:{width:"2px",margin:"0px"}}),n("div",null,[e(d,{depth:3,style:{"font-size":"13px",opacity:"0.7"}},{default:o(()=>t[16]||(t[16]=[a(" 默认值:")])),_:1}),e(f,{style:{"max-width":"90px"}},{default:o(()=>[e(d,{depth:3,style:{"font-size":"13px"}},{default:o(()=>[a(w(l.stringValue),1)]),_:2},1024)]),_:2},1024)])]),_:2},1024)):l.type==="func"?(y(),B(i,{key:2},{default:o(()=>[n("div",De,[e(p,{code:l.stringValue,language:"ts","word-wrap":!0,style:{"font-size":"12px"}},null,8,["code"]),t[17]||(t[17]=n("div",{class:"code-model"},null,-1))])]),_:2},1024)):H("",!0),e(i,{size:0,"wrap-item":!1,align:"center"},{default:o(()=>[e(F,{size:"14",depth:5,style:{position:"relative",top:"1px"}},{default:o(()=>[e(u.DocumentTextIcon)]),_:1}),e(f,{style:{"margin-left":"4px","max-width":"236px"}},{default:o(()=>[e(d,{depth:3,style:{"font-size":"12px"}},{default:o(()=>[a(w(l.desc||"「暂无描述」"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])],8,Be)]))),128)),n("div",be,[u.chartEditStore.getVarList.length?H("",!0):(y(),B(d,{key:0,depth:3,style:{"font-size":"13px"}},{default:o(()=>t[18]||(t[18]=[a("暂无数据")])),_:1}))])])]),_:1}),e(R,{class:"go-background-filter",show:u.showModal,"onUpdate:show":t[8]||(t[8]=l=>u.showModal=l),"mask-closable":!1,onAfterLeave:u.closeEvents},{default:o(()=>[e(z,{bordered:!1,role:"dialog",size:"small","aria-modal":"true","content-style":"padding: 0",style:{width:"700px","min-height":"450px"}},{header:o(()=>[e(i,null,{default:o(()=>[e(d,null,{default:o(()=>[a(w(u.isEdit?"编辑变量":"新增变量"),1)]),_:1})]),_:1})]),action:o(()=>[e(i,{justify:"space-between"},{default:o(()=>[n("div",ke,[e(C,{bordered:!1,type:"primary",style:{"border-radius":"5px"}},{icon:o(()=>[e(F,{component:u.DocumentTextIcon},null,8,["component"])]),default:o(()=>[t[22]||(t[22]=a(" 说明 "))]),_:1}),e(d,{class:"go-ml-2",depth:"2"},{default:o(()=>t[23]||(t[23]=[a("请在预览页面查看结果")])),_:1})]),e(i,null,{default:o(()=>[e(V,{class:"go-px-4",size:"medium",focusable:!1,onClick:t[7]||(t[7]=l=>u.showModal=!1)},{default:o(()=>t[24]||(t[24]=[a("取消")])),_:1}),e(V,{class:"go-px-4",type:"primary",size:"medium",loading:u.saveLoading,onClick:u.saveHandle},{default:o(()=>[a(w(u.isEdit?"保存修改":"确认"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),default:o(()=>[e(D,{style:{margin:"0"}}),n("div",he,[u.formValue?(y(),B(O,{key:0,ref:"formRef",size:"medium","label-placement":"left",model:u.formValue,"label-width":80,rules:u.rules},{default:o(()=>[e(v,{label:"名称",path:"name"},{default:o(()=>[e(E,{value:u.formValue.name,"onUpdate:value":t[0]||(t[0]=l=>u.formValue.name=l),valueModifiers:{trim:!0},type:"text",maxlength:"50","show-count":"",placeholder:"请输入「英文 | 数字」变量名称"},null,8,["value"])]),_:1}),e(v,{label:"描述",path:"desc"},{default:o(()=>[e(E,{value:u.formValue.desc,"onUpdate:value":t[1]||(t[1]=l=>u.formValue.desc=l),valueModifiers:{trim:!0},type:"text",maxlength:"100","show-count":"",placeholder:"请输入描述"},null,8,["value"])]),_:1}),e(v,{label:"类型",path:"type"},{default:o(()=>[e(S,{value:u.formValue.type,"onUpdate:value":t[2]||(t[2]=l=>u.formValue.type=l),options:u.options,placeholder:"请选择类型"},null,8,["value"])]),_:1}),u.formValue.type==="static"?(y(),B(v,{key:0,label:"默认值",path:"stringValue"},{default:o(()=>[e(E,{value:u.formValue.stringValue,"onUpdate:value":t[3]||(t[3]=l=>u.formValue.stringValue=l),type:"textarea",maxlength:"2000",autosize:{minRows:3,maxRows:3},"show-count":"",placeholder:"请设置默认值"},null,8,["value"])]),_:1})):u.formValue.type==="router"?(y(),B(i,{key:1},{default:o(()=>[e(v,{label:"解析字段",path:"routerKey"},{default:o(()=>[e(E,{value:u.formValue.routerKey,"onUpdate:value":t[4]||(t[4]=l=>u.formValue.routerKey=l),valueModifiers:{trim:!0},type:"text",maxlength:"100",placeholder:"将从路由中解析输入的字段",style:{width:"300px"}},null,8,["value"])]),_:1}),e(v,{label:"默认值",path:"stringValue"},{default:o(()=>[e(E,{value:u.formValue.stringValue,"onUpdate:value":t[5]||(t[5]=l=>u.formValue.stringValue=l),type:"text",maxlength:"2000",placeholder:"若解析失败, 则使用默认值",style:{width:"188px"}},null,8,["value"])]),_:1}),e(v,{label:"「注意」"},{default:o(()=>[e(d,null,{default:o(()=>t[19]||(t[19]=[a("路由解析仅在接口请求关联中使用，如需其它地方使用，可直接采用 window.$route 获取。")])),_:1})]),_:1})]),_:1})):(y(),B(v,{key:2,label:"函数内容",path:"stringValue"},{default:o(()=>[e(I,{vertical:"",style:{width:"100%"}},{default:o(()=>[e(U,{size:"small",title:"该函数不支持异步，请务必把最终的值 return 抛出 ",type:"info"}),e(z,{size:"small","content-style":{paddingLeft:"10px",paddingRight:"10px"}},{default:o(()=>[e(i,{vertical:""},{default:o(()=>[t[20]||(t[20]=n("span",{style:{"font-size":"13px"}},[n("span",{class:"func-keyword"},"function"),n("span",{class:"func-name go-ml-2"},"( )"),a(" { ")],-1)),e(u.MonacoEditor,{modelValue:u.formValue.stringValue,"onUpdate:modelValue":t[6]||(t[6]=l=>u.formValue.stringValue=l),height:"180px",language:"javascript"},null,8,["modelValue"]),t[21]||(t[21]=a(" } "))]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1},8,["model"])):H("",!0)])]),_:1})]),_:1},8,["show"])])}const it=pe(xe,[["render",ze],["__scopeId","data-v-b7f27b75"],["__file","index.vue"]]);export{it as default};
