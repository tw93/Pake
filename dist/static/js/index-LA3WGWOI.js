import{a3 as ut,d as pt,a5 as dt,e as q,ac as mt,r as Y,bd as J,A as Q,b8 as Z,cX as _t,_ as gt,U as v,t as H,o as I,w as i,q as m,c as tt,F as et,n as rt,X as y,s as c,Y as P}from"./index-DzJUk-4s.js";import{a as ot,b as nt,l as at}from"./plugin-BZaVEG5Y.js";import{i as it}from"./icon-Bt2TghsQ.js";import{m as ft,u as It,aC as T,aD as t,aE as _}from"./index-B2h3DCGB.js";import{C as yt}from"./index-DkV0_qOD.js";import"./file-BoGdIhh5.js";import"./systemStore-CDAOEx2u.js";import"./index-DumZb7Zp.js";import"./index-YIaHLc6Z.js";import"./fileTypeEnum-22QBGXO_.js";import"./querySelectorAll-CWDd-9ax.js";import"./noImage-C1O4zUTD.js";import"./index.d-J2-cmQid.js";import"./correct-mOxEQCJ-.js";import"./chart_default-Cv54ZmSo.js";import"./noFile-CJNz9t2r.js";import"./useSync.hook-CykodbHN.js";import"./listen-BenKfQqv.js";import"./driver.js-DincbcBx.js";import"./drawRemote-BVHvBcY1.js";import"./index-BWD_u572.js";import"./indexDBStore-BkJ2w0ZQ.js";/* empty css                                                              */import"./error-DU3-BFcz.js";import"./index-BCTmwJrR.js";/* empty css               */import"./GoUserAvatar-BBITl89l.js";import"./points-Bi1H5gtF.js";import"./index-CYCNU51b.js";import"./svip-tip-BogTL7q_.js";import"./doc-Br7GyA9J.js";var Tt=Array.prototype,ht=Tt.reverse;function At(g){return g==null?g:ht.call(g)}var kt=At;const Ct=ut(kt),Ot=pt({__name:"index",setup(g,{expose:l}){l(),dt(e=>({"7bd3bc52":j.value,"424e9d02":K.value}));const{DesktopOutlineIcon:k,PencilIcon:n,TrashIcon:C,CopyOutlineIcon:O,LayersIcon:s,DuplicateIcon:u,HelpOutlineIcon:f,LockClosedOutlineIcon:a,LockOpenOutlineIcon:h,EyeOffOutlineIcon:A,EyeOutlineIcon:B,ArrowUndoIcon:st}=it.ionicons5,{StackedMoveIcon:R,Carbon3DCursorIcon:U,Carbon3DSoftwareIcon:F,ColumnIcon:M,RowIcon:V,AlignHorizontalLeftIcon:S,AlignHorizontalCenterIcon:b,AlignHorizontalRightIcon:D,AlignVerticalTopIcon:w,AlignVerticalCenterIcon:E,AlignVerticalBottomIcon:N,TaskSettingsIcon:z}=it.carbon,p=ft(),L=It(),x=mt(),$=Y([]),W=Y([]),j=q(()=>J(x.getAppTheme,.8)),K=q(()=>J(x.getAppTheme,.6)),ct=e=>{if(e.targetType===T.CANVAS)return k;switch(e.actionType){case t.UPDATE:return n;case t.DELETE:return C;case t.PASTE:return O;case t.TOP:return s;case t.BOTTOM:return s;case t.UP:return s;case t.DOWN:return s;case t.MOVE:return R;case t.ADD:return u;case t.GROUP:return U;case t.UN_GROUP:return F;case t.LOCK:return a;case t.UNLOCK:return h;case t.HIDE:return A;case t.SHOW:return B;case t.ALIGN_LEFT:return S;case t.ALIGN_CENTER:return b;case t.ALIGN_RIGHT:return D;case t.ALIGN_TOP:return w;case t.ALIGN_MIDDLE:return E;case t.ALIGN_BOTTOM:return N;case t.GROUP_ALIGN_LEFT:return S;case t.GROUP_ALIGN_CENTER:return b;case t.GROUP_ALIGN_RIGHT:return D;case t.GROUP_ALIGN_TOP:return w;case t.GROUP_ALIGN_MIDDLE:return E;case t.GROUP_ALIGN_BOTTOM:return N;case t.GROUP_ALIGN_SPACE_COLUMN:return M;case t.GROUP_ALIGN_SPACE_ROW:return V;case t.PASTE_COMPONENT_CONFIG:return z;default:return n}},G=e=>{if(e.targetType===T.PAGE)return`${_[e.actionType]}`;if(e.targetType===T.CANVAS)return _[T.CANVAS];if(e.actionType===t.GROUP||e.actionType===t.UN_GROUP)return`${_[e.actionType]}`;if(Array.isArray(e.historyData)){if(e.historyData.length){const o=e.historyData.length>1?"多组件":e.historyData[0].chartConfig.title;return`${_[e.actionType]} - ${o}`}}else{const o=e.historyData.newData.components;if(o.length){const r=o.length>1?"多组件":o[0].chartConfig.title;return`${_[e.actionType]} - ${r}`}}return`${_[e.actionType]}`};Q(()=>p.getBackStack.length,()=>{const o=p.getBackStack.map(r=>({id:r.id,label:G(r),actionType:r.actionType,targetType:r.targetType,disabled:r.targetType===T.CANVAS}));$.value=o.filter(r=>r.label)},{deep:!1,immediate:!0}),Q(()=>p.getForwardStack.length,()=>{const o=p.getForwardStack.map(r=>({id:r.id,label:G(r),actionType:r.actionType,targetType:r.targetType}));W.value=Ct(o.filter(r=>r.label))},{deep:!1,immediate:!0});const X={DesktopOutlineIcon:k,PencilIcon:n,TrashIcon:C,CopyOutlineIcon:O,LayersIcon:s,DuplicateIcon:u,HelpOutlineIcon:f,LockClosedOutlineIcon:a,LockOpenOutlineIcon:h,EyeOffOutlineIcon:A,EyeOutlineIcon:B,ArrowUndoIcon:st,StackedMoveIcon:R,Carbon3DCursorIcon:U,Carbon3DSoftwareIcon:F,ColumnIcon:M,RowIcon:V,AlignHorizontalLeftIcon:S,AlignHorizontalCenterIcon:b,AlignHorizontalRightIcon:D,AlignVerticalTopIcon:w,AlignVerticalCenterIcon:E,AlignVerticalBottomIcon:N,TaskSettingsIcon:z,chartHistoryStoreStore:p,chartEditStore:L,designStore:x,backOptions:$,forwardOptions:W,fadeThemeColor:j,fadeThemeColorLight:K,iconHandle:ct,labelHandle:G,backHandle:async e=>{try{window.$message.info("正在回退历史记录，请稍后..."),setTimeout(async()=>{ot();const o=Z(p.getBackStack),r=e.id;for(let d=o.length-1;d>0&&o[d].id!==r;d--)await L.setBack();nt()},200)}catch(o){at(),window.$message.error("历史记录回滚失败，请联系管理员！")}},forwardHandle:e=>{try{window.$message.info("正在回退历史记录，请稍后..."),setTimeout(async()=>{ot();const o=Z(p.getForwardStack),r=e.id;for(let d=o.length-1;d>0&&o[d].id!==r;d--)L.setForward();nt()},200)}catch(o){at(),window.$message.error("历史记录回滚失败，请联系管理员！")}},get editHistoryMax(){return _t},get ContentBox(){return yt}};return Object.defineProperty(X,"__isScriptSetup",{enumerable:!1,value:!0}),X}}),St={class:"go-flex-items-center"},bt={class:"history-list-box"},Dt=["title","onClick"],wt=["title","onClick"],Et={class:"left-box"};function Nt(g,l,k,n,C,O){const s=v("n-text"),u=v("n-icon"),f=v("n-tooltip");return I(),H(n.ContentBox,{class:"go-content-history",depth:1,backIcon:!1},{"top-title-left":i(()=>[c(s,{style:{"font-size":"13px"}},{default:i(()=>l[0]||(l[0]=[y("历史记录")])),_:1}),c(f,{trigger:"hover"},{trigger:i(()=>[c(u,{size:"18",depth:2,style:{position:"relative",top:"4px"}},{default:i(()=>[c(n.HelpOutlineIcon)]),_:1})]),default:i(()=>[m("span",null,"最多只保留"+P(n.editHistoryMax)+"条记录",1)]),_:1})]),default:i(()=>[m("div",St,[m("div",bt,[(I(!0),tt(et,null,rt(n.backOptions,(a,h)=>(I(),H(f,{trigger:"hover",placement:"right",key:a.id},{trigger:i(()=>[m("div",{class:"list-item go-flex-items-center go-ellipsis-1",title:a.label,onClick:A=>n.backHandle(a)},[c(u,{class:"item-icon",size:"18",depth:3,component:n.iconHandle(a)},null,8,["component"]),c(s,{class:"text go-ellipsis-1",depth:"2"},{default:i(()=>[y(P(a.label),1)]),_:2},1024)],8,Dt)]),default:i(()=>[l[1]||(l[1]=y(" 回退到该操作 "))]),_:2},1024))),128)),(I(!0),tt(et,null,rt(n.forwardOptions,(a,h)=>(I(),H(f,{trigger:"hover",placement:"right",key:a.id},{trigger:i(()=>[m("div",{class:"list-item forward go-flex-items-center go-ellipsis-1",title:a.label,onClick:A=>n.forwardHandle(a)},[m("div",Et,[c(u,{class:"item-icon",size:"18",depth:3,component:n.iconHandle(a)},null,8,["component"]),c(s,{class:"text go-ellipsis-1",depth:"2"},{default:i(()=>[y(P(a.label),1)]),_:2},1024)]),c(u,{size:"12",color:n.fadeThemeColorLight,component:n.ArrowUndoIcon},null,8,["color","component"])],8,wt)]),default:i(()=>[l[2]||(l[2]=y(" 回退到该操作 "))]),_:2},1024))),128))])])]),_:1})}const ue=gt(Ot,[["render",Nt],["__scopeId","data-v-802ed3e6"],["__file","index.vue"]]);export{ue as default};
