import{d as Q,r as Z,e as $,D as tt,E as _,P as r,bk as et,bl as at,bm as G,A as ot,bu as M,bi as A,b3 as O,K as nt,R as N,aw as st,_ as rt,U as h,c as C,o as d,q as l,V as b,F as lt,n as it,p as w,s as u,z as B,w as i,X as k,Y as U,t as m,W,$ as V}from"./index-DzJUk-4s.js";import{h as T,b as ct,t as dt,e as ut}from"./index-DkV0_qOD.js";import{u as Et,aI as gt,E as H,aJ as ft,C as K,a0 as _t,aF as ht,w as Y}from"./index-B2h3DCGB.js";import{a as Ct}from"./querySelectorAll-CWDd-9ax.js";import{a as mt,b as Tt,l as z,g as j}from"./plugin-BZaVEG5Y.js";import{r as pt}from"./chart_default-Cv54ZmSo.js";import{i as J}from"./icon-Bt2TghsQ.js";import"./index-YIaHLc6Z.js";import"./file-BoGdIhh5.js";import"./fileTypeEnum-22QBGXO_.js";import"./systemStore-CDAOEx2u.js";import"./noImage-C1O4zUTD.js";import"./index.d-J2-cmQid.js";import"./correct-mOxEQCJ-.js";import"./index-DumZb7Zp.js";import"./noFile-CJNz9t2r.js";import"./useSync.hook-CykodbHN.js";import"./listen-BenKfQqv.js";import"./driver.js-DincbcBx.js";import"./drawRemote-BVHvBcY1.js";import"./index-BWD_u572.js";import"./indexDBStore-BkJ2w0ZQ.js";/* empty css                                                              */import"./error-DU3-BFcz.js";import"./index-BCTmwJrR.js";/* empty css               */import"./GoUserAvatar-BBITl89l.js";import"./points-Bi1H5gtF.js";import"./index-CYCNU51b.js";import"./svip-tip-BogTL7q_.js";import"./doc-Br7GyA9J.js";const yt=Q({__name:"index",props:{menuOptions:{type:Array,default:()=>[]},selectPackagesValue:{type:String,default:""},itemWidth:{type:String,default:""}},setup(q,{expose:c}){c();const s=Et(),e=tt(),{TrashIcon:I}=J.ionicons5,{EditIcon:x}=J.carbon,f=Ct(),E=Z(),v=t=>!t.disabled&&t.package===r.PHOTOS&&t.category!==gt.SHARE?!0:!t.disabled&&t.package===r.GROUP_TEMPLATES,p=$(()=>f.getChartType),S=async(t,a)=>{var y;if(a.disabled)return;if((a==null?void 0:a.chartFrame)==M.REMOTE||(a==null?void 0:a.chartFrame)==M.THREE_MODEL)t.dataTransfer.setData(A.DRAG_KEY,O(a));else if((a==null?void 0:a.chartFrame)==M.GROUP_TEMPLATE){const D=await G(a);D.isGroup?(y=D.groupList)==null||y.forEach(F=>{T(F.chartConfig,F)}):T(D.chartConfig,D),t.dataTransfer.setData(A.DRAG_KEY,O(a))}else T(a),(a==null?void 0:a.package)==r.PHOTOS?t.dataTransfer.setData(A.DRAG_KEY,O(a)):t.dataTransfer.setData(A.DRAG_KEY,O(nt.omit(a,["image"])));const o=()=>{document.removeEventListener("mouseup",o),s.setEditCanvas(H.IS_CREATE,!1)};document.addEventListener("mouseup",o),s.setEditCanvas(H.IS_CREATE,!0)},P=()=>{s.setEditCanvas(H.IS_CREATE,!1)};e.off(_.CHART_EDIT_ADD_COMPONENT),e.on(_.CHART_EDIT_ADD_COMPONENT,t=>{n(t)});const n=async t=>{var a;if(!t.disabled)try{mt();let o=null;t.package===r.REMOTES?o=await et(t):t.category===r.THREE_MODELS?o=await at(t):t.package===r.GROUP_TEMPLATES?(o=await G(t),o.isGroup?(a=o.groupList)==null||a.forEach(async y=>{await T(y.chartConfig,y)}):await T(o.chartConfig,o)):(o=await T(t),t.redirectComponent&&o&&(t.dataset&&(o.option.dataset=t.dataset),o.chartConfig.title=t.title,o.chartConfig.chartFrame=t.chartFrame)),o?(s.addComponentList(o,!1,!0),s.setTargetSelectChart(o.id),Tt()):z()}catch(o){console.log(o),z(),window.$message.warning("图表正在研发中, 敬请期待...")}},R=t=>{var a;(a=t==null?void 0:t.configEvents)==null||a.addHandle(t)},g=(t,a)=>{t.package===r.PHOTOS?j({message:`是否删除图片【${t.title}】？`,transformOrigin:"center",onPositiveCallback:async()=>{if(!t.id){window.$message.error("删除失败, 请联系管理员");return}const o=await ft({id:t.id});(o.code=N.SUCCESS)&&(window.$message.success("删除成功"),f.setItemUnHandle(K.CHART_LIST_CATEGORY_KEEP_NAME,!0),e.emit(_.CHART_EDIT_REFRESH_COMPONENT_LIST,[r.PHOTOS]))}}):t.package===r.GROUP_TEMPLATES&&j({message:`是否删除【${t.title}】收藏？`,transformOrigin:"center",onPositiveCallback:async()=>{const o=await ct({id:t.key});(o.code=N.SUCCESS)&&(window.$message.success("删除成功"),f.setItemUnHandle(K.CHART_LIST_CATEGORY_KEEP_NAME,!0),e.emit(_.CHART_EDIT_REFRESH_COMPONENT_LIST,[r.GROUP_TEMPLATES]))}})},X=t=>{t.package===r.PHOTOS?e.emit(_.CHART_EDIT_IMAGE_OPEN,{contentId:t.id,projectName:t.title,tags:t.category,thumbnail:t.image,dataset:t.dataset,package:t.package}):t.package===r.GROUP_TEMPLATES&&e.emit(_.CHART_EDIT_GROUP_TEMPLATE_OPEN,{contentId:t.key,projectName:t.title,tags:t.category,thumbnail:t.image,content:t.content})};ot(()=>p.value,t=>{t===Y.DOUBLE&&st(()=>{E.value.classList.add("miniAnimation"),setTimeout(()=>{E.value.classList.remove("miniAnimation")},600)})});const L={chartEditStore:s,eventBus:e,TrashIcon:I,EditIcon:x,chartLayoutStore:f,contentChartsItemBoxRef:E,isShowTools:v,chartMode:p,dragStartHandle:S,dragendHandle:P,dblclickHandle:n,clickHandle:R,deleteHandle:g,updateTemplateHandle:X,get ChartGlobImage(){return ut},get ChartModeEnum(){return Y},get PackagesCategoryEnum(){return r},get remoteDefaultChart(){return pt},get threeModelDefault(){return dt},get noData(){return ht},get GoIconify(){return _t}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),kt={class:"go-content-charts-item-animation-patch"},St=["onDragstart","onDragend","onDblclick","onClick"],Dt={class:"list-header"},At={class:"list-center go-flex-center go-transition",draggable:"true"},Ot={class:"list-bottom"},bt={key:0,class:"list-model"},vt={key:1,class:"list-tools go-transition"},Pt={class:"go-flex-items-center"},Rt={style:{"font-size":"13px"}},Mt={style:{"font-size":"13px"}},wt={key:0,class:"go-flex-items-center go-mt-5",style:{"flex-direction":"column"}},Ht=["src"];function It(q,c,s,e,I,x){const f=h("n-ellipsis"),E=h("n-text"),v=h("n-image"),p=h("n-icon"),S=h("n-button"),P=h("n-divider");return d(),C("div",kt,[l("div",{ref:"contentChartsItemBoxRef",class:B(["go-content-charts-item-box",[e.chartMode===e.ChartModeEnum.DOUBLE||s.itemWidth?"double":"single"]]),style:w({justifyContent:s.itemWidth?"flex-start":""})},[(d(!0),C(lt,null,it(s.menuOptions,(n,R)=>(d(),C("div",{class:"item-box",key:n.id||n.key,draggable:"",onDragstart:g=>!n.disabled&&e.dragStartHandle(g,n),onDragend:g=>!n.disabled&&e.dragendHandle(),onDblclick:g=>e.dblclickHandle(n),onClick:g=>e.clickHandle(n),style:w({width:s.itemWidth})},[l("div",Dt,[l("div",{class:B(["btn-box",[e.chartMode===e.ChartModeEnum.DOUBLE?"super-mini":""]])},c[0]||(c[0]=[l("div",{class:"btn close"},null,-1),l("div",{class:"btn remove"},null,-1),l("div",{class:"btn resize"},null,-1)]),2),u(E,{class:"list-header-text",depth:"3"},{default:i(()=>[u(f,{style:{"max-width":"110px"},tooltip:!s.itemWidth,title:s.itemWidth?n.title:""},{default:i(()=>[k(U(n.title),1)]),_:2},1032,["tooltip","title"])]),_:2},1024)]),l("div",At,[n.icon?(d(),m(e.GoIconify,{key:0,class:"list-img",icon:n.icon,color:"#999",width:"48",style:{height:"auto"}},null,8,["icon"])):n.image?(d(),m(e.ChartGlobImage,{key:1,class:"list-img",chartConfig:n},null,8,["chartConfig"])):(d(),m(v,{key:2,class:"list-img no-img",src:n.package===e.PackagesCategoryEnum.REMOTES?e.remoteDefaultChart:e.threeModelDefault,"preview-disabled":""},null,8,["src"]))]),l("div",Ot,[u(E,{class:"list-bottom-text",depth:"3"},{default:i(()=>[u(f,{style:{"max-width":"90%"},tooltip:!s.itemWidth,title:s.itemWidth?n.title:""},{default:i(()=>[k(U(n.title),1)]),_:2},1032,["tooltip","title"])]),_:2},1024)]),n.disabled?(d(),C("div",bt)):b("",!0),e.isShowTools(n)?(d(),C("div",vt,[l("div",Pt,[u(S,{text:"",type:"error",color:"#ffffff",onClick:g=>e.deleteHandle(n,R)},{icon:i(()=>[u(p,null,{default:i(()=>[u(e.TrashIcon)]),_:1})]),default:i(()=>[W(l("span",Rt,"删除",512),[[V,e.chartMode===e.ChartModeEnum.SINGLE&&!s.itemWidth]])]),_:2},1032,["onClick"]),u(P,{vertical:"",style:w(`margin-left: ${e.chartMode===e.ChartModeEnum.DOUBLE?0:"8px"}`)},null,8,["style"]),u(S,{text:"",type:"default",color:"#ffffff",onClick:g=>e.updateTemplateHandle(n)},{icon:i(()=>[u(p,null,{default:i(()=>[u(e.EditIcon)]),_:1})]),default:i(()=>[W(l("span",Mt,"编辑",512),[[V,e.chartMode===e.ChartModeEnum.SINGLE&&!s.itemWidth]])]),_:2},1032,["onClick"])])])):b("",!0)],44,St))),128))],6),s.menuOptions.length?b("",!0):(d(),C("div",wt,[l("img",{src:e.noData,alt:"暂无数据",width:"90"},null,8,Ht),c[4]||(c[4]=l("br",null,null,-1)),s.selectPackagesValue===e.PackagesCategoryEnum.GROUP_TEMPLATES?(d(),m(E,{key:0,depth:3},{default:i(()=>c[1]||(c[1]=[k(" 分组上右键可添加到收藏 ")])),_:1})):s.selectPackagesValue===e.PackagesCategoryEnum.REMOTES?(d(),m(E,{key:1,depth:3},{default:i(()=>c[2]||(c[2]=[k(" 可在 [我的空间-组件] 中添加远程组件 ")])),_:1})):s.selectPackagesValue===e.PackagesCategoryEnum.THREE_MODELS?(d(),m(E,{key:2,depth:3},{default:i(()=>c[3]||(c[3]=[k(" 可在 [我的空间-3D模型] 中添加远程三维模型 ")])),_:1})):b("",!0)]))])}const Ee=rt(yt,[["render",It],["__scopeId","data-v-355706bb"],["__file","index.vue"]]);export{Ee as default};
