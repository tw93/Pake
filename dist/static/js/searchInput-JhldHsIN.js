import{d as P,r as v,aT as z,ab as w,aU as B,aX as K,aM as F,_ as V,U as l,c as I,o as f,q as R,s as r,b,w as t,t as T,X as g,F as D,n as U,Y as W,Z as j,p as q}from"./index-DzJUk-4s.js";import{i as G}from"./icon-Bt2TghsQ.js";const Y=P({__name:"searchInput",props:{autofocus:{type:Boolean,require:!1,default:!1},isPopover:{type:Boolean,require:!1,default:!0},searchType:{type:String,require:!0},placeholder:{type:String,require:!1},width:{type:String,require:!1},popoverWidth:{type:String,require:!1},defaultValue:{type:String,require:!1},size:{type:String,require:!1}},emits:["search"],setup(_,{expose:o,emit:n}){const e=_,E=n,{SearchIcon:N}=G.ionicons5,m=v(null),i=z(w.GO_MARKET_RECENT_SEARCH),d=v(B(i)?i:[]),s=v(e.defaultValue),u=v(!1),p=()=>{d.value=[],localStorage.removeItem(w.GO_MARKET_RECENT_SEARCH)},S=async()=>{K(w.GO_MARKET_RECENT_SEARCH,s,d,10,()=>{}),c()},c=async a=>{const x=a||s.value;E("search",x)},C=()=>{u.value=!0,document.addEventListener("click",h)},h=a=>{const x=a.target,H=document.querySelectorAll(".community-search-input");let A=!1;H.forEach(O=>{O.contains(x)&&(A=!0)}),A||y()},y=()=>{u.value=!1,document.removeEventListener("click",h)},L=a=>{s.value=a},M=()=>{var a;y(),s.value="",(a=m.value)==null||a.blur()};o({setBlur:M,closeHandle:y,setValue:L});const k={props:e,emit:E,SearchIcon:N,inputRef:m,localData:i,recentSearchList:d,search:s,showPopover:u,clearHandle:p,addLocalStorage:S,searchHandle:c,showPopoverHandle:C,popoverEventListener:h,closeHandle:y,setValue:L,setBlur:M,get CommunityEnum(){return F}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),X={class:"community-search-input"},Z={class:"popover-content-class"};function J(_,o,n,e,E,N){const m=l("n-icon"),i=l("n-text"),d=l("n-input"),s=l("n-input-group"),u=l("n-button"),p=l("n-flex"),S=l("n-popover");return f(),I("div",X,[R("div",{class:"search",style:q({width:n.width})},[r(S,{trigger:"manual",placement:"bottom","show-arrow":!1,show:n.isPopover&&e.showPopover&&e.recentSearchList.length>0,to:!1,style:q({marginTop:"10px",width:n.popoverWidth||(n.searchType===e.CommunityEnum.COMMUNITY_COMPONENT_NAME?"calc(50vw - 390px)":"calc(50vw - 290px)"),minWidth:n.searchType===e.CommunityEnum.COMMUNITY_COMPONENT_NAME?"300px":"320px",maxWidth:"474px"})},{trigger:t(()=>[r(s,null,{default:t(()=>[r(d,{ref:"inputRef",class:"search-input",placeholder:n.placeholder||"搜索模板、组件",value:e.search,"onUpdate:value":o[0]||(o[0]=c=>e.search=c),valueModifiers:{trim:!0},clearable:"",size:n.size||"large",autofocus:n.autofocus,onFocus:e.showPopoverHandle,onKeyup:j(e.addLocalStorage,["enter"])},{prefix:t(()=>[r(i,{class:"go-cursor-pointer",style:{position:"relative",top:"4px"},onClick:e.addLocalStorage},{default:t(()=>[r(m,{component:e.SearchIcon,size:18,depth:"2"},null,8,["component"])]),_:1})]),suffix:t(()=>[b(_.$slots,"suffix",{},void 0,!0)]),_:3},8,["placeholder","value","size","autofocus"])]),_:3})]),default:t(()=>[R("div",Z,[r(p,{class:"go-fs-13",justify:"space-between",style:{width:"100%"}},{default:t(()=>[o[2]||(o[2]=g(" 最近搜索 ")),r(u,{text:"",type:"primary",size:"tiny",onClick:e.clearHandle},{default:t(()=>o[1]||(o[1]=[g("清除")])),_:1})]),_:1}),e.recentSearchList.length?(f(),T(p,{key:0,class:"go-mt-3"},{default:t(()=>[(f(!0),I(D,null,U(e.recentSearchList,(c,C)=>(f(),T(u,{key:C,secondary:"",type:"tertiary",size:"tiny",onClick:h=>e.searchHandle(c)},{default:t(()=>[g(W(c),1)]),_:2},1032,["onClick"]))),128))]),_:1})):(f(),T(p,{key:1,justify:"center"},{default:t(()=>[r(i,{class:"go-fs-13",depth:"3"},{default:t(()=>o[3]||(o[3]=[g("暂无数据")])),_:1})]),_:1}))])]),_:3},8,["show","style"]),b(_.$slots,"input-after",{},void 0,!0)],4)])}const ee=V(Y,[["render",J],["__scopeId","data-v-d6de84c3"],["__file","searchInput.vue"]]);export{ee as S};
